!function(t,e,s){e.processor=e.processor||{};var r=/Date\s+([A-Za-z\.\[\]\(\)\'\,\_0-9]*)(?:\s+format='(.*)')?/,n=/Emoji\s+([A-Za-z\.\[\]\(\)\'\,\_0-9]*)?/,i=/Amount\s+([A-Za-z\d\.\[\]\(\)\'\,\/\*\+\-]*)(?:\s+format='([#0,\.\+]*)')?(?:\s+currency='(.*)')?/,a=/String\s+([A-Za-z\d\.\[\]\(\)\'\,\/\*\+\-]*)?(?:\s+maxLength='(.*)')?/,o=["BinaryExpression","UnaryExpression","Identifier","Literal","ArrayExpression","MemberExpression","CallExpression"];e.processor.PExp=function(t){this.str=this.compile(t);try{this.exp=jsep(this.str)}catch(e){this.err(e,"PExp('"+this.str+"') Error -Invalid expression: '"+t+"'",!0)}},e.processor.PExp.prototype.binops={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return 0==e?0:t/e},"%":function(t,e){return t%e},"==":function(t,e){return t==e},"!=":function(t,e){return t!=e},"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},">":function(t,e){return t>e},">=":function(t,e){return t>=e}},e.processor.PExp.prototype.unops={"-":function(t){return-t},"+":function(t){return t}},e.processor.PExp.prototype.compile=function(t){var e,s,o=t,l=t.match(r);l&&(e=l[1],s=null,l.length>2&&l[2]&&(s="'"+l[2]+"'"),t="utils.formatDate("+e+","+s+")");var c=t.match(i);if(c){e=c[1],s=null;var u=null,d=c[2];null!=d&&d.length>0&&(s="'"+c[2]+"'"),void 0!==c[3]&&null!==c[3]&&(u=c[3]),"string"==typeof u&&""===(u=u.replace(/^\s+|\s+$/g,""))&&(u='""'),t="utils.formatAmount("+e+", "+u+", "+s+")",t=o.replace(i,t)}t.match(n)&&(t="'{{"+t+"}}'");var p=t.match(a),h=null;if(p){e=p[1];var f=p[2];null!=f&&f.length>0&&(h=p[2]),t="utils.limitString("+e+","+h+")",t=o.replace(a,t)}return t},e.processor.PExp.prototype.eval=function(t,s,r){var n=null,i=!1;try{e.log("PExp: attempting to evaluate expression: '"+this.str+"'");var a=this.evalNode(this.exp,t,s,r);null==a&&(i=!0,n=this.err(null,"PExp.eval('"+this.str+"') Error - Invalid result after evaluating expression: '"+a+"'",!1))}catch(t){i=!0,n=this.err(t,"PExp.eval('"+this.str+"') Error - Could not evaluate expression",!1)}if(!i){var o=a;try{o=JSON.stringify(a)}catch(t){o=a}return e.log("Result: "+o),a}this.err(n,null,!0)},e.processor.PExp.prototype.evalNode=function(t,s,r,n){var i;if("BinaryExpression"===t.type){var a=this.evalNode(t.left,s,r,n),o=this.evalNode(t.right,s,r,n);i=this.binops[t.operator](a,o)}else if("UnaryExpression"===t.type)i=this.unops[t.operator](this.evalNode(t.argument,s,r,n));else if("Identifier"===t.type)null==(i=e.processor.PUtils.getUtilsInstance(t.name,s,r))&&(i=this.getChild(s,t.name,s,r,n)),null!=r&&null==i&&(i=this.getChild(r,t.name,s,r,n));else if("Literal"===t.type)i=t.value;else if("ArrayExpression"===t.type){var l=[];for(y in t.elements){var u=t.elements[y],d=this.evalNode(u,s,r,n);l.push(d)}i=l}else if("MemberExpression"===t.type){var p=this.evalNode(t.object,s,r,n);if("Identifier"==t.property.type)i=this.getChild(p,t.property.name,s,r,n);else{var h=this.evalNode(t.property,p,r,n);i=this.getChild(p,h,n,s,r,n)}if("function"==typeof i)i=new c(p,i)}else if("CallExpression"===t.type){var f=this.evalNode(t.callee,s,r,n),g=[];for(var y in t.arguments){var m=t.arguments[y],v=this.evalNode(m,s,r,n);g.push(v)}f&&c.prototype.isPrototypeOf(f)||this.err({message:"TypeError: Cannot find function '"+t.callee.property.name+"' of '"+t.callee.object.name+"'"},null,!0),i=f.call(g)}return i},e.processor.PExp.prototype.getChild=function(t,s,r,n,i){return t?(e.processor.PDataSource.prototype.isPrototypeOf(t)&&(a=t.get(s,i)),a||(a=t[s]),this.isNode(a)&&(a=this.evalNode(a,r,n,i)),a):t;var a},e.processor.PExp.prototype.isNode=function(t){var e=!1;if(t&&t.hasOwnProperty("type")){var s=t.type;e=o.indexOf(s)>=0}return e},e.processor.PExp.prototype.err=function(t,e,s){s=null!=s&&0!=s;var r=null,n=null;null!=t&&("object"==typeof t?(t.hasOwnProperty("message")&&(r=t.message),t.hasOwnProperty("stack")&&(n=t.stack)):"string"==typeof t&&(r=t));var i={message:e=e?r?e+"\n\t Error message: "+r:e:r||"",stack:n};if(s)throw i;return i};var l=function(t){this.parent=t};l.prototype.get=function(t){},l.prototype.getParent=function(){};var c=function(t,e){if(!t)throw"No obj provided to bound function";this.obj=t,this.func=e};c.prototype.call=function(t){return this.func.apply(this.obj,t)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){var r=function(){this._instance={},this.utilsFactory={utils:a,dateUtils:i,amountUtils:n}};r.prototype.getUtilsInstance=function(t,e,s){if(this.utilsFactory.hasOwnProperty(t))if(this._instance.hasOwnProperty(t)){var r=this._instance[t];void 0!==r.context&&null!=r.context||r.setContext(e,s)}else{var n=this.utilsFactory[t];this._instance[t]=new n(e,s)}return this._instance[t]};var n=function(t,e){this.context=t,this.parentContext=e};n.prototype.setContext=function(t,e){this.context=t||this.context,this.parentContext=e||this.parentContext};var i=function(t,e){this.context=t,this.parentContext=e,this.monthNumbers=[1,2,3,4,5,6,7,8,9,10,11,12],this.monthNames={"en-short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],he:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],"he-short":["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],"es-short":["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],es:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],fr:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],"fr-short":["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"]}};i.prototype.getMonthName=function(t){var e=this.monthNames[t];return e||(e=this.monthNames.en),e},i.prototype.getMonthNumber=function(t,e){return this.monthNames[t].indexOf(e.replace(/'/gi,""))},i.prototype.setContext=function(t,e){this.context=t||this.context,this.parentContext=e||this.parentContext},i.prototype.getday=function(t,e){return this.getDay(t,e)},i.prototype.getDay=function(t,s){var r;e.verbose("Calling dateUtils.getDay("+t+", "+s+")");var n=t.split(".")[0].replace(/T/g," ");n=n.split("-").join("/"),t=isNaN(Date.parse(n))?t:n;var i=new Date(t),a=i.getDate(),o=parseInt(s);return isNaN(o)?r=a:(i.setDate(a+o),r=i.getDate()),e.verbose("Result: "+r),r},i.prototype.getmonth=function(t,e){return this.getMonth(t,e)},i.prototype.getMonth=function(t,r){var n;e.verbose("Calling dateUtils.getMonth("+t+", "+r+")");var i=t.split(".")[0].replace(/T/g," ");i=i.split("-").join("/"),t=isNaN(Date.parse(i))?t:i;var a=new Date(t),o=a.getMonth();if(o==s||null==o||isNaN(o))try{"string"==typeof t?isNaN(t)||(o=parseInt(t)):o=t}catch(s){return e.verbose("dateUtils.getMonth(): invalid input + '"+t+"'"),t}else o=a.getMonth()+1;if(r){var l=o+r,c=this.monthNumbers.length;l>=c?l-=c:l<=0&&(l=c+l),n=l}else n=o;return e.verbose("Result: "+n),n},i.prototype.getdatemonth=function(t,e){return this.getDateMonth(t,e)},i.prototype.getDateMonth=function(t,r){var n;e.verbose("Calling dateUtils.getDateMonth("+t+", "+r+")");var i=t.split(".")[0].replace(/T/g," ");i=i.split("-").join("/"),t=isNaN(Date.parse(i))?t:i;var a=new Date(t),o=a.getMonth()+1,l=a.getFullYear(),c=a.getDate();if(o==s&&null==o&&isNaN(o))return e.verbose("dateUtils.getDateMonth(): invalid input + '"+t+"'"),t;if(r){var u=o+r,d=this.monthNumbers.length;u>=d?(u-=d,l+=1):u<=0&&(u=d+u,l-=1),u<10&&(u="0"+u),c<10&&(c="0"+c),n=l+"-"+u+"-"+c}else n=t;return e.verbose("Result: "+n),n};var a=function(t,e){this.context=t,this.parentContext=e,this.monthNames={"en-short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],he:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],"he-short":["ינו'","פבר'","מרץ","אפר'","מאי","יונ'","יול'","אוג'","ספט'","אוק'","נוב'","דצמ'"],"es-short":["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],es:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],fr:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],"fr-short":["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"]},this.weekDays={en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],es:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},this.defaultCurrency="",this.tableJoinTypes={INNER:"INNER",LEFT:"LEFT"}};a.prototype.setContext=function(t,e){this.context=t||this.context,this.parentContext=e||this.parentContext},a.prototype.monthname=function(t,e,s){return this.monthName(t,e,s)},a.prototype.monthName=function(t,r,n){var i;if(e.verbose("Calling utils.monthName("+t+", "+r+","+n+")"),parseInt(t)!=t){var a=new Date(t),o=a.getMonth();o==s||null==o||isNaN(o)||(o=a.getMonth())}else try{var l=parseInt(t);if(!(l>=1&&l<=12))return e.log("utils.monthName(): invalid month number + '"+t+"'"),t;o=l-1}catch(s){return e.log("utils.monthName(): invalid input + '"+t+"'"),t}var c=e.processor.PStoryConfig.getConfig("lang");1!=r&&"MMM"!=r||(c+="-short");var u=this.monthNames[c];return u?(i=u[o],1==n&&(i=i.toLowerCase()),e.verbose("Result: "+i),i):(e.verbose("utils.monthName(): month names not available + '"+u+"'"),t)},a.prototype.dayname=function(t,e){return this.dayName(t,e)},a.prototype.dayName=function(t,r){var n="";if(parseInt(t)!=t){var i=new Date(t).getDay();if(i==s||null==i||isNaN(i))return e.verbose("utils.dayName(): invalid weekday"),n}else e.verbose("utils.dayName(): invalid date + '"+t+"'");var a=e.processor.PStoryConfig.getConfig("lang"),o=this.weekDays[a];return o?n=o[i]:(e.verbose("utils.dayName(): weekdays names are not available for "+a),n)},a.prototype.formatdate=function(t,e,s){return this.formatDate(t,e,s)},a.prototype.formatDate=function(t,s,r){if(e.verbose("Calling utils.formatDate("+t+", "+s+")"),null==t||t.length<=0)throw{message:"utils.formatDate("+t+", "+s+") Error: invalid dateStr parameter"};void 0!==s&&null!=s||(s=e.processor.PStoryConfig.getConfig("dateFormat"));var n=t.split(".")[0].replace(/T/g," ");n=n.split("-").join("/"),t=isNaN(Date.parse(n))?t:n;var i=new Date(t),a=s,o=s.split(/[\s\/\\\-\:]/),l=(o=s.match(/(dd|DD|d|mmmm|mmm|MMMMM|MMMM|MMM|mm|MM|m|M|YYYY|yy|YY|y|weekday)/g),this);return o.forEach(function(e,s){var r=l.dateFormatToDate(e,i,t);r&&(a=a.replace(e,r))}),r&&(a=this.createAccessibleDateText(a,t,s)),e.verbose("Result: "+a),a},a.prototype.dateFormatToDate=function(t,e,s){var r=null;switch(t){case"d":r=i=e.getDate()+"";break;case"dd":var n=(i=e.getDate()+"").substring(i.length-1);r="1"==n?i+"st":"2"==n?i+"nd":"3"==n?i+"rd":i+"th";break;case"DD":var i;(i=e.getDate())<10&&(i="0"+i),r=i;break;case"mmmm":r=this.monthName(s,!0,!0);break;case"m":case"MMMM":case"MMMMM":r=this.monthName(s);break;case"M":case"MMM":r=this.monthName(s,!0);break;case"mm":r=a=e.getMonth()+1;break;case"MM":r=a=e.getMonth()+1,a<10&&(r="0"+r);break;case"mmm":var a=e.getMonth()+1;a+="",r=this.monthName(a);break;case"y":case"YY":case"YYYY":r=e.getFullYear();break;case"yy":r=e.getFullYear().toString().substring(2);break;case"weekday":r=this.dayName(s)}return r},a.prototype.createAccessibleDateText=function(t,e,s){return accFormat=s.replace(/(mmm|MMM|mm|MM|m|M)/g,"m"),accFormat=accFormat.replace(/DD/g,"dd"),accFormat=accFormat.split(/[\/\\]/).join(" "),s===accFormat?t:"<span class='perso-accessibility-wrapper' role='text'><span class='perso-accessibility-no-read' aria-hidden='true'>"+t+"</span><span class='perso-accessibility-read'>"+this.formatdate(e,accFormat)+"</span></span>"},a.prototype.numberWithCommas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},a.prototype.formatamount=function(t,e,s){return this.formatAmount(t,e,s)},a.prototype.formatAmount=function(t,s,r){if(e.verbose("Calling utils.formatAmount("+t+", "+s+", "+r+")"),void 0===t||null==t)return null;t+="",r=null==r?e.processor.PStoryConfig.getConfig("amountFormat"):r,s=null==s||1==e.processor.PStoryConfig.getConfig("useProjectDefaultCurrency")?e.processor.PStoryConfig.getConfig("currencySymbol"):s;var n,i,a,o="",l="",c="",u="",d=!1;if(r){var p=r.match(/0/g),h=r,f=p?p.length:0;i=parseFloat(t).toFixed(f),f>0&&(c=i.slice(-1*f),u=(i=i.slice(0,-1*f)).slice(-1),i=i.slice(0,-1),h=h.slice(0,-1*(f+1))),(p=h.match(/[,/.]/g)).reverse();var g=h;"+"==r[0]&&(r=r.substring(1),d=!0),Array.isArray(p)&&p.forEach(function(t,e){var s="-"==i.charAt(0)?i.length-1:i.length,r=h.length,n=h.lastIndexOf(t),a=r-n-1;if((a+=g.length-r)>=s)return!1;a*=-1,i=[i.slice(0,a),t,i.slice(a)].join(""),h=h.slice(0,n)}),n=i}else i=t.replace(/\,/g,""),i=this.round(i),n=this.numberWithCommas(i);n.indexOf("-")>-1&&(n=n.substring(1),0==d&&(o="-",l="&minus;"));var y=l+s+n+u+c;return 0==e.processor.PStoryConfig.getConfig("supportHtmlTagInProcessor")?a=o+s+n+u+c:(c="<span class='perso-decimals'>"+c+"</span>",s="<span class='perso-currency'>"+s+"</span>",n="<span class='perso-int-num'>"+n+"</span>",o="<span class='perso-minus-sign'>"+o+"</span>",u="<span class='perso-decimals-dot'>"+u+"</span>",a=e.processor.PStoryConfig.isRtl()?"<span class='perso-amount' role='text' aria-label='"+y+"'>"+s+o+n+u+c+"</span>":"<span class='perso-amount' role='text' aria-label='"+y+"'>"+o+s+n+u+c+"</span>"),e.verbose("Result: "+a),a},a.prototype.formatAmountInteger=function(t,s,r){e.verbose("Calling utils.formatAmountInteger("+t+", "+s+", "+r+")"),t+="",void 0!==(s=null==s?e.processor.PStoryConfig.getConfig("currencySymbol"):s)&&null!=s||(s="");var n,i=t.replace(/\,/g,"");i=parseInt(i);var a=this.numberWithCommas(i);return n=i<0?"-"+s+a.substring(1):s+a,e.verbose("Result: "+n),n},a.prototype.formatpercent=function(t){return this.formatPercent(t)},a.prototype.formatPercent=function(t){e.verbose("Calling utils.formatPercent("+t+")");var s=parseFloat(t);return s*=100,s=Math.round(s),s+="%",e.verbose("Result: "+n),s},a.prototype.limitstring=function(t,e){return this.limitString(t,e)},a.prototype.limitString=function(t,s){e.verbose("Calling utils.limitString("+t+","+s+")");var r=s||parseInt(e.processor.PStoryConfig.getConfig("stringMaxLength")),n=t;return t.length>r&&(n=t.substring(0,r-"...".length)+"..."),n},a.prototype.round=function(t){e.verbose("Calling utils.round("+t+")");var s=parseFloat(t);return s=Math.round(s),e.verbose("Result: "+s),s},a.prototype.abs=function(t){e.verbose("Calling utils.abs("+t+")");var s=null;return null!=t&&(s="string"==typeof t?t.replace("-",""):t,s=Math.abs(s)),e.verbose("Result: "+s),s},a.prototype.highlighttext=function(t){return this.highlightText(t)},a.prototype.highlightText=function(t){return'<span class="perso-highlight">'+t+"</span>"},a.prototype.join=function(t,s,r,n){var i=n||this.tableJoinTypes.INNER,a=r.match(/(\w*)\.(\w*)([\=\!]+)(\w*)\.(\w*)/);if(a){a[1];var o=a[2],l=a[3],c=(a[4],"_JoinLeftTable.getValue(leftIndex,'"+o+"')"+l+"_JoinRightTable.getValue(rightIndex,'"+a[5]+"')"),u=t.size(),d=s.size(),p=t.data.cols,h=t.colMap,f=p.length;if(Array.isArray(s.data.cols))s.data.cols.forEach(function(t,e){p.indexOf(t)<0&&(p.push(t),h[t]=f,f++)});var g,y,m={type:"PTable",cols:p,rows:[]},v={_JoinLeftTable:t,_JoinRightTable:s};void 0!==this.parentContext&&null!=this.parentContext?(y=this.parentContext,(g=this.context)._JoinLeftTable=t,g._JoinRightTable=s):(y=this.context,g=v);for(var b=0;b<u;b++){for(var x=!1,w=0;w<d;w++){var P=c.replace("leftIndex",b).replace("rightIndex",w),C=new e.processor.PExp(P);try{var k=C.eval(g,y)}catch(t){throw{message:"utils.join() - Error: failed to evaluate join expression. Error message: "+t.message,stack:t.stack}}if(k){x=!0;var B=new Array(p.length);for(var T in h)if(h.hasOwnProperty(T)){var A=h[T];(S=t.getValue(b,T))||(S=s.getValue(w,T)),B[A]=S}m.rows.push(B)}}if(!x&&i==this.tableJoinTypes.LEFT){B=new Array(p.length);for(var T in h)if(h.hasOwnProperty(T)){var S;A=h[T];(S=t.getValue(b,T))||(S=null),B[A]=S}m.rows.push(B)}}return new e.processor.PTable(m)}return t},e.processor=e.processor||{},e.processor.PUtils=new r}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PStoryConfig=new function(){this.configMap={dateFormat:"MM/DD/YY",amountFormat:"###,###,###",currencySymbol:"$",useProjectDefaultCurrency:!1,lang:"he",supportHtmlTagInProcessor:"false",stringMaxLength:"15",context:"",serverCallBack:""},this.getConfig=function(t){return this.configMap.hasOwnProperty(t)?this.configMap[t]:null},this.setConfig=function(t,e){this.configMap.hasOwnProperty(t)&&"undefined"!=e&&null!=e&&(this.configMap[t]=e)},this.rtlMap={en:!1,he:!0},this.isRtl=function(){var t=this.configMap.lang;return!!this.rtlMap.hasOwnProperty(t)&&this.rtlMap[t]}}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PDataSource=function(t){this.data=t},e.processor.PDataSource.prototype.getType=function(){return this.type},e.processor.PDataSource.prototype.getData=function(){return this.data},e.processor.PDataSource.prototype.get=function(t){var e=this.data[t];return e&&e.type,e},e.processor.PDataSource.prototype.getChild=function(t,s){return e.processor.PDataSource.prototype.isPrototypeOf(t)?t.get(s):t[s]}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PFuture=function(){e.processor.PDataSource.call(this,{type:"future",future:!0}),this.type="future",this.future=!0},e.processor.PFuture.prototype=Object.create(e.processor.PDataSource.prototype),e.processor.Future=new e.processor.PFuture}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.POptionModel=function(t,s){e.processor.PDataSource.call(this,t),this.filteredFields=t.whiteListFields,this.parentDataSource=s},e.processor.POptionModel.prototype=Object.create(e.processor.PDataSource.prototype),e.processor.POptionModel.prototype.get=function(t){if(!this.filteredFields||this.filteredFields.hasOwnProperty(t)){var s=this.filteredFields?this.filteredFields[t]:t,r=e.processor.PDataSource.prototype.get.call(this,s);return r||(r=this.parentDataSource.get(t)),r}return"NOPE"}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{};var r={sum:{startValue:0,method:function(t,e){return t.value+e}},avg:{startValue:0,method:function(t,e){return((t.size-1)*t.value+e)/t.size}},count:{startValue:0,method:function(t,e){return t.size}},standardDeviation:{startValue:0,method:function(t,e,s,r){if(1==t.size&&(t.mem={items:[]}),t.mem.items.push(e),s==r-1){var n,i,a,o=0;return t.mem.items.forEach(t.mem.items,function(t,e){o+=t}),a=o/t.mem.items.length,t.mem.items.forEach(t.mem.items,function(t,e){var s=t-a;i+=Math.pow(s,2)}),n=i/t.mem.items.length,Math.sqrt(n)}return null}},min:{},max:{}},n="PText";e.processor.PTable=function(t){e.processor.PDataSource.call(this,t),this.name=t.name,this.colMap={},this.data={cols:[],rows:[]},this.attributesTypes=t.attributesTypes,this.filter.bind(this),this.loadTable(t)},e.processor.PTable.prototype=Object.create(e.processor.PDataSource.prototype),e.processor.PTable.prototype.toString=function(){var t={name:this.name,cols:this.data.cols,rows:this.data.rows,attributesTypes:this.data.attributesTypes,type:this.data.type};return JSON.stringify(t)},e.processor.PTable.prototype.loadTable=function(t){if(t&&!t.future){this.data=t;var e={};t.cols.forEach(function(t,s){e[t]=s}),this.colMap=e}},e.processor.PTable.prototype.loadObjArray=function(t){if(t){var e={},s=[],r=0;t.forEach(function(t){for(var s in t)if(t.hasOwnProperty(s)){var n=e[s];n||(n=r++,e[s]=n)}}),this.colMap=e;var n=e.length,i=new Array(n);for(var a in e){if(e.hasOwnProperty(a))i[e[a]]=a}t.forEach(function(t){var r=new Array(n);for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];r[e[i]]=a}s.push(r)}),this.data={cols:i,rows:s}}},e.processor.PTable.prototype.getObjArray=function(){for(var t=[],e=0;e<this.getRowCount();e++){for(var s={},r=0;r<this.data.cols.length;r++)s[this.data.cols[r]]=i(this.data,r,e);t.push(s)}return t},e.processor.PTable.prototype.getColIndex=function(t){return this.colMap[t]},e.processor.PTable.prototype.size=function(){var t;return t=this.data.hasOwnProperty("rows")?this.data.rows.length:0,e.verbose("Calling '"+this.name+"'.size()"),e.verbose("Result: "+t),t},e.processor.PTable.prototype.getrowcount=function(){return this.getRowCount()},e.processor.PTable.prototype.getRowCount=function(){var t=this.data.rows.length;return e.verbose("Calling '"+this.name+"'.getRowCount()"),e.verbose("Result: "+t),t},e.processor.PTable.prototype.getrow=function(t){return this.getRow(t)},e.processor.PTable.prototype.getRow=function(t){for(var s=[],r=0;r<this.data.rows[t].length;r++)s[r]=i(this.data,r,t);return e.verbose("Calling '"+this.name+"'.getRow("+t+")"),e.verbose("Result: "+JSON.stringify(s)),s},e.processor.PTable.prototype.getfirstrows=function(t){return this.getFirstRows(t)},e.processor.PTable.prototype.getFirstRows=function(t){e.verbose("Calling '"+this.name+"'.getFirstRows("+t+")");var s=this;if(s.getRowCount()>t){var r=s.data.rows.slice(0,t),n=new e.processor.PTable({cols:s.data.cols,rows:r,name:this.name+".getFirstRows("+t+")",attributesTypes:s.data.attributesTypes,type:s.data.type});return e.verbose("Result: "+n.toString()),n}return e.verbose("Result: "+s.toString()),s},e.processor.PTable.prototype.getlastrows=function(t){return this.getLastRows(t)},e.processor.PTable.prototype.getLastRows=function(t){e.verbose("Calling '"+this.name+"'.getLastRows("+t+")");var s=this;if(s.getRowCount()>t){var r=s.data.rows.slice(0-t),n=new e.processor.PTable({cols:s.data.cols,rows:r,name:this.name+".getLastRows("+t+")",attributesTypes:this.data.attributesTypes,type:this.data.type});return e.verbose("Result: "+n.toString()),n}return e.verbose("Result: "+s.toString()),s},e.processor.PTable.prototype.getrowasobject=function(t){return this.getRowAsObject(t)},e.processor.PTable.prototype.getRowAsObject=function(t){if(e.verbose("Calling '"+this.name+"'.getRowAsObject("+t+")"),t<this.data.rows.length){var s=this.data.rows[t],r={};for(var n in this.colMap)if(this.colMap.hasOwnProperty(n)){var i=this.colMap[n];r[n]=s[i]}return e.verbose("Result: "+JSON.stringify(r)),r}return e.verbose("Result: ''"),""},e.processor.PTable.prototype.getvalue=function(t,e){return this.getValue(t,e)},e.processor.PTable.prototype.getValue=function(t,s){e.verbose("Calling '"+this.name+"'.getValue("+t+", "+s+")");var r=this.size();if(this.colMap.hasOwnProperty(s)&&r>t){this.colMap[s];var n=i(this.data,this.colMap[s],t);return e.verbose("Result: "+n),n}return e.verbose("Result: null"),null};var i=function(t,e,s){switch(t.hasOwnProperty("attributesTypes")&&void 0!==t.attributesTypes&&null!==t.attributesTypes?t.attributesTypes[e]:""){case n:return a(t.rows[s][e]);default:return t.rows[s][e]}},a=function(t){if(null==t)return t;if(t.hasOwnProperty(e.processor.PStoryConfig.getConfig("lang")))return t[e.processor.PStoryConfig.getConfig("lang")];if("object"!=typeof t)return t;var s=function(t){for(var e in t)return e}(t);return s?t[s]:void 0};e.processor.PTable.prototype.filter=function(t,s){if(e.verbose("Calling '"+this.name+"'.filter("+t+", "+s+")"),!s||"all"==s)return e.verbose("No validValue or no filter. Result: "+this.toString()),this;var r,n=[];for(r=0;r<this.getRowCount();r++){this.getValue(r,t)==s&&n.push(this.getRow(r))}var i=new e.processor.PTable({cols:this.data.cols,rows:n,name:this.name+".filter("+t+", "+s+")",attributesTypes:this.data.attributesTypes,type:this.data.type});return e.verbose("Result: "+i.toString()),i},e.processor.PTable.prototype.filterbynumber=function(t,e){return this.filterByNumber(t,e)},e.processor.PTable.prototype.filterByNumber=function(t,e){if(!(arguments.length>2))return this.filter(t,e);arguments[2],arguments.length>3&&arguments[3]};var o=function(t,e){var s=new Date(t),r=e||0;return s=new Date(s.setDate(s.getDate()+r)),new Date(s.setHours(0,0,0,0))};e.processor.PTable.prototype.filterByDays=function(t,s,r,n){var i=s.split(".")[0].replace(/T/g," ");i=i.split("-").join("/"),s=isNaN(Date.parse(i))?s:i,e.verbose("Calling '"+this.name+"'.filterByDays("+t+", "+s+", "+r+", "+n+")");for(var a=o(s,null!=n?n:0),l=o(s,r),c=[],u=0;u<this.getRowCount();u++){var d=this.getValue(u,t),p=new Date(d);p.setHours(0,0,0,0),"object"==typeof p&&p<=a&&p>=l&&c.push(this.getRow(u))}var h=new e.processor.PTable({cols:this.data.cols,rows:c,name:this.name+".filterByDays("+t+", "+s+", "+r+", "+n+")",attributesTypes:this.data.attributesTypes,type:this.data.type});return e.verbose("Result: "+h.toString()),h},e.processor.PTable.prototype.groupby=function(t,e,s){return this.groupBy(t,e,s)},e.processor.PTable.prototype.groupBy=function(t,s,n){var i;e.verbose("Calling '"+this.name+"'.groupBy("+t+", "+s+", "+n+")"),i=n&&r.hasOwnProperty(n)?r[n]:r.sum,Array.isArray(t)||(t=[t]);var a=[];(a=a.concat(t)).push(s);for(var o={},l=this.getRowCount(),c=0;c<l;c++){var u="",d=[];for(var p in t)if(t.hasOwnProperty(p)){p=t[p];var h=this.getValue(c,p);d.push(h),u+=h+","}var f=o[u];f||(f={key:u,keyValues:d,value:i.startValue,size:0},o[u]=f),f.size++;var g=this.getValue(c,s);g=Number(g),f.value=i.method(f,g,c,l)}var y=[];for(f in o)if(o.hasOwnProperty(f)){var m=[],v=o[f];for(j=0;j<t.length;j++)m.push(v.keyValues[j]);m.push(v.value),y.push(m)}var b=new e.processor.PTable({cols:a,rows:y,name:this.name+".groupBy("+t+", "+s+", "+n+")",attributesTypes:this.data.attributesTypes,type:this.data.type});return e.verbose("Result: "+b.toString()),b},e.processor.PTable.prototype.groupByExpression=function(t){e.verbose("Calling '"+this.name+"'.groupByExpression("+t+")");var s=new e.processor.PExp(t),r=this.getObjArray(),n=this.data.rows,i=this.data.cols,a={},o=this;Array.isArray(n)&&n.forEach(function(n,i){var l=r[i];try{var c=s.eval(l);a.hasOwnProperty(c)||(a[c]=[]),a[c].push(n)}catch(s){e.error(o.name+"'.groupByExpression("+t+") Error: Failed to evaluate row "+i+", ignoring row")}});var l=[];for(var c in a)if(a.hasOwnProperty(c)){var u=a[c],d={table:new e.processor.PTable({cols:i,rows:u,name:this.name+".groupByExpression("+t+")",attributesTypes:this.data.attributesTypes,type:this.data.type}),seriesName:c};l.push(d)}for(var p="[",h=0;h<l;h++)p+=","+l[h].toString();return p+="]",e.verbose("Result: "+p),l},e.processor.PTable.prototype.sortbydate=function(t,e){return this.sortByDate(t,e)},e.processor.PTable.prototype.sortByDate=function(t,s){e.verbose("Calling '"+this.name+"'.sortByDate("+t+", "+s+")");var r=1;s&&("asc"==s.toLowerCase()?r=1:"desc"==s.toLowerCase()&&(r=-1));var n=this;Array.isArray(t)||(t=[t]);var i=[];t.forEach(function(t){var e=n.colMap[t];i.push(e)});var a=this.data.rows.slice(0);a.length;a.sort(function(t,e){for(var s=0;s<i.length;s++){var n=i[s],a=new Date(t[n]).getTime()-new Date(e[n]).getTime();if(0!=a)return r*a}return 0});var o=new e.processor.PTable({cols:n.data.cols,rows:a,attributesTypes:n.data.attributesTypes,type:n.data.type});return e.verbose("Result: "+o.toString()),o},e.processor.PTable.prototype.sortbymonth=function(t,e){return this.sortByMonth(t,e)},e.processor.PTable.prototype.sortByMonth=function(t,s){e.verbose("Calling '"+this.name+"'.sortByMonth("+t+", "+s+")");var r=this;Array.isArray(t)||(t=[t]);var n=[];t.forEach(function(t){var e=r.colMap[t];n.push(e)});var i=this.data.rows.slice(0);i.sort(function(t,e){for(var s=0;s<n.length;s++){var r=n[s];return parseInt(t[r])-parseInt(e[r])}return 0});for(var a,o=0,l=1;l<i.length;l++)if(Math.abs(i[l][0]-i[l-1][0])>1){o=l;break}a=o>0?(a=i.slice(o)).concat(i.slice(0,o)):i,s&&"desc"==s.toLowerCase()&&a.reverse();var c=new e.processor.PTable({cols:r.data.cols,rows:a,name:this.name+".sortByMonth("+t+", "+s+")",attributesTypes:r.data.attributesTypes,type:r.data.type});return e.verbose("Result: "+c.toString()),c},e.processor.PTable.prototype.sortby=function(t,e,s){return this.sortBy(t,e,s)},e.processor.PTable.prototype.sortBy=function(t,s,r){e.verbose("Calling '"+this.name+"'.sortBy("+t+", "+s+", "+r+")");var n=1;s&&("asc"==s.toLowerCase()?n=1:"desc"==s.toLowerCase()&&(n=-1));var i=this;Array.isArray(t)||(t=[t]);var a=[];t.forEach(function(t){var e=i.colMap[t];a.push(e)});var o=this.data.rows.slice(0);o.length;o.sort(function(t,e){for(var s=0;s<a.length;s++){var r=a[s],i=t[r],o=e[r];if(i>o)return n;if(i<o)return-n}return 0});var l=new e.processor.PTable({cols:i.data.cols,rows:o,attributesTypes:i.data.attributesTypes,type:i.data.type});return e.verbose("Result: "+l.toString()),l},e.processor.PTable.prototype.getasgroupedTable=function(t){return this.getAsGroupedTable(t)},e.processor.PTable.prototype.getAsGroupedTable=function(t){e.verbose("Calling '"+this.name+"'.getAsGroupedTable("+t+")");var s,r=[],n={};return Array.isArray(this.data.rows)&&this.data.rows.forEach(function(i,a){var o=t(i).trim(),l=n[o];if(null==l){s={encValue:e.utils.string.stripSpecialChars(o),value:o,rows:[]},r.push(s);var c=r.length-1;n[o]=c}else s=r[l];var u=jQuery.extend({},i);s.rows.push(u)}),e.verbose("Result: "+r),r},e.processor.PTable.prototype.max=function(t){e.verbose("Calling '"+this.name+"'.max("+t+")");var s=this.extremum(t,function(t,e){return t<e},"max");return e.verbose("Result: "+s),s},e.processor.PTable.prototype.min=function(t){e.verbose("Calling '"+this.name+"'.min("+t+")");var s=this.extremum(t,function(t,e){return t>e},"min");return e.verbose("Result: "+s),s},e.processor.PTable.prototype.extremum=function(t,s,r){if(0==this.getRowCount())return this;for(var n=this.getColIndex(t),i=this.data.rows[0],a=i[n],o=0;o<this.getRowCount();o++){var l=this.data.rows[o],c=l[n];s("string"==typeof a?parseFloat(a):a,"string"==typeof c?parseFloat(c):c)&&(a=c,i=l)}return new e.processor.PTable({cols:this.data.cols,rows:[i],name:this.name+"."+r+"("+t+", "+s+")",attributesTypes:this.data.attributesTypes,type:this.data.type})},e.processor.PTable.prototype.addComputedCol=function(t,s){var r=new e.processor.PExp(s),n=this.data.cols.slice(0);n.push(t);for(var i=[],a=this,o=0;o<this.getRowCount();o++){var l=this.data.rows[o];try{var c=r.eval(l),u=l.slice(0);u.push(c),i.push(u)}catch(r){e.error(a.name+"'.addComputedCol("+t+", "+s+") Error: Failed to valuate row "+o+", ignoring row")}}return new e.processor.PTable({cols:n,rows:i,name:this.name+".addComputedCol("+t+", "+s+")",attributesTypes:this.data.attributesTypes,type:this.data.type})},e.processor.PTable.prototype.map=function(t,e,s){if(0==this.getRowCount())return null!=s?s:{};this.getColIndex(t);for(var r=s||0,n=0;n<this.getRowCount();n++)r=e(r,this.getValue(n,t));return r},e.processor.PTable.prototype.sum=function(t){e.verbose("Calling '"+this.name+"'.sum("+t+")");var s=this.map(t,function(t,e){var s=t;"string"==typeof t&&(s=parseFloat(t));var r=e;return"string"==typeof e&&(r=parseFloat(e)),s+r},0);return e.verbose("Result: "+s),s},e.processor.PTable.prototype.avg=function(t){e.verbose("Calling '"+this.name+"'.avg("+t+")");var s=0;this.getRowCount()>0&&(s=this.sum(t)/this.getRowCount());return e.verbose("Result: "+s),s},e.processor.PTable.prototype.first=function(t){var s;if(e.verbose("Calling '"+this.name+"'.first("+t+")"),this.getRowCount()>0)if(t)s=this.getValue(0,t);else{var r=[];r.push(this.getRow(0)),s=new e.processor.PTable({cols:this.data.cols,rows:r,name:this.name+".first("+t+")",attributesTypes:this.data.attributesTypes,type:this.data.type}).getObjArray()[0]}else s=this;return e.verbose("Result: "+s),s},e.processor.PTable.prototype.last=function(t){var s;e.verbose("Calling '"+this.name+"'.last("+t+")");var r=this.getRowCount();if(r>0)if(t)s=this.getValue(r-1,t);else{var n=[];n.push(this.getRow(r-1)),s=new e.processor.PTable({cols:this.data.cols,rows:n,name:this.name+".last("+t+")",attributesTypes:this.data.attributesTypes,type:this.data.type}).getObjArray()[0]}else if(t){if("month"==t||"amount"==t)return 0;s=null}else s=null;return e.verbose("Result: "+s),s},e.processor.PTable.prototype.abs=function(t){var s;e.verbose("Calling '"+this.name+"'.last("+t+")");var r=[],n=this.colMap[t];for(s=0;s<this.getRowCount();s++){for(var i=this.getRow(s),a=[],o=0;o<i.length;o++){var l=i[o];o==n&&(l=Math.abs(l)),a.push(l)}r.push(a)}return new e.processor.PTable({cols:this.data.cols,rows:r,name:this.name+".abs("+t+")",attributesTypes:this.data.attributesTypes,type:this.data.type})}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{};var r=["PNumber","PAmount","PDate","PString"];e.processor.PFact=function(t,s,n){e.processor.PTable.call(this,t),this.dataType=s,this.formats=n,this.name=t.name,this.isPrimitive=r.indexOf(s)>=0},e.processor.PFact.prototype=Object.create(e.processor.PTable.prototype),e.processor.PFact.prototype.get=function(t){var e=t;return this.isPrimitive&&(e="value"),this.getValue(0,e)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PQuery=function(t,e){this.queryName=t.queryName,this.model=e,this.preQueryParams=t.queryParams,this.queryParams={},this.data=null,this.evalParams()},e.processor.PQuery.prototype.evalParams=function(){var t=this;this.preQueryParams.forEach(function(s,r){var n=s.paramName,i=s.varName,a=new e.processor.PExp(i).eval(t.model);a&&(t.queryParams[n]=a)})},e.processor.PQuery.prototype.getCacheKey=function(){var t=this.queryName+"?";for(var e in this.queryParams)this.queryParams.hasOwnProperty(e)&&(t+=e+"="+this.queryParams[val]+"&");return t},e.processor.PQuery.prototype.getData=function(t){if(this.data)return this.data;if(!personetics.pserverProxy)return null;return personetics.getQueryData({id:t.story.insight.id,queryName:this.queryName,queryParams:this.queryParams},e.bind(this,this.handleQuery)),e.processor.Future},e.processor.PQuery.prototype.handleQuery=function(t){this.model.handleQuery(this,t)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PModel=function(t,s){e.processor.PDataSource.call(this,s.facts),this.initPModel(s.facts,s.expressions),this.parent=t},e.processor.PModel.prototype=Object.create(e.processor.PDataSource.prototype),e.processor.PModel.prototype.initPModel=function(t,e){this.factsConfigs={},this.facts=t,this.expressionsConfigs={},this.expressions=e,this.varCfgs={},this.varValues={},this.varValuesForSave={},this.queryCfgs={},this.queryCache={},this.exps={},this.cache={},this.setupObjFactory(),r(this.facts,this.factsConfigs),r(this.expressions,this.expressionsConfigs),this.listeners=[]},e.processor.PModel.prototype.setFormats=function(t){this.formats=t},e.processor.PModel.prototype.setupObjFactory=function(){var t=this;this.objFactory={},this.objFactory.PTable=function(t){return new e.processor.PTable(t)},this.objFactory.PObjList=function(t){var s=new e.processor.PTable;return s.loadObjArray(t),s},this.objFactory.PFact=function(s,r){return new e.processor.PFact(s,r,t.formats)}},e.processor.PModel.prototype.createObj=function(t,e){var s=e,r=t;"PTable"!=t&&"PObjList"!=t&&(r="PFact");var n=this.objFactory[r];return n&&(s=n(e,t)),s.isPrimitive&&(s=s.get()),s},e.processor.PModel.prototype.test=function(t){var e=this.get(t,{test:!0});return{success:!!e,value:e}},e.processor.PModel.prototype.get=function(t,s){var r="",n=this.cache[t];if(null!=n)return n;var i=this.varCfgs[t];!n&&i&&(n=this.getVarValue(t));var a=this.factsConfigs[t];!n&&a&&(null==(n=a)?e.log("PStoryModel.get('"+t+"') - Error: fact exists but is invalid: '"+n+"'. Trying to evaluate as expression"):a.type&&(n.name=t,n=this.createObj(a.type,n)));var o=this.expressionsConfigs[t];if(!n&&o){try{n=jsep(o)}catch(s){e.log("PStoryModel.get('"+t+"') Error - Invalid expression string: '"+o+"'"),n=null}null==n&&e.log("PStoryModel.get('"+t+"') - Error: expression exists but is invalid: '"+n+"'. Trying to evaluate as expression")}if(null==n){if(this.lastGetValue&&this.lastGetValue==t)return this.lastGetValue=null,null;this.lastGetValue=t;var l=new e.processor.PExp(t);try{null==(n=l.eval(this,null,s))&&(!0,r="PStoryModel.get('"+t+"') - Error: Evaluating as expression returned an invalid result: '"+n+"'")}catch(e){n=null,!0,r="PStoryModel.get('"+t+"') Error: Failed to evaluate as expression: \n\t"+e.message}}return null!=n?this.cache[t]=n:e.error(r,null,s),n},e.processor.PModel.prototype.fetchFromSrc=function(t,s){var r=null,n=null;if("query"==s){var i=new e.processor.PQuery({queryName:t.config.queryName,queryParams:t.config.queryParams},this);return this.currentQueryBlock=t,i.getData(t)}var a=new e.processor.PExp(s);try{null==(n=a.eval(this))&&(r=this.err(null,"PStoryModel.fetchFromSrc('"+s+"') - Error: Evaluating as expression returned an invalid result: '"+n+"'",!1))}catch(t){r=this.err(t,"PStoryModel.fetchFromSrc('"+s+"') - Error: Failed to evaluate source as expression \n\t"+t.message,!1)}return r&&e.error(r),n},e.processor.PModel.prototype.getData=function(){return this.facts},e.processor.PModel.prototype.setVarValue=function(t,e){var s=this;this.varCfgs.hasOwnProperty(t)||(this.varCfgs[t]=t),this.cache={};var r=e||null;this.varValues[t]=r,this.listeners.forEach(function(t,e){var r=t.listener;t.callback.call(r,s.varValues)})},e.processor.PModel.prototype.getVarValue=function(t){return this.varValues[t]},e.processor.PModel.prototype.handleQuery=function(t,s){var r;if(null!=s&&s.hasOwnProperty("story")){(r=s.story.hasOwnProperty("insightFacts")?s.story.insightFacts.query:s.story.facts.query).name="query";var n=this.createObj(s.type,r);t.data=n;var i=t.getCacheKey();this.queryCfgs[i]=t,this.factsConfigs.query=n,this.currentQueryBlock&&this.parent.handleQueryData(this.currentQueryBlock,n)}e.error("Personetics.processor.PModel.prototype.handleQuery - Invalid query params: "+JSON.stringify(s))},e.processor.PModel.prototype.err=function(t,e,s){s=null!=s&&0!=s;var r=null,n=null;null!=t&&("object"==typeof t?(t.hasOwnProperty("message")&&(r=t.message),t.hasOwnProperty("stack")&&(n=t.stack)):"string"==typeof t&&(r=t));var i=e;if(r&&r.length>0&&(i+=". Cause: "+r),s)throw{message:i,stack:n};return i+n},e.processor.PModel.prototype.addListener=function(t,e){this.listeners.push({listener:t,callback:e})};var r=function(t,e){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{};var r=/{{([^\n\t\v{}]*)}}/g;e.processor.PTextTemplate=function(t,e){this.textTemplate=t,this.globalContext=e,this.tokens={},this.compile()},e.processor.PTextTemplate.prototype.compile=function(){if(this.textTemplate&&this.textTemplate.length>0){var t=this,s=this.textTemplate.match(r);s&&s.forEach(function(s,r){if(!t.tokens.hasOwnProperty(s)){var n=s.replace("{{","").replace("}}",""),i={};i.str=n,i.exp=new e.processor.PExp(n),t.tokens[s]=i}})}},e.processor.PTextTemplate.prototype.process=function(t,s,r){var n=this.textTemplate,i=this.tokens;for(var a in i)if(i.hasOwnProperty(a)){var o,l=i[a],c=t||this.globalContext;try{o=l.exp.eval(c,s)}catch(t){e.error("PTextTemplate.process('"+this.textTemplate+"') - Error: Failed to evaluate token '"+l.str+". Error message: "+t.message+t.stack),o="{{"+l.str+"}}"}var u=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),d=new RegExp(u,"g");n=n.replace(d,o)}return n},e.processor.PTextTemplate.prototype.getTextTemplate=function(){return this.textTemplate}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.BlockProcessor=function(t,e,s,r,n,i){this.parent=t,this.config=e,this.model=r,this.texts=s,this.dlgId=n,this.index=i},e.processor.BlockProcessor.prototype.initProcessor=function(){},e.processor.BlockProcessor.prototype.processData=function(){return this.layoutInstructions=this.copyConfig(this.config),this.setDefaultSelectedValue(),this.layoutInstructions},e.processor.BlockProcessor.prototype.processText=function(t,e,s){var r=this.getText(t);return r?r.process(e,s,this):"-"},e.processor.BlockProcessor.prototype.getText=function(t){var s;return this.texts&&this.texts.hasOwnProperty(t)&&(s=new e.processor.PTextTemplate(this.texts[t],this.model)),s},e.processor.BlockProcessor.prototype.getRealValue=function(t){return t},e.processor.BlockProcessor.prototype.setSelectedValue=function(t){this.config.selected=t},e.processor.BlockProcessor.prototype.handleQueryData=function(t){this.doProcessData(t)},e.processor.BlockProcessor.doProcessData=function(t){throw"Personetics.processor.BlockProcessor.doProcessData - Not implemented for block class '"+this.config.type+"'"},e.processor.BlockProcessor.prototype.setDefaultSelectedValue=function(){var t=this.getRealValue(this.config.selected);this.parent.setBlockVarValue(this.config,t)},e.processor.BlockProcessor.prototype.copyConfig=function(t){var e={};for(var s in t)if(t.hasOwnProperty(s)){var r=t[s];if(null!=r)if(r.constructor===[].constructor){var n=[];r.forEach(function(t,e){n.push(t)}),e[s]=n}else if(r.constructor=={}.constructor){var i=this.copyConfig(r);e[s]=i}else e[s]=r;else e[s]=r}return e}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.TextBlockProcessor=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.TextBlockProcessor.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.TextBlockProcessor.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this.config.txt||this.config.text;this.config.hasOwnProperty("txt")&&delete this.layoutInstructions.txt,this.config.hasOwnProperty("text")&&delete this.layoutInstructions.text;var s=this.processText(t,this.model);return this.layoutInstructions.text=s,this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.ImageBlock=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.ImageBlock.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.ImageBlock.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this.processText(this.config.url,this.model),s=this.processText(this.config.alt,this.model);return this.layoutInstructions.url=t,this.layoutInstructions.alt=s,this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{};var r="static",n="data";e.processor.OptionsProcessorBlock=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.OptionsProcessorBlock.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.OptionsProcessorBlock.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this;this.layoutInstructions.options=[];var s=this.config.options;if(s&&0!=s.length)return this.selectedOptId=null,this.config.selected&&(this.config.selected.hasOwnProperty("id")?this.selectedOptId=this.config.selected.id:this.selectedOptId=this.config.selected),this.hasSelected=!1,s.forEach(function(e,s){e.hasOwnProperty("type")||(e.type="static"),t.handleOption(e)}),this.setDefaultSelectedValue(),this.layoutInstructions},e.processor.OptionsProcessorBlock.prototype.addStaticOption=function(t,e){var s={};s.id=this.getOptId(t.id),s=this.addProperties(t,s,e),this.layoutInstructions.options.push(s)},e.processor.OptionsProcessorBlock.prototype.addProperties=function(t,s,r){s.id=void 0===s.id||"-"===s.id?t.id:s.id,s.selected=!1,s.id==r&&(s.selected=!0,this.hasSelected=!0),t.hasOwnProperty("class")&&(s.class=t.class);var n=new e.processor.POptionModel(t,this.model),i=t.txt||t.text;if(s.text=this.processText(i,n,this.model),null!=t)for(var a in t)t.hasOwnProperty(a)&&!s.hasOwnProperty(a)&&(s[a]=t[a]);return s},e.processor.OptionsProcessorBlock.prototype.getOptId=function(t){return this.processText(t,this.model)},e.processor.OptionsProcessorBlock.prototype.addDynamicOption=function(t,e){var s=this;if(t.type==n&&t.src&&t.src.length>0){var r=this.model.fetchFromSrc(this,t.src);null!=r&&(r=r.getObjArray()).forEach(function(r){r.text=t.text||t.txt;var n={};n=s.addProperties(r,n,e),s.layoutInstructions.options.push(n)})}},e.processor.OptionsProcessorBlock.prototype.getRealValue=function(t){var e=t;return this.layoutInstructions.options.forEach(function(s,r){if(s.id==t)return e=s,!1}),e},e.processor.OptionsProcessorBlock.prototype.setSelectedValue=function(t){var e=this;this.layoutInstructions.options.forEach(function(s,r){s.id==t.id?(s.selected=!0,e.config.selected=s):s.selected=!1})},e.processor.OptionsProcessorBlock.prototype.handleOption=function(t){var e=!1;switch(t.type){case r:this.addStaticOption(t,this.selectedOptId),e=!0;break;case n:this.addDynamicOption(t,this.selectedOptId),e=!0;break;default:e=!1}return e}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{};var r="navigateToPage",n="toggle",i="payload";function a(t,s){if(t.hasOwnProperty("payload")&&t.payload){var r=e.processor.PStoryConfig.getConfig("supportHtmlTagInProcessor");for(var n in e.processor.PStoryConfig.setConfig("supportHtmlTagInProcessor",!1),s.payload={},t.payload)"string"==typeof t.payload[n]?s.payload[n]=this.processText(t.payload[n],this.model):(s.payload[n]={},o.call(this,t.payload[n],s.payload[n]));e.processor.PStoryConfig.setConfig("supportHtmlTagInProcessor",r)}}function o(t,e){for(var s in t)"string"==typeof t[s]?e[s]=this.processText(t[s],this.model):(e[s]={},o.call(this,t[s],e[s]))}e.processor.ButtonsProcessorBlock=function(t,s,r,n,i,a){e.processor.OptionsProcessorBlock.call(this,t,s,r,n,i,a),this.isAllNavigateTo=!1},e.processor.ButtonsProcessorBlock.prototype=Object.create(e.processor.OptionsProcessorBlock.prototype),e.processor.ButtonsProcessorBlock.prototype.processData=function(){this.config.hasOwnProperty("buttonType")&&("navigateTo"==this.config.buttonType&&(this.isAllNavigateTo=!0));return this.layoutInstructions=e.processor.OptionsProcessorBlock.prototype.processData.call(this),this.layoutInstructions.id=this.config.index,this.layoutInstructions.hasOwnProperty("default")&&delete this.layoutInstructions.default,this.layoutInstructions.hasOwnProperty("selected")&&delete this.layoutInstructions.selected,this.layoutInstructions},e.processor.ButtonsProcessorBlock.prototype.addProperties=function(t,s,n){return s=e.processor.OptionsProcessorBlock.prototype.addProperties.call(this,t,s,n),t.type==r&&null!=t.navigateTarget&&t.navigateTarget.length>0&&null!=s&&(s.navigateTarget=this.evalNavigateTarget(t.navigateTarget),a.call(this,t,s)),this.isAllNavigateTo&&null!=s&&(s.navigateTarget=this.evalNavigateTarget(t.id),a.call(this,t,s)),s},e.processor.ButtonsProcessorBlock.prototype.addToggleOption=function(t,e){null!=e&&0!=e.length||(e="off"),this.hasSelected=!0,this.prepareToggleButton(t,e)},e.processor.ButtonsProcessorBlock.prototype.addNavigateToOption=function(t,e){var s={};s.id=this.processText(t.id,this.model),s=this.addProperties(t,s,e),this.layoutInstructions.options.push(s)},e.processor.ButtonsProcessorBlock.prototype.evalNavigateTarget=function(t){var s,r=new e.processor.PExp(t);try{s=r.eval(this.model,null,{shouldDisplayError:!1})}catch(e){s=t}return s},e.processor.ButtonsProcessorBlock.prototype.prepareToggleButton=function(t,s){var r,n="perso-toggle",i={type:t.type},a={type:t.type};i.id="on",i.class=n,i.on=!0,i.off=!1,i.selected="on"==s;var o=new e.processor.POptionModel(i,this.model),l=t.onTxt||t.onText;r=this.processText(l,o),i.text=r,this.layoutInstructions.options.push(i),a.id="off",a.class=n,a.on=!1,a.off=!0,a.selected="off"==s,o=new e.processor.POptionModel(a,this.model);var c=t.offTxt||t.offText;r=this.processText(c,o),a.text=r,this.layoutInstructions.options.push(a),this.model.varValuesForSave[this.config.var]=!0},e.processor.ButtonsProcessorBlock.prototype.handleOption=function(t){var s=!1;if(!(s=e.processor.OptionsProcessorBlock.prototype.handleOption.call(this,t)))switch(t.type){case n:this.addToggleOption(t,this.selectedOptId),s=!0;break;case r:case i:this.addNavigateToOption(t,this.selectedOptId),s=!0;break;default:s=!1}return s}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.AccountSelectorProcessorBlock=function(t,s,r,n,i,a){e.processor.OptionsProcessorBlock.call(this,t,s,r,n,i,a)},e.processor.AccountSelectorProcessorBlock.prototype=Object.create(e.processor.OptionsProcessorBlock.prototype),e.processor.AccountSelectorProcessorBlock.prototype.processData=function(){if(this.config.options=[{type:"data",src:this.config.src,text:this.config.accountText}],this.config.showAll){var t={text:this.config.allAccountsText,id:"all",type:"static"};this.config.options.push(t)}return this.layoutInstructions=e.processor.OptionsProcessorBlock.prototype.processData.call(this),delete this.layoutInstructions.src,delete this.layoutInstructions.allAccountsText,delete this.layoutInstructions.accountText,delete this.layoutInstructions.showAll,this.layoutInstructions.hasOwnProperty("default")&&delete this.layoutInstructions.default,this.layoutInstructions.hasOwnProperty("selected")&&delete this.layoutInstructions.selected,this.layoutInstructions.id=this.config.index,this.layoutInstructions},e.processor.AccountSelectorProcessorBlock.prototype.getOptId=function(t){return t}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.TextBoxesProcessorBlock=function(t,s,r,n,i,a){e.processor.OptionsProcessorBlock.call(this,t,s,r,n,i,a)},e.processor.TextBoxesProcessorBlock.prototype=Object.create(e.processor.OptionsProcessorBlock.prototype),e.processor.TextBoxesProcessorBlock.prototype.processData=function(){return this.config.options=this.config.boxes,this.layoutInstructions=e.processor.OptionsProcessorBlock.prototype.processData.call(this),this.layoutInstructions.options.forEach(function(t){t.selected&&delete t.selected}),delete this.layoutInstructions.boxes,this.layoutInstructions},e.processor.TextBoxesProcessorBlock.prototype.handleOption=function(t){this.addStaticOption(t,this.selectedOptId)},e.processor.TextBoxesProcessorBlock.prototype.addStaticOption=function(t,s){var r={},n=new e.processor.POptionModel(r,this.model);r.label=this.processText(t.label,n,this.model),t.image&&(r.image=this.processText(t.image,n,this.model),this.layoutInstructions.hasOwnProperty("hasImage")||(this.layoutInstructions.hasImage=!0));var i,a=new e.processor.POptionModel(t,this.model),o=new e.processor.PExp(t.value);try{i=o.eval(a)}catch(s){e.error("TextBoxesProcessorBlock.addStaticOption() Error: Failed to evaluate textBox value. Error message: "+s.message+s.stack),i=t.value}r.value=i,this.layoutInstructions.options.push(r)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.TabsProcessorBlock=function(t,s,r,n,i,a){e.processor.OptionsProcessorBlock.call(this,t,s,r,n,i,a)},e.processor.TabsProcessorBlock.prototype=Object.create(e.processor.OptionsProcessorBlock.prototype),e.processor.TabsProcessorBlock.prototype.processData=function(){return this.config.options=this.config.tabs,this.layoutInstructions=e.processor.OptionsProcessorBlock.prototype.processData.call(this),this.layoutInstructions.id=this.config.index,this.layoutInstructions.class=this.config.class||"perso-tabs",this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.HBoxBlock=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a),this.id="block-layout_"+s.index,this.index=s.index,this.columns=[],this.processorFactory=t.processorFactory},e.processor.HBoxBlock.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.HBoxBlock.prototype.initProcessor=function(){e.processor.BlockProcessor.prototype.initProcessor.call(this);var t=this;this.config.columns.forEach(function(e,s){var r={width:e.width,"v-align":e["v-align"],blocks:[]};e.hasOwnProperty("class")&&(r.class=e.class),e.blocks.forEach(function(e,s){e.index=s,t.parent.evaluateDefault(e);var n=t.parent.createProcessor(e,t.dlgId);r.blocks.push({processor:n,config:e})}),t.columns.push(r)})},e.processor.HBoxBlock.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this;return this.layoutInstructions.columns=[],this.columns.forEach(function(s,r){var n={width:s.width,"v-align":s["v-align"],blocks:[]};s.hasOwnProperty("class")&&(n.class=s.class),s.blocks.forEach(function(s,r){var i=s.processor,a=s.config,o=!0;if(a.hasOwnProperty("showIf")&&null!==a.showIf&&a.showIf.length>0){var l=new e.processor.PExp(a.showIf);try{o=l.eval(t.model)}catch(t){o=!1,e.error("HBoxBlock.processData() Error: Failed to evaluate showIf property, not showing block. Error Message: "+t.message+t.stack)}}if(o){var c=i.processData();n.blocks.push(c)}}),n.blocks.length>0&&t.layoutInstructions.columns.push(n)}),this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.LayoutBlock=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a),this.id="block-layout_"+s.index,this.index=s.index,this.blocks=[],this.processorFactory=t.processorFactory},e.processor.LayoutBlock.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.LayoutBlock.prototype.initProcessor=function(){e.processor.BlockProcessor.prototype.initProcessor.call(this);var t=this;this.blocks=[],this.config.blocks.forEach(function(e,s){e.index=s;var r=t.parent.createProcessor(e,t.dlgId);t.blocks.push({processor:r,config:e})})},e.processor.LayoutBlock.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this;return this.layoutInstructions.layout=this.config.layout,this.layoutInstructions.blocks=[],this.blocks.forEach(function(s,r){s.layout;var n=s.processor,i=s.config,a=!0;i.showIf&&(a=new e.processor.PExp(i.showIf).eval(t.model));if(a){var o=n.processData();t.layoutInstructions.blocks.push(o)}}),this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.DateBoxBlockProcessor=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.DateBoxBlockProcessor.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.DateBoxBlockProcessor.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this.processText(this.config.date,this.model);return this.layoutInstructions.date=t,this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.TableBlockProcessor=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.TableBlockProcessor.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.TableBlockProcessor.prototype.processData=function(){var t=this.config,s=t.src,r=this.model.fetchFromSrc(this,s);return r==e.processor.Future?{type:t.type,future:!0}:this.doProcessData(r)},e.processor.TableBlockProcessor.prototype.doProcessData=function(t){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this),delete this.layoutInstructions.src;return null!=t&&t.hasOwnProperty("data")&&(this.layoutInstructions.rows=t.data.rows,this.layoutInstructions.cols=t.data.cols),this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.BarBlockProcessor=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.BarBlockProcessor.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.BarBlockProcessor.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this,s=this.config,r=s.src,n=this.model.fetchFromSrc(this,r);if(this.layoutInstructions.direction=s.direction||"vertical",null!=n){var i=this.getCategories(),a=this.getCategories(),o=s.series;if(o){var l=n.groupByExpression(o),c=this.getSeries();this.seriesLabels=c,this.layoutInstructions.seriesLabels=c;var u=[];null!=c&&c.length>0?c.forEach(function(e,s){var r=l.filter(function(t){return t.seriesName==e})[0],n=[];void 0!==r&&(n=r.table.getObjArray());var a=t.prepareDataByCategories(n,i);u.push(a)}):l.forEach(function(e,s){var r=e.table.getObjArray(),n=t.prepareDataByCategories(r,i);u.push(n)}),this.layoutInstructions.series=u}else{var d=n.getObjArray();if(null!=i)var p=this.prepareDataByCategories(d,i);else p=this.prepareData(d);this.layoutInstructions.series=[p],this.seriesLabels=[""]}}this.layoutInstructions.hasOwnProperty("varSource")&&delete this.layoutInstructions.varSource,this.layoutInstructions.hasOwnProperty("default")&&delete this.layoutInstructions.default,this.layoutInstructions.hasOwnProperty("selected")&&delete this.layoutInstructions.selected,this.layoutInstructions.hasOwnProperty("seriesNames")&&delete this.layoutInstructions.seriesNames,delete this.layoutInstructions.x,delete this.layoutInstructions.y,delete this.layoutInstructions.label,delete this.layoutInstructions.src,this.layoutInstructions.categories=this.categories,null!=a?a.categoriesArray.forEach(function(t,s){var r=parseInt(t)-1;a[s]=e.processor.PUtils.getUtilsInstance("dateUtils").getMonthName(e.processor.PStoryConfig.getConfig("lang"))[r]}):a=this.layoutInstructions.categories;var h=Object.keys(a).map(function(t){return a[t]});return h=h.slice(0,h.length-2),this.layoutInstructions.accessibilityCategories=h,this.layoutInstructions.seriesLabels=this.seriesLabels,this.layoutInstructions},e.processor.BarBlockProcessor.prototype.prepareDataByCategories=function(t,s){var r=this,n=this.config,i=new e.processor.PExp(n.y),a=new e.processor.PExp(n.x),o=[];this.categories=[];var l=s.key;return s.categoriesArray.forEach(function(e,s){var n={};n[l]=e,n.amount=0,n.sum=0,t.forEach(function(t,s){if(t[l]==e)return n=t,!1});var c=r.prepareRow(n,a,i);o.push(c)}),o},e.processor.BarBlockProcessor.prototype.prepareData=function(t){var s=this,r=this.config,n=new e.processor.PExp(r.y),i=new e.processor.PExp(r.x),a=[];return this.categories=[],t.forEach(function(t,e){var r=s.prepareRow(t,i,n);a.push(r)}),a},e.processor.BarBlockProcessor.prototype.prepareRow=function(t,s,r){var n=this.config,i={};if(this.config.hasOwnProperty("label")){var a=this.processText(n.label,t,this.model);"-"!=a&&(i.label=a.replace(/span/g,"tspan"))}try{var o=r.eval(t,this.model);i.value=o}catch(t){e.error("BarBlockProcessor.prepareRow() Error: failed to evaluate block.y expression. Error message: "+t.message+t.stack),i.value=null}var l=null;try{l=s.eval(t,this.model)}catch(t){e.error("BarBlockProcessor.prepareRow() Error: failed to evaluate block.x expression. Error message: "+t.message+t.stack)}return this.categories.push(l),n.hasOwnProperty("var")&&n.hasOwnProperty("default")&&(i.category=t[n.varSource],i.selected=!1,void 0!==n.selected&&t[n.varSource]==n.selected&&(i.selected=!0)),i},e.processor.BarBlockProcessor.prototype.getCategories=function(){var t=null;if(this.config.hasOwnProperty("categories")){var e=this.config.categories,s=this.model.fetchFromSrc(this,e);if(null!=s){var r=s.getObjArray(),n=s.data.cols[0];t={categoriesArray:r.map(function(t){return t[n]}),key:n}}}return t},e.processor.BarBlockProcessor.prototype.getSeries=function(){var t=null;if(this.config.hasOwnProperty("seriesNames")){var s=this.model.fetchFromSrc(this,this.config.seriesNames),r=s.getObjArray(),n=s.data.cols[0];t=r.map(function(t){return t[n]})}else e.log("Personetics.processor.BarBlockProcessor - Error: missing 'seriesNames' block property");return t}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PieBlockProcessor=function(t,s,r,n,i,a){e.processor.BlockProcessor.call(this,t,s,r,n,i,a)},e.processor.PieBlockProcessor.prototype=Object.create(e.processor.BlockProcessor.prototype),e.processor.PieBlockProcessor.prototype.processData=function(){this.layoutInstructions=e.processor.BlockProcessor.prototype.processData.call(this);var t=this,s=this.config,r=s.src,n=this.model.fetchFromSrc(this,r);if(s.hasOwnProperty("centerText"))var i=this.processText(s.centerText,this.model);i.length>0&&(this.layoutInstructions.centerText=i.replace(/span/g,"tspan"));var a=s.selected;if(null!=n){var o=n.getObjArray();o.forEach(function(e,r){if(e.highlight=!1,null!=a&&s.hasOwnProperty("varSource")&&(e[s.varSource]==a||null!=e[s.varSource]&&e[s.varSource]==a[s.varSource])&&(e.highlight=!0,!0),s.hasOwnProperty("label")){var n=t.processText(s.label,e,t.model);n.length>0&&"-"!=n&&(e.label=n.replace(/span/g,"tspan"))}if(e.hasOwnProperty(s.sliceName)){var i=e[s.sliceName];delete e[s.sliceName],e.category=i}e.value=e[s.sliceValue]||e.amount,e.index=++r,delete e[s.sliceValue]}),this.layoutInstructions.slices=o}return this.layoutInstructions.hasOwnProperty("varSource")&&delete this.layoutInstructions.varSource,this.layoutInstructions.hasOwnProperty("default")&&delete this.layoutInstructions.default,this.layoutInstructions.hasOwnProperty("selected")&&delete this.layoutInstructions.selected,this.layoutInstructions.hasOwnProperty("seriesNames")&&delete this.layoutInstructions.seriesNames,delete this.layoutInstructions.sliceName,delete this.layoutInstructions.sliceValue,delete this.layoutInstructions.label,delete this.layoutInstructions.src,this.layoutInstructions}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.PinBlockProcessor=function(t,s,r,n,i,a){e.processor.BarBlockProcessor.call(this,t,s,r,n,i,a)},e.processor.PinBlockProcessor.prototype=Object.create(e.processor.BarBlockProcessor.prototype)}(window,window.Personetics=window.Personetics||{}),function(t,e,s){e.processor=e.processor||{},e.processor.LineBlockProcessor=function(t,s,r,n,i,a){e.processor.BarBlockProcessor.call(this,t,s,r,n,i,a)},e.processor.LineBlockProcessor.prototype=Object.create(e.processor.BarBlockProcessor.prototype),e.processor.LineBlockProcessor.prototype.prepareDataByCategories=function(t,s){var r=this,n=this.config,i=new e.processor.PExp(n.y),a=new e.processor.PExp(n.x),o=[];this.categories=[];var l=s.key;return s.categoriesArray.forEach(function(e,s){var n={};n[l]=e,n.amount=0,t.forEach(function(t,s){if(t[l]==e)return n=t,!1}),r.prepareCategoryRow(n,a,i,l)}),t.forEach(function(t,e){var s=r.prepareSeriesRow(t,a,i,l);o.push(s)}),o},e.processor.LineBlockProcessor.prototype.prepareSeriesRow=function(t,s,r,n){var i=this.config,a={};if(this.config.hasOwnProperty("label")){var o=this.processText(i.label,t,this.model);"-"!=o&&(a.label=o.replace(/span/g,"tspan"))}try{s.eval(t)}catch(t){e.error("LineBlockProcessor.prepareRow() Error: failed to evaluate block.x expression. Error message: "+t.message+t.stack)}try{var l=r.eval(t);a.value=l}catch(t){e.error("LineBlockProcessor.prepareRow() Error: failed to evaluate block.y expression. Error message: "+t.message+t.stack),a.value=null}return a.category=t[n],a},e.processor.LineBlockProcessor.prototype.prepareCategoryRow=function(t,s,r,n){var i={},a=null;try{a=s.eval(t),i.label=a,i.value=t[n]}catch(t){e.error("LineBlockProcessor.prepareRow() Error: failed to evaluate block.x expression. Error message: "+t.message+t.stack)}this.categories.push(i)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s){t.PBlockProcessorManager=new function(){var t=null;this.getInstance=function(){return null==t&&(t=new r),t}};var r=function(){this.dialogsToBlocksMap={},this.processorFactory={txt:e.processor.TextBlockProcessor,text:e.processor.TextBlockProcessor,image:e.processor.ImageBlock,buttons:e.processor.ButtonsProcessorBlock,tabs:e.processor.TabsProcessorBlock,"account-selector":e.processor.AccountSelectorProcessorBlock,textboxes:e.processor.TextBoxesProcessorBlock,"h-box":e.processor.HBoxBlock,layout:e.processor.LayoutBlock,"date-box":e.processor.DateBoxBlockProcessor,tranList:e.processor.TableBlockProcessor,"bar-chart":e.processor.BarBlockProcessor,"pie-chart":e.processor.PieBlockProcessor,"arc-chart":e.processor.PieBlockProcessor,"pin-graph":e.processor.PinBlockProcessor,"pin-chart":e.processor.PinBlockProcessor,"line-chart":e.processor.LineBlockProcessor,"compare-block":e.processor.CompareProcessorBlock}};r.prototype.start=function(s){if(this.storyDefinition=s.story,this.defaultLang="en",void 0!==s.customizationOptions&&null!==s.customizationOptions)for(var r in s.customizationOptions)s.customizationOptions.hasOwnProperty(r)&&e.processor.PStoryConfig.setConfig(r,s.customizationOptions[r]);this.texts=s.texts,this.model=new e.processor.PModel(this,s),t.model=this.model,this.initProcessors()},r.prototype.initProcessors=function(){var t=this;this.storyDefinition.dialogs.forEach(function(e,s){var r=e.id;t.dialogsToBlocksMap[r]={},e.hasOwnProperty("class")&&(t.dialogsToBlocksMap[r].class=e.class),e.blocks.forEach(function(e,s){e.type;var n=t.createProcessor(e,r,s);n&&(t.dialogsToBlocksMap[r][s]={processor:n,previousData:null})})})},r.prototype.createProcessor=function(t,s,r){var n=t.type,i=this.processorFactory[n];if(i){var a=null;if(this.texts.hasOwnProperty(s)){a=this.texts[s][this.defaultLang]||{};var o=e.processor.PStoryConfig.getConfig("lang");if(this.texts[s].hasOwnProperty(o)){var l=this.texts[s][o];for(var c in l)l.hasOwnProperty(c)&&(a[c]=l[c])}}var u=new i(this,t,a,this.model,s,r);return u.initProcessor(),u}return e.log("createProcessor() - invalid processor type '"+n+"'"),null},r.prototype.process=function(){var t=[];for(var e in this.dialogsToBlocksMap)if(this.dialogsToBlocksMap.hasOwnProperty(e)){var s=this.dialogsToBlocksMap[e],r=[],n=null;for(var i in s.hasOwnProperty("class")&&(n=s.class,delete s.class),s)if(s.hasOwnProperty(i)){var a=s[i].processor,o=a,l=this.processBlock(a,o);l&&r.push(l)}var c={type:"h-box",class:"pstory-dialog-frame",columns:[{width:12,blocks:r}]};null!==n&&(c.class=n),t.push(c)}return t},r.prototype.processBlocks=function(t){var e=[],s=this;return t.blocks.forEach(function(r,n){var i=s.processBlockConfig(t.id,n);i&&e.push(i)}),e},r.prototype.processBlockConfig=function(t,e){if(this.dialogsToBlocksMap.hasOwnProperty(t)&&this.dialogsToBlocksMap[t].hasOwnProperty(e)){var s=this.dialogsToBlocksMap[t][e],r=s.processor;return this.processBlock(s,r)}},r.prototype.processBlock=function(t,s){var r=null,n=s.config,i=!0;if(n.showIf){var a=new e.processor.PExp(n.showIf);try{i=a.eval(this.model)}catch(t){i=!1,e.error("PBlockProcessorManager.processBlock() Error: Failed to evaluate showIf property, not showing block. Error Message: "+t.message+t.stack)}}return i&&(this.evaluateDefault(n),r=s.processData(),t.previousData=r),r},r.prototype.evaluateDefault=function(t){var s=this.getBlockVarValue(t);if(null!=s)t.selected=s;else if(t.hasOwnProperty("default")&&null!=t.default&&t.default.length>0){var r=t.default,n=new e.processor.PExp(r);try{s=n.eval(this.model)}catch(s){e.error("PBlockProcessorManager.evaluateDefault() Error: Failed to evaluate "+t.type+" block's default expression")}s&&(t.selected=s,this.setBlockVarValue(t,s))}},r.prototype.resetVariables=function(t){t.var&&!this.model.varValuesForSave[t.var]&&(this.model.varValues[t.var]=null)},r.prototype.getBlockVarValue=function(t){var e=t.var;if(null!=e&&e.length>0)return this.model.getVarValue(e)},r.prototype.setBlockVarValue=function(t,e){var s=t.var;null!=s&&s.length>0&&this.model.setVarValue(s,e)},r.prototype.getModel=function(){return this.model},r.prototype.handleQueryData=function(t,e){var s=e.doProcessData(t);this.story.handleQueryData(s,e)}}(window,window.Personetics=window.Personetics||{}),function(t,e,s,r){var n=e.UI.Handlebars;e.story=e.story||{},e.story.PCtrlBase=Base.extend({initialize:function(t){this.parent=t,this.templates=[],this.partialTemplates=this.getPartialTemplates(),this.initHandlebars()},start:function(){},getGraphPalette:function(){return null},handleMessage:function(t){},initHandlebars:function(){this.handlebars=n.create(),this.registerPartialTemplates()},getTemplateHtml:function(t,e){return this.getTemplate(t)(e)},getTemplate:function(t){var e=this.templates[t];if(!e&&!(e=this.getPrecompiledTemplate(t)))throw"Unknown template '"+t+"'";return e},getPrecompiledTemplate:function(t){var e=t;return"#"==e.substr(0,1)&&(e=e.substr(1)),n.templates[e]},compileTemplate:function(t){return this.handlebars.compile(t)},getPartialTemplates:function(){return[{name:"innerCard",id:"pstory-block-account-selector-inner-card"},{name:"innerCardDesktop",id:"pstory-block-account-selector-inner-card-desktop"}]},registerPartialTemplates:function(){this.partialTemplates.forEach(function(t){var e=n.templates[t.id];null!=e&&n.registerPartial(t.name,e)})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PBlockFactory=new function(){this.types={TYPE_CONTAINER:"layout"},this.blockFactoryMap={},this.index="0",this.registerBlock=function(t,e){if(e.blockClass){var s=this.blockFactoryMap[t];s||(s={type:t,class:{},widthModes:{}},this.blockFactoryMap[t]=s),e.class?s.class[e.class]=e.blockClass:e.widthMode?s.widthModes[e.widthMode]=e.blockClass:s.blockClass=e.blockClass}},this.createBlock=function(t,s,r){var n,i=r.cfg,a=s.type;if(a==this.types.TYPE_CONTAINER)n=e.story.LayoutBlock,s.layoutId="layout-"+this.index,this.index++;else{var o;void 0!==i&&(o=i.chartsLibClass);var l=s.class,c=(l=s.class||o,this.blockFactoryMap[a]);c&&(i.hasOwnProperty("widthMode")&&void 0!==i.widthMode&&null!==i.widthMode&&i.widthMode.length>0&&(n=c.widthModes[i.widthMode]),l&&(n=c.class[l]),n||(n=c.blockClass)),n||(n=e.story.Block,e.log("Invalid block type '"+a+"'"))}return new n(t,s,r)}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.Block=Base.extend({initialize:function(t,e,s){this.parent=t,this.story=s,this.layoutInstructions=e,this.isFirstBlock=!1;var r=this.getHtmlTemplateId(e.class);if(r&&(this.template=this.story.templates[r]),r&&!this.template){if(this.template=this.story.getTemplate("#pstory-block-"+r),!this.template)throw"Block template not found for: "+r;this.story.templates[r]=this.template}},getHtmlTemplateId:function(t){throw"No template id defined for block"},initBlock:function(){},handleQueryData:function(t){this.renderData(t),this.bindEvents()},setVisible:function(t){},beforeRender:function(t,e){this.layoutInstructions=e,this.layoutInstructions.isFirstBlock=this.isFirstBlock},render:function(t,e){this.layoutInstructions=this.layoutInstructions||e,this.el=t;var s=this.template(this.layoutInstructions);t.append(s),this.frameEl=t.find(".pstory-block-frame").last()},renderAgain:function(t){var e=this.template(t);s(this.frameEl).replaceWith(e)},renderData:function(t){},afterRender:function(t){this.frameEl&&this.doScrollEvent(!0)},bindEvents:function(){},handleEvent:function(t){switch(t[0]){case"scroll":this.frameEl&&this.doScrollEvent(t)}},doScrollEvent:function(){},notifyReportEvent:function(t){e.utils.PEventReporting.setValue(t),e.utils.PEventReporting.notifyEvent()},setIsFirstBlock:function(t){this.isFirstBlock=t}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.LayoutBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"layout"},initialize:function(t,s,r){e.story.Block.prototype.initialize.call(this,t,s,r)},render:function(t,s){e.story.Block.prototype.render.call(this,t,s),this.contentEl=this.frameEl.find(".layout-block-content").last(),this.renderBlocks(s)},renderBlocks:function(t){var r=this;s.each(t.blocks,function(t,s){var n=e.story.PBlockFactory.createBlock(r,s,r.story);n.beforeRender(r.contentEl,s),n.render(r.contentEl,s),n.afterRender(r.contentEl),n.bindEvents()})},afterRender:function(){var t=this.contentEl.children(".pstory-block-frame"),e=t.length,r=this.contentEl.width(),n=Math.floor(r/e)-3;"horizontal"==this.layoutInstructions.layout&&(t.addClass("perso-horizontal-block"),t.each(function(){s(this).css("width",n)}))}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.HBoxBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"hbox"},initialize:function(t,s,r){e.story.Block.prototype.initialize.call(this,t,s,r),this.totalWidth=12,this.colTemplate=this.story.getTemplate("#pstory-block-hbox-columns")},render:function(t,s){e.story.Block.prototype.render.call(this,t,s),this.contentEl=this.frameEl.find(".hbox-block-content").last(),this.renderBlocks(s)},renderBlocks:function(t){var r=this,n=this.colTemplate(t);this.contentEl.append(n);var i=this.contentEl.find(".pstory-hbox-column-frame");s.each(t.columns,function(t,n){var a=i[t],o=s(a).find(".pstory-hbox-blocks-container");s.each(n.blocks,function(t,s){var n=e.story.PBlockFactory.createBlock(r,s,r.story);n.beforeRender(o,s),n.render(o,s),n.afterRender(o),n.bindEvents()})})},afterRender:function(){var t=this.totalWidth,e=this.contentEl.width();this.contentEl.find(".pstory-hbox-column-frame").each(function(){var r=s(this).data("width"),n=Math.floor(r/t*e);s(this).css("width",n)})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TextBlock=e.story.Block.extend({getHtmlTemplateId:function(t){switch(t){case"note":case"perso-note":return"txt-note";default:return"txt"}},beforeRender:function(t,s){var r=s.text.replace(/{{Emoji /g,"<span>&#x");r=r.replace(/}}/g,"</span>"),s.text=r,e.story.Block.prototype.beforeRender.call(this,t,s)},render:function(t,e){var s=e;"perso-H4"!=e.class&&"perso-H5"!=e.class||(s.needAccessibility=!0);var r=this.template(s);t.append(r),this.frameEl=t.find(".pstory-block-frame").last()}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.DateBoxBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"date-box"},render:function(t,e){if(this.layoutInstructions=this.layoutInstructions||e,this.layoutInstructions.hasOwnProperty("date")){var s=this.layoutInstructions.date.trim(),r=new Date(s);this.layoutInstructions.day=r.getDate(),this.layoutInstructions.month=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]}this.el=t;var n=this.template(this.layoutInstructions);t.append(n),this.frameEl=t.find(".pstory-block-content").last()}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.ImageBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"image"},beforeRender:function(t,s){e.story.Block.prototype.beforeRender.call(this,t,s);var r=this.layoutInstructions.url;0==r.indexOf("http")?this.layoutInstructions.isAbsoluteURL=!0:this.layoutInstructions.url=r.substr(0,r.lastIndexOf("."))||r},afterRender:function(t){var s=this.frameEl.find(".pstory-block-content"),r=s.css("backgroundImage").replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],n=new Image;n.src=r,n.onload=function(){proportionWidth=this.width/s.width(),proportionHeight=this.height/proportionWidth,s.css({height:proportionHeight})},this.frameEl.find(".perso-introduce-personetics").attr("aria-label",e.dictionary.getText("accessibilityIntroducePersonetics")),this.frameEl.find(".perso-introduce-personetics").attr("role","img")}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TableBlock=e.story.Block.extend({getHtmlTemplateId:function(t){var e,r=t?t.split(" "):[];return s.each(r,function(t,s){if(s.indexOf("perso-txlist")>-1)return e=s.trim(),!1}),this.classStr=e,e?"table-"+e:"table"},beforeRender:function(t,s){s.rows||s.groups?(e.story.Block.prototype.beforeRender.call(this,t,s),this.addTexts(),this.parseTableToObj(),this.groupTable(),this.formatTable(),this.texts={tableTitle:e.dictionary.getText("accessibilityTableTitle"),tableStart:e.dictionary.getText("accessibilityTableStart"),tableEnd:e.dictionary.getText("accessibilityTableEnd")},this.layoutInstructions.legendTexts=[{class:e.dictionary.getText("lblScheduled").toLowerCase(),text:e.dictionary.getText("lblScheduled")},{class:e.dictionary.getText("lblEstimated").toLowerCase(),text:e.dictionary.getText("lblEstimated")}]):e.log("TableBlock.beforeRender() Error: invalid rows property - not rendering")},addTexts:function(){var t=e.dictionary.getText("lblbalance");this.layoutInstructions.balanceLabel=t},parseTableToObj:function(){var t=this,r=[];s.each(this.layoutInstructions.rows,function(n,i){var a={};s.each(t.layoutInstructions.cols,function(t,s){"isScheduled"===s?"true"===i[t]?a[s]=i[t]:a.isAnticipated=e.dictionary.getText("lblAnticipated"):a[s]=i[t]}),r.push(a)}),this.layoutInstructions.rows=r},afterRender:function(t){this.frameEl&&(e.story.Block.prototype.afterRender.call(this,t),this.addRoleAndDataForAccessibility())},addRoleAndDataForAccessibility:function(){this.frameEl.find("table").attr("role","presentation");var t=this.frameEl.find("td>span"),e=t.first(),s=t.last();e.prepend('<span class="perso-accessibility-read">'+this.texts.tableTitle+this.texts.tableStart+"</span>"),s.append('<span class="perso-accessibility-read">'+this.texts.tableEnd+"</span>"),e.addClass("perso-accessibility-wrapper").attr("role","text"),s.addClass("perso-accessibility-wrapper").attr("role","text")},formatTable:function(){var t=this,e=this.story.uxCtrl.getTablesFormat()["table-"+this.classStr];e||(e=this.story.uxCtrl.getTablesFormat()["table-default"]),e&&(1==this.isGroup?s.each(this.layoutInstructions.groups,function(s,r){t.formatRow(r,e),r.rows.forEach(function(s,r){t.formatRow(s,e)})}):s.each(this.layoutInstructions.rows,function(s,r){t.formatRow(r,e)}))},formatRow:function(t,e){var r=this;s.each(e.displayColumns,function(e,s){if(void 0!==t[e]&&null!==t[e]){var n=t.currencyCD;void 0!==n&&(s.currencySymbol=n),t[e]=r.formatTableHelper(e,s,t[e])}})},formatTableHelper:function(t,s,r){var n=r,i=e.processor.PUtils.getUtilsInstance("utils",this.model);switch(s.type){case"date":n=i.formatDate(r,s.format,!0);break;case"amount":n=i.formatAmount(r,s.currencySymbol,s.format,!0)}return n},groupTable:function(){var t=this;if("function"==typeof this.story.uxCtrl.getTablesFormat){var r=this.story.uxCtrl.getTablesFormat()["table-"+this.classStr];if(void 0!==r&&1==r.isGroup&&void 0!==r.groupingField){this.isGroup=!0;var n={},i=r.groupingField;s.each(this.layoutInstructions.rows,function(s,r){var a=r[i];if(void 0===n[a]){n[a]={},n[a].rows=[];var o=a.trim();n[a][i]=o;var l=e.utils.string.stripSpecialChars(o);n[a][i+"Id"]=l,t.defineOptionalParameter(n[a])}t.setOptionalParameter(n[a],r),n[a].rows.push(r)});var a=[];s.each(n,function(t,e){a.push(e)}),this.layoutInstructions.groups=a,delete this.layoutInstructions.rows}}},defineOptionalParameter:function(t){},setOptionalParameter:function(t,e){},render:function(t,s){s.rows||s.groups?e.story.Block.prototype.render.call(this,t,s):e.log("TableBlock.render() Error: invalid rows property - not rendering")}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.OptionsBlock=e.story.Block.extend({bindEvents:function(){this.frameEl.find(".pstory-button").bind("click",e.bind(this,this.optionClickEvent)),this.bindEvnetsForAnimation()},optionClickEvent:function(t){var e=s(t.currentTarget),r=e.attr("pstory-id");if(this.frameEl.find(".pstory-button.selected").attr("pstory-id")!=r){this.onInputSelect(t);var n=e.attr("pstory-id");this.currentSelectedOption=this.getOptionById(n),this.parent.notifyEvent(this,"setSelectedValue",this.currentSelectedOption);var i={value:"quiz"===this.layoutInstructions.type.toLowerCase()?this.getQuizResult(this.layoutInstructions.options,e):this.getReportValue(e),type:this.layoutInstructions.type};this.notifyReportEvent(i)}},getQuizResult:function(t,s){for(var r in t)if(t[r].id===s.attr("pstory-id"))return"true"===t[r].answer?e.dictionary.getText("right"):e.dictionary.getText("wrong");return e.dictionary.getText("wrong")},getOptionById:function(t){return this.layoutInstructions.options.filter(function(e){return e.id==t})[0]},onInputSelect:function(t){var e=s(t.currentTarget);s(this.frameEl).find(".pstory-button").removeClass("selected"),e.addClass("selected")},bindEvnetsForAnimation:function(){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TextBoxes=e.story.OptionsBlock.extend({getHtmlTemplateId:function(t){return"textboxes"},afterRender:function(){this.boxesHeight()},boxesHeight:function(){var t=this.frameEl.find(".perso-textbox, .perso-textbox-with-image"),e=0;t.each(function(){var t=s(this).height();t>=e&&(e=t)}),e>0&&t.css("minHeight",e)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.ButtonsBlock=e.story.OptionsBlock.extend({getHtmlTemplateId:function(t){return"buttons"},beforeRender:function(t,r){e.story.OptionsBlock.prototype.beforeRender.call(this,t,r),s.each(this.layoutInstructions.options,function(t,e){"toggle"==e.type&&(e.toggleState=e.class+"-"+e.id)}),this.layoutInstructions.hasOwnProperty("class")&&this.layoutInstructions.class.indexOf("perso-radio-buttons")>-1&&(this.layoutInstructions.typeRadio=!0,this.layoutInstructions.type="Quiz")},optionClickEvent:function(t){var r=s(t.target),n=void 0===r.data("navigateToPayload")?r.children("a").data("navigateToPayload"):r.data("navigateToPayload");n?this.doNavigateToPage(n):e.story.OptionsBlock.prototype.optionClickEvent.call(this,t)},buttonKyedownEvent:function(t){var e=s(t.target);e.hasClass("pstory-radio-button")&&-1!==[13].indexOf(t.which)&&e.click()},afterRender:function(t){if(e.story.OptionsBlock.prototype.afterRender.call(this,t),"navigateTo"===this.layoutInstructions.buttonType&&this.layoutInstructions.options.length){var s={},r="#pstory-block-buttons_"+this.layoutInstructions.id,n=t.find(r+" .pstory-link-navigateTo");this.layoutInstructions.options[0].payload?(s.navigateTarget=this.layoutInstructions.options[0].navigateTarget,s.payload=this.layoutInstructions.options[0].payload):s.navigateTarget=this.layoutInstructions.options[0].navigateTarget,n.length&&n.data("navigateToPayload",s)}else"Quiz"===this.layoutInstructions.type&&"desktop"===this.story.cfg.widthMode&&e.utils.accessibility.trackFocus(this.frameEl)},getReportValue:function(t){return null!=t.attr("pstory-type-text")?t.attr("pstory-type-text"):t.attr("pstory-id")},doNavigateToPage:function(t){this.parent.notifyEvent(this,"doNavigateToPage",t);var e={value:t.navigateTarget,type:"Navigation"};this.notifyReportEvent(e)},bindEvents:function(){e.story.OptionsBlock.prototype.bindEvents.call(this),this.el.find(".pstory-block-buttons.perso-radio-buttons").bind("keypress",".pstory-radio-button",e.bind(this,this.buttonKyedownEvent))}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.AccountSelectorBlock=e.story.OptionsBlock.extend({getHtmlTemplateId:function(t){return"account-selector"}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TabsBlock=e.story.OptionsBlock.extend({getHtmlTemplateId:function(t){return"tabs"},getOptionById:function(t){return this.layoutInstructions.options.filter(function(e){return e.id==t})[0]},afterRender:function(t){var e=this.frameEl.find(".pstory-button.selected");this.changeSelectedTabAnimation(e)},onInputSelect:function(t){e.story.OptionsBlock.prototype.onInputSelect.call(this,t);var r=s(t.currentTarget);r.attr("aria-selected",!0),r.siblings('[role="tab"]').attr("aria-selected",!1),this.changeSelectedTabAnimation(r)},changeSelectedTabAnimation:function(t){if(null!=t&&0!=t.length){var e=s(this.frameEl).find(".pstory-tab-animated-border-bottom"),r=t.offset().left-this.frameEl.offset().left,n=t.innerWidth();e.css({left:r+"px",width:n+"px"})}},getReportValue:function(t){return"Tab "+t.attr("value")}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.SelectOneBlock=e.story.OptionsBlock.extend({getHtmlTemplateId:function(t){return"selectOne"}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.story=e.story||{},e.story.D3BarChartBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"bar-chart"},beforeRender:function(t,s){if(s.categories&&s.seriesLabels){e.story.Block.prototype.beforeRender.call(this,t,s);var r=this.layoutInstructions.direction;this.chartType=this.getChartType(r,this.layoutInstructions.seriesLabels.length>1),this.setSelected(),this.barsDirection(),this.beforeRenderChart(t),this.texts={accessibilityBarChartTitle:e.dictionary.getText("accessibilityBarChartTitle"),series:e.dictionary.getText("accessibilitySeries"),selected:e.dictionary.getText("accessibilitySelected"),notSelected:e.dictionary.getText("accessibilityNotSelected")}}else e.log("D3BarChartBlock.beforeRender() Error: invalid categories and/or seriesLabels properties - not rendering")},setSelected:function(){var t=this;this.hasSelected=!1,s.each(this.layoutInstructions.series,function(e,r){s.each(r,function(e,s){if(1==s.selected)return t.hasSelected=!0,!1})}),0==this.hasSelected&&s.each(this.layoutInstructions.series,function(t,e){e.length>0&&(e[e.length-1].selected=!0)})},render:function(t,s){if(s.categories&&s.seriesLabels){e.story.Block.prototype.render.call(this,t,s);var r=this.frameEl.find(".pstory-bar-chart");r.length>0&&this.renderBarChart(r,s)}else e.log("D3BarChartBlock.render() Error: invalid categories and/or seriesLabels properties - not rendering")},afterRender:function(t){this.frameEl&&(e.story.Block.prototype.afterRender.call(this,t),s(this.chartEl).addClass(this.layoutInstructions.direction),this.renderAccessibilityData())},renderAccessibilityData:function(t){var e,s=this.frameEl.parents(".pstory-dialog-frame").attr("id")+this.frameEl.index(),r=this.chartHelper.svg.node().parentNode;if("pin-graph"==this.layoutInstructions.type){var i=this.createDataString();e=this.getAccessibilityTitle()+". "+i}else e=this.getAccessibilityTitle(),n.select(r).attr("role","application");n.select(r).append("title").attr("id",s+"_title").text(e),this.chartHelper.svg.attr("aria-labelledby",s+"_title"),this.chartHelper.svg.selectAll("*").attr("aria-hidden",!0)},getAccessibilityTitle:function(){return this.texts.accessibilityBarChartTitle},createDataString:function(){var t=this.layoutInstructions.categories,r=this.layoutInstructions.series,n=this.texts,i=this.layoutInstructions.seriesLabels,a=s("<span></span>");return this.layoutInstructions.seriesLabels.length>1?s.each(r[0],function(e,s){a.append(" "+n.series+" "+i[0]+", "+t[e]+", "+s.label+", "+n.series+" "+i[1]+", "+t[e]+", "+r[1][e].label+",")}):s.each(r,function(s,r){a.prepend(" "+e.utils.date.nthDate(t[s],e.processor.PStoryConfig.getConfig("lang"))+", "+r.label+",")}),a.text()},beforeRenderChart:function(t){1==this.layoutInstructions.series.length&&s.isArray(this.layoutInstructions.series[0])&&(this.layoutInstructions.series=this.layoutInstructions.series[0]),this.chartTypeHelper=this.chartType+"Helper",this.initChartHelper(this.chartTypeHelper),this.initOptions()},initOptions:function(){"multiVertical"==this.chartType?(this.options=this.story.uxCtrl.getColumnChartMultiSeriesOptions(),this.options.palette=this.story.uxCtrl.getMultiVerticalPalette(),this.options.paletteLabels=this.story.uxCtrl.getMultiVerticalLabelsPalette()):"multiHorizontal"==this.chartType?this.options=this.story.uxCtrl.getBarChartOptions():this.options=this.story.uxCtrl.getColumnChartOptions()},barsDirection:function(){"vertical"!=this.chartType&&"multiVertical"!=this.chartType||!e.processor.PStoryConfig.isRtl()||this.barsDirectionRTL()},barsDirectionRTL:function(){s.isArray(this.layoutInstructions.categories)&&(this.layoutInstructions.categories.reverse(),this.layoutInstructions.accessibilityCategories.reverse()),s.isArray(this.layoutInstructions.series)&&s.each(this.layoutInstructions.series,function(t,e){s.isArray(e)&&e.reverse()})},renderBarChart:function(t,s){var r=s;this.options.desktopScreenWidth=this.story.uxCtrl.getDesktopScreenWidth();var n=e.bind(this,this.handleClick);"multiHorizontal"==this.chartType?(this.chartHelper.prepareMultiHorizontalChart(this,t),this.chartHelper.renderMultiHorizontalChart(this,t,this.layoutInstructions)):(this.chartHelper.prepareChart(r,this.options,n),this.chartHelper.renderChart(t))},handleClick:function(t,r){if(0!=this.hasSelected&&(0!=t.amount&&-1==this.frameEl.find("svg .perso-bar, svg .perso-chart-rect")[r].className.animVal.indexOf("selected"))){var n=this.frameEl.find("svg .perso-bar.selected, svg .perso-chart-rect.selected");s.each(n,function(t,s){s.className.baseVal=e.utils.string.removeClass(s.className,"selected")});var i=this.frameEl.find("svg .perso-label");s.each(i,function(t,s){s.className.baseVal=e.utils.string.removeClass(s.className,"selected")});var a=this.frameEl.find("svg .perso-xAxis-label");if(s.each(a,function(t,s){s.className.baseVal=e.utils.string.removeClass(s.className,"selected")}),t.hasOwnProperty("mode")){var o=this.frameEl.find("svg .perso-bar, svg .perso-chart-rect.In")[r],l=this.frameEl.find("svg .perso-bar, svg .perso-chart-rect.Out")[r],c=this.frameEl.find("svg .perso-label.In")[r],u=this.frameEl.find("svg .perso-label.Out")[r],d=this.frameEl.find("svg .perso-xAxis-label")[r];o.className.baseVal=e.utils.string.addClass(o.className,"selected"),l.className.baseVal=e.utils.string.addClass(l.className,"selected"),void 0!==c&&(c.className.baseVal=e.utils.string.addClass(c.className,"selected")),void 0!==u&&(u.className.baseVal=e.utils.string.addClass(u.className,"selected")),d&&(d.className.baseVal=e.utils.string.addClass(d.className,"selected"))}else{var p=this.frameEl.find("svg .perso-bar, svg .perso-chart-rect")[r],h=this.frameEl.find("svg .perso-label")[r];d=this.frameEl.find("svg .perso-xAxis-label")[r];p.className.baseVal=e.utils.string.addClass(p.className,"selected"),void 0!==h&&(h.className.baseVal=e.utils.string.addClass(h.className,"selected")),d&&(d.className.baseVal=e.utils.string.addClass(d.className,"selected"))}this.parent.notifyEvent(this,"setSelectedValue",t.category);var f={value:t.category,type:this.layoutInstructions.type};this.notifyReportEvent(f)}},getChartType:function(t,e){var s=null;return"vertical"==t&&e?s="multiVertical":"horizontal"==t&&e?s="multiHorizontal":"vertical"==t?s="vertical":"horizontal"==t&&(s="horizontal"),s},initChartHelper:function(t){this.chartHelper=e.story.BlockChartFactory.generateHelperClazz(t,this.story.cfg)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.persoD3||t.d3;e.story=e.story||{},e.story.D3PinGraphChartBlock=e.story.D3BarChartBlock.extend({beforeRender:function(t,s){e.story.D3BarChartBlock.prototype.beforeRender.call(this,t,s),this.texts.accessibilityPinGraphTitle=e.dictionary.getText("accessibilityPinGraphTitle")},getHtmlTemplateId:function(t){return"pinGraph-chart"},render:function(t,s){e.story.Block.prototype.render.call(this,t,s);var r=this.frameEl.find(".pstory-pinGraph-chart");r.length>0&&this.renderBarChart(r,s)},renderBarChart:function(t,e){this.chartHelper.prepareChart(e,this.options),this.chartHelper.renderChart(t)},beforeRenderChart:function(t,e){this.layoutInstructions.series=this.layoutInstructions.series[0],this.chartType=this.getChartType(),this.chartTypeHelper=this.chartType+"Helper",this.initChartHelper(this.chartTypeHelper),this.options=this.story.uxCtrl.getPinGraphChartOptions()},barsDirection:function(){e.processor.PStoryConfig.isRtl()&&this.barsDirectionRTL()},getChartType:function(){return"pinGraph"},getAccessibilityTitle:function(){return this.texts.accessibilityPinGraphTitle}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.story=e.story||{},e.story.PieChartBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"pie-chart"},beforeRender:function(t,s){e.story.Block.prototype.beforeRender.call(this,t,s),this.options=this.story.uxCtrl.getPieOptions(),this.setTotal(s),this.colors=n.scale.ordinal().range(this.getGraphPalette()),this.texts={accessibilityPieTitle:e.dictionary.getText("accessibilityPieTitle")},this.grayscaleId="grayscale_"+ +new Date,this.dropShadow="",this.options.arcs.filter.dropShadow&&(this.dropShadowId="drop-shadow_"+ +new Date,this.dropShadow="url(#"+this.dropShadowId+")"),this.isOldAndroidVersion=e.utils.persoHelper.isOldAndroidVersion(),this.layoutInstructions.slices=this.layoutInstructions.slices.sort(function(t,e){return Math.abs(e.value)-Math.abs(t.value)})},setPieDefination:function(){var t=.05*this.totalAmountInt,e=.04;return void 0!==this.options.arcs.padAngle&&(e=this.options.arcs.padAngle),n.layout.pie().padAngle(e).value(function(e){return Math.abs(e.value)+t})},sortPie:function(t){return t.sort(function(t,e){return Math.abs(e.value)-Math.abs(t.value)}),t},setTotal:function(t){var s=t.centerText,r=[];if(s?r=s.split("<br>"):e.log("Center text is empty"),this.totalText=r[0]?r[0]:"",this.totalAmount=r[1]?r[1]:"",t.hasOwnProperty("slices")&&t.slices.length>0){var n=t.slices.reduce(function(t,e){return{value:Math.abs(t.value)+Math.abs(e.value)}});this.totalAmountInt=n.value}else this.totalAmountInt=0},getGraphPalette:function(){return this.story.uxCtrl.getPieGraphPalette()},render:function(t,s){if(s.slices){s.texts=this.texts,e.story.Block.prototype.render.call(this,t,s),this.frameEl=t.find(".pstory-block-frame").last();var r=this.frameEl.find(".pstory-pie-chart");r.length>0&&this.renderPieChart(r,s)}else e.log("PieChartBlock.render() Error: invalid slices property - not rendering")},renderPieChart:function(t,e){e.slices=this.sortPie(e.slices),this.setPieSize(),n.selection.prototype.moveToFront=function(){return this.each(function(){var t=this.parentNode;t.parentNode.appendChild(t)})},this.defineArcs(),this.renderPieBase(t),this.renderShadowFilter(this),this.renderPie(t,e,this),this.renderAccessibilityData(t,e)},setPieSize:function(){this.margin={top:0,right:20,bottom:0,left:20},this.width=this.frameEl.find(".pstory-pie-chart").width(),this.height=.7*this.width,this.radius=this.width/2.5,this.innerRadius=this.radius-26,this.outerRadius=this.radius-36,this.innerRadiusOver=this.radius-23,this.outerRadiusOver=this.radius-43},defineArcs:function(){this.arc=n.svg.arc().innerRadius(this.innerRadius).outerRadius(this.outerRadius),this.arcOver=n.svg.arc().innerRadius(this.innerRadiusOver).outerRadius(this.outerRadiusOver)},renderPieBase:function(t){this.svg=this.renderPieSvgBase(t)},renderPieSvgBase:function(t){if(t)return n.select(t.get(0)).append("svg").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate("+this.width/2+","+this.height/2+")")},renderPie:function(t,e,s){this.renderArcs(e),this.renderPieTitle(this.totalText),1==this.options.drawCenterLine&&this.renderLine(),this.renderPieAmount(this.totalAmount)},renderArcs:function(t){var e=this;e.svg.selectAll(".arc").data(e.setPieDefination()(t.slices)).enter().append("g").attr("class","perso-arc").attr("pstory-id",function(t){return t.data.category}).append("path").attr("d",e.arc).attr("class",function(t){var e="";return t.data.highlight&&(e+="perso-selected"),e}).style("filter",function(t){if(t.data.highlight)return e.options.arcs.filter.dropShadow?"url(#"+e.options.arcs.filter.dropShadow.id+")":""}).style("fill",function(t,s){return e.colors(t.data.category)}).on("click",function(t,s){e.onPieItemClick(t,s,this)})},renderTicks:function(t,e){t&&t.svg.append("g").attr("class","perso-ticks").selectAll("line").data(t.setPieDefination()(e)).enter().append("line").attr("class","perso-tick").attr("x1",0).attr("x2",0).attr("y1",.8*-t.radius).attr("y2",.9*-t.radius).attr("stroke","gray").attr("transform",function(t){return"rotate("+(t.startAngle+t.endAngle)/2*(180/Math.PI)+")"})},renderPieLabels:function(e,r){e&&e.svg.append("g").attr("class","perso-pie-labels").attr("transform","translate(8,0)").selectAll("text").data(e.setPieDefination()(r)).enter().append("text").attr("class","perso-pie-label").attr("transform",function(t){var s=e.radius+20,r=(t.startAngle+t.endAngle)/2;return"translate("+s*Math.sin(r)+","+-s*Math.cos(r)+")"}).attr("dy","-0.5em").attr("text-anchor","middle").html(function(t){return t.data.category}).call(e.wrapLabelText,.28*s(t).width())},renderPieTitle:function(t){var e=this.options.totaltxt_SpaceFromCenter||"-.3em";this.svg.append("text").attr("class","perso-total-txt").attr("dy",e).html(t)},renderPieAmount:function(t){var e=this.options.totalAmount_SpaceFromCenter||".9em";this.svg.append("text").attr("class","perso-total-amount").attr("dy",e).html(t)},renderLine:function(){var t=this.options.centerLineWidth||0;this.svg.append("line").attr("class","perso-centerLine").attr("x1",t/2*-1).attr("x2",t/2)},renderAccessibilityData:function(t){var e=this.frameEl.parents(".pstory-dialog-frame").attr("id")+this.frameEl.index(),s=this.texts.accessibilityPieTitle+". "+this.createDataString(),r=this.svg.node().parentNode;n.select(r).append("title").attr("id",e+"_title").text(s),n.select(r).attr("role","presentation"),this.svg.attr("aria-labelledby",e+"_title"),this.svg.selectAll("*").attr("aria-hidden",!0)},createDataString:function(){var t=s("<span></span>");return t.append(this.totalText+": "+this.totalAmount+"."),t.text()},onPieItemClick:function(t,r,i){var a=s(".perso-arc path.perso-selected");a.length&&(a[0].className.baseVal=e.utils.string.removeClass(a[0].className,"perso-selected"));var o=this.frameEl.find(".pstory-pie-chart svg .perso-pie-label.selected");o.length&&(o[0].className.baseVal=e.utils.string.removeClass(o[0].className,"selected")),n.select(i).attr("class","perso-selected");var l=this.frameEl.find(".pstory-pie-chart svg .perso-pie-label");if(void 0!==l&&l.length>r){var c=l[r];c.className.baseVal=e.utils.string.addClass(c.className,"selected")}this.handleClick(t,r)},renderShadowFilter:function(t){var e=t.options.arcs.filter.dropShadow;t.svg;if(e){var s=t.svg.append("defs").append("filter").attr("id",this.dropShadowId).attr("height","130%");s.append("feGaussianBlur").attr("in",e.in).attr("stdDeviation",e.stdDeviation).attr("result","blur"),s.append("feOffset").attr("in","blur").attr("dx",e.dxOffset).attr("dy",e.dyOffset).attr("result","offsetBlur"),s.append("feFlood").attr("in","offsetBlur").attr("flood-color",e.color).attr("flood-opacity","1").attr("result","offsetColor"),s.append("feComposite").attr("in","offsetColor").attr("in2","offsetBlur").attr("operator","in").attr("result","offsetBlur");var r=s.append("feMerge");r.append("feMergeNode").attr("in","offsetBlur"),r.append("feMergeNode").attr("in",e.in)}},handleClick:function(t,e){var s=t;s.data&&(s=s.data),this.parent.notifyEvent(this,"setSelectedValue",s.category);var r={value:s.category,type:this.layoutInstructions.type};this.notifyReportEvent(r)},getSelectedPathIndex:function(t){var e=0,s=this.frameEl.find("path.perso-selected").parent().attr("pstory-id");this.layoutInstructions.slices.filter(function(t,r){if(t.category==s)return e=r,!0});return e},wrapLabelText:function(t,e){t.each(function(){for(var t,s=n.select(this),r=s.text().split(/\s+/).reverse(),i=[],a=0,o=s.attr("y"),l=parseFloat(s.attr("dy")),c=s.text(null).append("tspan").attr("x",0).attr("y",o).attr("dy",l+"em");t=r.pop();)i.push(t),c.text(i.join(" ")),c.node().getComputedTextLength()>e&&(i.pop(),c.text(i.join(" ")),i=[t],c=s.append("tspan").attr("x",0).attr("y",o).attr("dy",.15*++a+l+"em").text(t))})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.story=e.story||{},e.story.WidePieChartBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"pie-chart"},beforeRender:function(t){var s=this,r=s.config;s.margin={top:10,right:10,bottom:10,left:10},s.width=t.width()-s.margin.left-s.margin.right,s.height=s.width/2,s.radius=s.width/3,s.xFieldExp=new e.processor.PExp(r.x);var i=s.yFieldExp=new e.processor.PExp(r.y);s.xScale=n.scale.ordinal().rangeRoundBands([0,s.width],.1),s.yScale=n.scale.linear().range([s.height,0]),s.xAxis=n.svg.axis().scale(s.xScale).orient("bottom");var a=Math.PI/180;s.pie=n.layout.pie().sort(null).startAngle(-90*a).endAngle(90*a).value(function(t){return i.eval(t)})},render:function(t){this.el=t;var s=this.story.model.fetchFromSrc(this,this.config.src);if(s){s!==e.processor.Future&&(s=s.getObjArray());var r=this.template(s);t.append(r);var n=t.find(".pstory-pie-chart");n.length>0&&this.renderPieChart(n,s)}},afterRenderPieChart:function(t,e){var s=this,r=(s.config,s.xScale),i=s.yScale,a=s.xFieldExp,o=s.yFieldExp;r.domain(e.map(function(t){return a.eval(t)})),i.domain([0,n.max(e,function(t){return o.eval(t)})]),s.svg=n.select(t.get(0)).append("svg").attr("width",s.width+s.margin.left+s.margin.right).attr("height",s.height+s.margin.top+s.margin.bottom).append("g").attr("transform","translate("+(s.width/2+s.margin.left)+","+(s.height+s.margin.top)+")");var l=this.getGraphPalette(),c=r.range(l),u=n.svg.arc().outerRadius(this.radius).innerRadius(.5*this.radius),d=Math.PI/180,p=n.layout.pie().sort(null).value(function(t){return o.eval(t)}).startAngle(-90*d).endAngle(90*d),h=s.svg.selectAll(".arc").data(p(e)).enter().append("g").attr("class","arc");h.append("path").attr("d",u).style("fill",function(t){return c(a.eval(t.data))});h.append("text").attr("x",function(t,e){var s=u.centroid(t),r=Math.atan2(s[1],s[0]),n=230*Math.cos(r);return n+5*(n>0?1:-1)}).attr("y",function(t,e){var s=u.centroid(t),r=Math.atan2(s[1],s[0]);return 230*Math.sin(r)}).attr("text-anchor",function(t,e){var s=u.centroid(t),r=Math.atan2(s[1],s[0]);return 230*Math.cos(r)>0?"start":"end"}).text(function(t){return a.eval(t.data)}),h.append("line").attr({stroke:"black","stroke-width":1,x1:function(t,e){return u.centroid(t)[0]},y1:function(t,e){return u.centroid(t)[1]},x2:function(t,e){var s=u.centroid(t),r=Math.atan2(s[1],s[0]);return 230*Math.cos(r)},y2:function(t,e){var s=u.centroid(t),r=Math.atan2(s[1],s[0]);return 230*Math.sin(r)},class:"label-line"})},getGraphPalette:function(){return this.story.uxCtrl.getPieGraphPalette()},handleClick:function(t){this.config.var&&this.config.varSource&&(this.setValue(t[this.config.varSource]),this.story.fireEvent(this))}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.persoD3||t.d3;e.story=e.story||{},e.story.DotsLineChartBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"line-chart"},beforeRender:function(t,s){s.categories&&s.series&&s.seriesLabels?(e.story.Block.prototype.beforeRender.call(this,t,s),this.texts={accessibilityLineChartTitle:e.dictionary.getText("accessibilityLineGraphTitle"),accessibilityLineGraphHighlightedDot:e.dictionary.getText("accessibilityLineGraphHighlightedDot")},this.beforeRenderChart()):e.log("DotsLineChartBlock.beforeRender() Error: invalid categories and/or series and/or seriesLabels properties - not rendering")},beforeRenderChart:function(){this.chartType="lineChart",1==this.layoutInstructions.series.length&&s.isArray(this.layoutInstructions.series[0])&&(this.layoutInstructions.series=this.layoutInstructions.series[0]),this.chartTypeHelper=this.chartType+"Helper",this.initChartHelper(this.chartTypeHelper)},render:function(t,s){e.story.Block.prototype.render.call(this,t,s);var r=this.frameEl.find(".pstory-line-chart");if(r.length>0){var n=s,i=(t=r,this.initLineChartOptions());this.chartHelper.prepareChart(n,i),this.chartHelper.renderChart(t)}},afterRender:function(t){e.story.Block.prototype.afterRender.call(this,t);var s=this.el.find(".pstory-line-chart");s.length&&this.chartHelper.renderAccessibilityData(this.frameEl,this.texts),e.utils.accessibility.trackFocus(s)},initLineChartOptions:function(){return this.story.uxCtrl.getDotsLineChartOptions()},initChartHelper:function(t){this.chartHelper=e.story.BlockChartFactory.generateHelperClazz(t,this.story.cfg)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.MapBlock=e.story.Block.extend({getHtmlTemplateId:function(t){return"map"},render:function(t,s){e.story.Block.prototype.render.call(this,t,s),this.mapEl=this.frameEl.find(".pstory-map-frame");var r={scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!1,zoom:15,center:new google.maps.LatLng(40.7097798,-73.9624878),mapTypeId:google.maps.MapTypeId.ROADMAP},n=document.createElement("div");n.id="map-canvas",n.style.width="100%",n.style.height="100%",this.mapEl.append(n),this.map=new google.maps.Map(n,r)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PBlockSessionManager=Base.extend({initialize:function(t){this.story=t,this.blockProcessorManager=PBlockProcessorManager.getInstance();var e=t.options,s={story:t.storyDef,texts:t.texts,facts:t.cfg.data||t.cfg.insightFacts,expressions:t.expressions,customizationOptions:e};this.blockProcessorManager.start(s),this.dialogsToBlocksMap={},this.processedData=[]},reset:function(){this.processedData=[]},resetDialog:function(t){this.dialogsToBlocksMap.hasOwnProperty(t)&&(this.dialogsToBlocksMap[t]=[])},startBlock:function(t,s,r,n){this.dialogsToBlocksMap.hasOwnProperty(t)||(this.dialogsToBlocksMap[t]=[]);var i=this.blockProcessorManager.processBlockConfig(t,n),a=e.story.PBlockFactory.createBlock(this,i,this.story),o={dlgId:t,config:r,layoutInstructions:i,renderer:a};this.dialogsToBlocksMap[t].push(o),a.initBlock()},renderBlocks:function(e,r,n){if(!this.dialogsToBlocksMap.hasOwnProperty(e))throw"Invalid dialog id '"+e+"'";var i=this;s.each(this.dialogsToBlocksMap[e],function(t,e){var s=e.renderer,a=e.layoutInstructions;n&&0==t&&s.setIsFirstBlock(!0),i.processedData.push(a),s.beforeRender(r,a),s.render(r,a),s.afterRender(r),s.bindEvents()}),t.setProcessorData&&t.setProcessorData(this.processedData)},findBlock:function(t){var e=t.rendererObj,r=null;return s.each(this.dialogsToBlocksMap,function(t,n){if(s.each(n,function(t,s){var n=s.renderer;if(e==n)return r=s,!1}),r)return!1}),r},notifyEvent:function(t,e,s){switch(e){case"doNavigateToPage":this.doNavigateToPage(s);break;case"setSelectedValue":this.setSelectedValue(t,s)}},setSelectedValue:function(t,e){var s=this.findBlock({rendererObj:t});this.blockProcessorManager.setBlockVarValue(s.config,e),this.story.fireEvent(s)},doNavigateToPage:function(t){var r=personetics.getJSBridge();r&&s.isFunction(r.navigateToPage)?r.navigateToPage(t):e.log("Events Delegate not defined")},setVisible:function(t,e){this.dialogsToBlocksMap.hasOwnProperty(t)&&s.each(this.dialogsToBlocksMap[t],function(t,s){s.renderer.setVisible(e)})},resetVariables:function(t){this.blockProcessorManager.resetVariables(t)},getModel:function(){return this.blockProcessorManager.getModel()},handleEvent:function(t){var e=arguments;s.each(this.dialogsToBlocksMap,function(t,r){s.each(r,function(t,s){s.renderer.handleEvent(e)})})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PSkinControler=Base.extend({initialize:function(){},setStory:function(t){this.story=t},registerWidgets:function(){this.registerDefaultWidgets()},registerBlocks:function(){this.registerDefaultBlocks(),this.registerDefaultChartHeplers()},getTablesFormat:function(){return e.story.getTablesFormat()},afterRender:function(t,e){t.shouldShow()&&(t.el.css({opacity:0,visibility:"visible"}),t.el.fadeTo(0,1)),e&&e()},beforeRender:function(t,e){e()},registerBlock:function(t,s){e.story.PBlockFactory.registerBlock(t,s)},registerChartHelper:function(t,s){e.story.BlockChartFactory.registerChartHelper(t,s)},getAccountSelectorPalette:function(){return["darkBlue","turquoise","grey","red","lightBlue","orange"]},getGraphPalette:function(){return["#5D68C2","#3B49B6","#1729AF","#111F88","#08176C"]},getColumnGraphPalette:function(){return["#5D68C2","#3B49B6","#1729AF","#111F88","#08176C"]},getBarGraphPalette:function(){return["#5D68C2","#3B49B6","#1729AF","#111F88","#08176C"]},getPieGraphPalette:function(){return["#5D68C2","#3B49B6","#1729AF","#111F88","#08176C"]},getBarChartMultiSeriesLabels:function(t){return function(){if(t&&t.length>0){var e=t[this.series.index];return"<span class='"+this.series.name+"'>"+e+"</span>"}return""}},registerDefaultBlocks:function(t){this.registerBlock("txt",{blockClass:e.story.TextBlock}),this.registerBlock("text",{blockClass:e.story.TextBlock}),this.registerBlock("date-box",{blockClass:e.story.DateBoxBlock}),this.registerBlock("image",{blockClass:e.story.ImageBlock}),this.registerBlock("textboxes",{blockClass:e.story.TextBoxes}),this.registerBlock("compare-block",{blockClass:e.story.CompareBlock}),this.registerBlock("buttons",{blockClass:e.story.ButtonsBlock}),this.registerBlock("account-selector",{blockClass:e.story.AccountSelectorBlock}),this.registerBlock("tabs",{blockClass:e.story.TabsBlock}),this.registerBlock("selectOne",{blockClass:e.story.SelectOneBlock}),this.registerBlock("external-links",{blockClass:e.story.ButtonsBlock}),this.registerBlock("tranList",{blockClass:e.story.TableBlock}),this.registerBlock("table",{blockClass:e.story.TableBlock}),this.registerBlock("bar-chart",{blockClass:e.story.D3BarChartBlock}),this.registerBlock("line-chart",{blockClass:e.story.DotsLineChartBlock}),this.registerBlock("bar-chart",{blockClass:e.story.BarChartBlock}),this.registerBlock("bar-chart",{blockClass:e.story.BarCharHighchartstBlock,class:"highcharts"}),this.registerBlock("pie-chart",{blockClass:e.story.PieChartBlock}),this.registerBlock("arc-chart",{blockClass:e.story.PieChartBlock}),this.registerBlock("pie-chart",{blockClass:e.story.PieChartBlock,widthMode:"small"}),this.registerBlock("pie-chart",{blockClass:e.story.WidePieChartBlock,widthMode:"wide"}),this.registerBlock("pie-chart",{blockClass:e.story.PieChartHighchartsBlock,class:"highcharts"}),this.registerBlock("spline-chart",{blockClass:e.story.SplineCharHighchartstBlock,class:"highcharts"}),this.registerBlock("pinGraph-chart",{blockClass:e.story.PinGraphChartBlock}),this.registerBlock("map",{blockClass:e.story.MapBlock}),this.registerBlock("pin-graph",{blockClass:e.story.D3PinGraphChartBlock}),this.registerBlock("pin-chart",{blockClass:e.story.D3PinGraphChartBlock}),this.registerBlock("h-box",{blockClass:e.story.HBoxBlock})},registerDefaultChartHeplers:function(){this.registerChartHelper("verticalHelper",{helperClass:e.utils.d3Helpers.VerticalChartHelper}),this.registerChartHelper("horizontalHelper",{helperClass:e.utils.d3Helpers.HorizontalChartHelper}),this.registerChartHelper("multiVerticalHelper",{helperClass:e.utils.d3Helpers.MultiVerticalChartHelper}),this.registerChartHelper("multiHorizontalHelper",{helperClass:e.utils.d3Helpers.MultiHorizontalChartHelper}),this.registerChartHelper("pinGraphHelper",{helperClass:e.utils.d3Helpers.PinGraphChartHelper}),this.registerChartHelper("lineChartHelper",{helperClass:e.utils.d3Helpers.LineChartHelper})},registerDefaultWidgets:function(){e.UI.PWidgetFactory.registerWidget("app-ctrl",{widgetClass:e.UI.PAppCtrl,widgetName:"Base app ctrl"}),e.UI.PWidgetFactory.registerWidget("master",{widgetClass:e.UI.PAppCtrl,widgetName:"Base master"}),e.UI.PWidgetFactory.registerWidget("insights",{widgetClass:e.story.PInsighsCtrl,widgetName:"Base insights"}),e.UI.PWidgetFactory.registerWidget("insights-overlay",{widgetClass:e.story.PInsighsOverlayCtrl,widgetName:"Base insights overlay"}),e.UI.PWidgetFactory.registerWidget("inbox",{widgetClass:e.story.PInboxCtrl,widgetName:"Base inbox"}),e.UI.PWidgetFactory.registerWidget("management",{widgetClass:e.UI.PManagementCtrl,widgetName:"Base management"}),e.UI.PWidgetFactory.registerWidget("ratings",{widgetClass:e.UI.PRatingCtrl,widgetName:"Base ratings"}),e.UI.PWidgetFactory.registerWidget("story-widget",{widgetClass:e.UI.PStoryWidgetCtrl,widgetName:"Base story widget"}),e.UI.PWidgetFactory.registerWidget("loading-animation",{widgetClass:e.UI.PLoadingAnimationCtrl,widgetName:"Base loading"}),e.UI.PWidgetFactory.registerWidget("teaser-widget",{widgetClass:e.UI.PTeaserWidgetCtrl,widgetName:"Base teaser widget"}),e.UI.PWidgetFactory.registerWidget("teaser-insight-widget",{widgetClass:e.UI.PInsightTeaserWidgetCtrl,widgetName:"Base teaser insight widget"})}}),e.story.skinController=e.story.PSkinControler}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PDialog=Base.extend({initialize:function(t,s){this.story=t,this.config=s,this.lang=t.lang,this.id=t.getId()+"_"+this.config.id,this.txts={},this.visible=!1,this.class=this.config.class?this.config.class:"",this.config.showIf&&(this.showCondExp=new e.processor.PExp(this.config.showIf)),this.isShouldShow=null,this.loadTexts(t.texts,t.lang,t.defaultLang),this.initializeBlocks()},loadTexts:function(t,r,n){var i,a=this.config.txt||{},o=t&&t.hasOwnProperty(this.config.id)?t[this.config.id]:null;o&&o.hasOwnProperty(n)&&(i=o.hasOwnProperty(r)?o[r]:o[n],s.each(i,function(t,e){a[t]=e}));this.story;var l=this;a?s.each(a,function(t,e){var s=e;o&&((s=o[r]?o[r][t]:null)||(s=o[n]?o[n][t]:e),s||(s=e)),l.txts[t]=s}):e.log("Personetics.story.PDialog.loadTexts: dialog doesn't have any text configuration")},getId:function(){return this.id},getShortId:function(){return this.config.id},getText:function(t){var e;if(this.txts){var s=this.txts;s&&(e=s[t])}return e},processText:function(t,e,s){var r=this.getText(t);return r?"preview"==this.story.mode?r.getTextTemplate():r.process(e,s):"-"},shouldShow:function(){if(!this.showCondExp)return!0;if(null==this.isShouldShow)try{this.isShouldShow=this.showCondExp.eval(this.story.model)}catch(t){this.isShouldShow=null}return this.isShouldShow},generateData:function(){var t=this.isFirstDialog,e={id:this.getId(),class:this.config.class};return this.config.isSingleDialogMode&&(e.btn=[],e.btn.diaogBtn=[],e.btn.showBtn=[],this.config.next?e.btn.push({diaogBtn:"Continue",actionBtn:"continue",showBtn:!0}):e.btn.push({diaogBtn:"Close",actionBtn:"close",showBtn:!0}),t||e.btn.push({diaogBtn:"Previous",actionBtn:"prev",showBtn:!0})),e},render:function(t,e){this.isFirstDialog=e;var r=this.shouldShow(),n=this.config.isSingleDialogMode;if(n&&!r)this.story.renderDialog();else if(r){var i=this.story.getTemplate("#tmpl-pstory-dialog");n&&(i=this.story.getTemplate("#tmpl-pstory-dialog-continue-btn"),t.find(".pstory-dialog-frame").hide());var a=i(this.generateData()),o=s(a);this.el=o,t.append(o)}},afterRender:function(){this.story;var t=this.el,e=this.shouldShow(),r=this.config.isSingleDialogMode;if(e){var n=this.el.find(".pstory-dialog-content");if(r){this.story.parent.scrollTo&&this.story.parent.scrollTo(t.offset().top);var i=this.el.find(".pstory-dialog-buttons").height();n.height(n.height()-i)}if(n.parents(".pstory-dialog-frame").hasClass("horizontal")&&(this.config.dialogWidth=n.width()),this.renderBlocks(n),n.parents(".pstory-dialog-frame").hasClass("horizontal")){var a=n.find(".pstory-block-frame"),o=n.width(),l=0;o/=a.length,s.each(a,function(t,e){var r=parseInt(s(e).css("margin-left"))+parseInt(s(e).css("margin-right")),n=o-r;s(e).width(n);var i=s(e).children().first().height();l=i>l?i:l}),n.height(l)}}},bindEvents:function(){var t=this.story;if(this.shouldShow()){var e=this.el,r=this.el.find(".pstory-dialog-content"),n=t.cfg.dlgClickHandler;n&&r.bind("click",function(){n(this)}),e.find(".pstory-dialog-btn").bind("click",function(){var e={};if("prev"==s(this).data("action"))e.renderPreviousDialog=!0;else if("close"==s(this).data("action"))return void t.closeHandler();t.renderDialog(null,e)})}},initializeBlocks:function(){var t=this,s=this.story;s.blockSessionManager.resetDialog(this.getShortId()),this.config.blocks.forEach(function(r,n){var i=!0;if(r.showIf)try{var a=new e.processor.PExp(r.showIf);i=a.eval(s.model)}catch(t){i=!0}i&&(r.index=n,s.blockSessionManager.startBlock(t.getShortId(),t.txts,r,n))})},renderBlocks:function(t){this.story.blockSessionManager.renderBlocks(this.getShortId(),t,this.isFirstDialog)},setIsBlock:function(){this.shouldShow()&&(this.el.addClass("perso-block"),s(this.el).find("*").off())},setVisible:function(t){if(this.visible!=t){this.visible=t;this.story.blockSessionManager.setVisible(this.getShortId,t)}},addBlock:function(t){this.blocks.push(t)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PWorkflowCtx=Base.extend({initialize:function(t,e){this.wf=t,this.dialogs=[],this.firstDialogId=null},pushDlg:function(t){this.dialogs.push(t);var e=t.shouldShow();!this.firstDialogId&&e&&(this.firstDialogId=t.getShortId())},getFirstDialogId:function(){return this.firstDialogId},hasDlg:function(t){return this.dialogs.forEach(function(e,s){if(e.getId()==t)return!0}),!1},getDlg:function(t){var e=null;return this.dialogs.forEach(function(s,r){return s.getShortId()==t&&(e=s),!0}),e},removeDlgsAfter:function(t){if(!t){var e=this.dialogs;return this.dialogs=[],e}var s=[],r=[],n=!0;return this.dialogs.forEach(function(e,i){n?s.push(e):r.push(e),e.getId()==t&&(n=!1)}),this.dialogs=s,r}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PStory=e.story.PCtrlBase.extend({initialize:function(r){this.cfg=r,this.super=e.story.PCtrlBase.prototype,this.super.initialize.call(this,r.parent),this.cfg.chartsLibClass="undefined"!=typeof Highcharts?"highcharts":null,this.cfg.widthMode="",this.storyDef=r.flowDef||r.storyDefinition,this.id=this.storyDef.storyId,this.insight=r.insight,this.pserver=r.pserver,this.pserver||("undefined"!=typeof personetics&&null!==personetics?this.pserver=personetics.pserverProxy:this.pserver=null);r.data||r.insightFacts;var n={};this.texts=r.texts||r.storyText,this.ctx=new e.story.PWorkflowCtx(this),this.templates={},this.closeHandler=r.closeHandler,this.defaultLang=r.defaultLang||"en",n.lang=r.lang||this.defaultLang;var i=r.uxCtrl;i||(i=new e.story.skinController),this.uxCtrl=i,this.desktopScreenWidth=this.uxCtrl.getDesktopScreenWidth(),this.screenWidth=s(t).width(),this.screenWidth>this.desktopScreenWidth&&(this.cfg.widthMode="desktop"),this.uxCtrl.registerBlocks(),n.useProjectDefaultCurrency=e.projectConfiguration.getConfig("useProjectDefaultCurrency"),n.supportHtmlTagInProcessor=e.projectConfiguration.getConfig("supportHtmlTagInProcessor"),n.amountFormat=e.projectConfiguration.getConfig("amountFormat"),n.dateFormat=e.projectConfiguration.getConfig("dateFormat"),n.currencySymbol=e.projectConfiguration.getConfig("currencySymbol"),this.options=n,this.expressions=r.expressions,this.blockSessionManager=new e.story.PBlockSessionManager(this),this.model=this.blockSessionManager.getModel();var a={};this.storyDef.dialogs.forEach(function(t){a[t.id]?e.log("duplicate dlg found: "+t.id):a[t.id]=t}),this.dlgCfgMap=a},getId:function(){return this.id},fireEvent:function(t,e){this.handleEvent(t,e)},start:function(t){this.parentEl=t;var r=1==e.processor.PStoryConfig.isRtl()?"rtl":"ltr",n={storyId:this.getId(),langClass:"pstory-lang-"+this.lang,directionClass:"pstory-direction-"+r,cssClass:this.cfg.cssClass},i=this.getTemplateHtml("#pstory-frame",n),a=s(i);a=t.append(a),this.frameEl=a.find(".pstory-frame"),this.el=this.frameEl.find(".pstory-container");this.el;this.renderTitleText(),this.setPlaceHolderForFixedTitle(),this.renderDialogs(),this.scrollHandler()},renderDialogs:function(){this.cfg.isSingleDialogMode?this.renderDialog():this.doNextLoop()},renderTitleText:function(){if(this.cfg.showTitle){var t=this.getTitle(),e=this.getSubtitle(),r=this.cfg.iconType;if(this.parentEl.siblings().find(".pstory-title-text").length>0)this.parentEl.siblings().find(".pstory-subtitle-text").html(e),this.parentEl.siblings().find(".pstory-title .perso-teaser-image").addClass("perso-"+r),this.parentEl.siblings().find(".pstory-title-text").html(t);else{var n=this.getTemplateHtml("#tmpl-pstory-title-inside-story",{title:this.getTitle(),backButtonText:"back"}),i=s(n);this.el.append(i),this.el.find(".pstory-subtitle-text").html(e),this.el.find(".pstory-title .perso-teaser-image").addClass("perso-"+r),this.el.find(".pstory-title-text").html(t)}}},getTitle:function(){return this.getTitleHelper("title")},getSubtitle:function(){return this.getTitleHelper("subtitle")},getTitleHelper:function(t){var s=this.options.lang,r=this.defaultLang,n=this.storyDef[t];if(this.texts.hasOwnProperty(t)&&this.texts[t]){var i=this.texts[t];i.hasOwnProperty(s)?n=i[s]:i.hasOwnProperty(r)&&(n=i[r])}return n?new e.processor.PTextTemplate(n.txt,this).process(this.model):null},addTouchScroll:function(){this.frameEl.addClass("pstory-scrolling-touch")},renderDialog:function(t,e){var s;if(this.current){var r;if(this.current.setIsBlock(),e&&e.hasOwnProperty("renderPreviousDialog"))r=e.renderPreviousDialog?this.findPreviousDialog():this.current.config.next;else r=this.current.config.next;r&&(s=this.renderNextDlg(r,null))}else s=this.pushDlg(this.storyDef.dialogs[0],null);if(!s){var n=this.el.height();t&&t!=n&&this.cfg.resizeHandler&&this.cfg.resizeHandler(n)}},findPreviousDialog:function(){var t=this.current,e=this.storyDef.dialogs,r=null;return s.each(e,function(e,n){var i=n.next;if(i)if(s.isArray(i))s.each(i,function(e,s){if(s.target==t.config.id)return r={target:n.id},!1});else if(i.target==t.config.id)return r={target:n.id},!1}),r},doNextLoop:function(t){var e=this,r=this.current,n=function(){if(!e.next(n)){var s=e.el.height();e.afterLastDialog(s,t)}};if(n(),r){var i=r.config.next;if(i){var a;a=s.isArray(i)?i[0].target:i.target;var o="pdlg-"+e.id+"_"+a,l=this.el.parents(".perso-insights-container");this.scrollTo(l,o),this.setFocus(o)}}},afterLastDialog:function(t,e){var s=this;e&&e!=t&&s.cfg.resizeHandler&&s.cfg.resizeHandler(t,s.el),s.cfg.onEndHandleEvent&&s.cfg.onEndHandleEvent(s.el)},setPlaceHolderForFixedTitle:function(){var t=s(".pstory-title-wrapper"),e=t.height();t.length>0&&"fixed"==t.css("position")&&t.parent(".pstory-title-outer-wrapper").css("paddingBottom",e+"px");var r=this.el.parents("#story-frame-container");0==r.length&&(r=this.el.parents(".pstory-frame"));for(var n=this.el.parents(".pstory-frame");0==n.height();)n=n.parent();var i=r.height()>0?r.innerHeight():n.height();r.height(i-e)},pushDlg:function(t,s){t.isSingleDialogMode=this.cfg.isSingleDialogMode,t.widthMode=this.cfg.widthMode,t.chartsLibClass=this.cfg.chartsLibClass;var r=new e.story.PDialog(this,t);this.ctx.pushDlg(r);var n=this.ctx.getFirstDialogId()==t.id;this.current=r;var i=this;return this.uxCtrl.beforeRender(r,function(){r.render(i.el,n),r.afterRender(),r.bindEvents(),i.uxCtrl.afterRender(r,s)}),r},next:function(t){var e;this.current||(e=this.pushDlg(this.storyDef.dialogs[0],t));var s=this.current.config.next;return!e&&s&&(e=this.renderNextDlg(s,t)),e},renderNextDlg:function(t,s){for(var r=t,n=!1,i=0;i<this.current.config.blocks.length;i++)if(this.current.config.blocks[i].hasOwnProperty("buttonType")&&this.current.config.blocks[i].hasOwnProperty("class")&&"button"===this.current.config.blocks[i].buttonType&&"perso-radio-buttons"===this.current.config.blocks[i].class){n=!0;break}if(Array.isArray(t)||(r=[t]),!n||n&&this.model.getVarValue("selectedAnswer"))for(i=0;i<r.length;i++){var a=r[i],o=!0;if(a.cond){var l=new e.processor.PExp(a.cond);try{o=l.eval(this.model)}catch(t){o=!1}}if(o){if(this.ctx.hasDlg(a.target))break;var c=this.dlgCfgMap[a.target];if(c){this.pushDlg(c,s);break}e.utils.PLogger.error("could not find dialog definition for target: "+a.target)}}},handleEvent:function(t){this.el.prevObject.removeClass("pstory-scrolling-touch");var e=this,r=this.el.height();this.cfg.onStartHandleEvent&&this.cfg.onStartHandleEvent(r,this.el),this.current=null;t&&(t.dlgId,this.current=this.ctx.getDlg(t.dlgId));this.ctx.removeDlgsAfter(this.current.getId()).forEach(function(t){t.el&&t.el.remove(),s.each(t.config.blocks,function(t,s){e.blockSessionManager.resetVariables(s)})}),this.blockSessionManager.reset(),this.cfg.isSingleDialogMode?this.renderDialog(r):this.doNextLoop(r),this.el.prevObject.addClass("pstory-scrolling-touch")},handleQueryData:function(t,e){this.blockSessionManager.renderBlock(e.dlgId,e.index,t)},handleScroll:function(t,e){this.ctx.dialogs.forEach(function(s,r){var n=s.el.position().top,i=!0;(n+s.el.height()<=t||n>=e)&&(i=!1),s.setVisible(i)})},scrollTo:function(t,e){},setFocus:function(t){},scrollHandler:function(){var t=this;s(this.frameEl).bind("scroll",function(e){var r=s(this.frameEl).scrollTop();t.blockSessionManager.handleEvent("scroll",r)})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.accessibility={},e.utils.accessibility.isFocusable=function(t){if(s(t).is('[aria-hidden="true"], [aria-hidden="true"] *'))return!1;var e=s(t).contents().not(s(t).children()).text().trim().length>0;return!(!s(t).is(":input, [role], [aria-label], [aria-labelledby]")&&!e)},e.utils.accessibility.firstChildFocusable=function(t){if("undefind"==typeof t||null==t||0==t.length)return!1;var e=this,r=t.find("*"),n=!1;return s.each(r,function(t,s){if(1==(n=e.isFocusable(s)))return n=s,!1}),n},e.utils.accessibility.trackFocus=function(t){if(void 0!==t&&0!==t.length){var e,s=t.get(0),r=function(t){e="mousedown"===t.type},n=function(t){if(e){var s=t.target.getAttribute("class");t.target.setAttribute("class",s+" personetics-mouse-focus")}},i=function(t){var e=t.target.getAttribute("class");null!==e&&(e=e.replace(/ personetics-mouse-focus/g,""),t.target.setAttribute("class",e))};s.removeEventListener("keydown",r),s.removeEventListener("mousedown",r),s.removeEventListener("focusin",n),s.removeEventListener("focusout",i),s.addEventListener("keydown",r),s.addEventListener("mousedown",r),s.addEventListener("focusin",n),s.addEventListener("focusout",i)}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s){e.utils=e.utils?e.utils:{},e.utils.assert={},e.utils.assert.isUndefined=function(t){return void 0===t},e.utils.assert.isNullOrUndefined=function(t){return void 0===t||null==t},e.utils.assert.isTrue=function(t){return!e.utils.assert.isUndefined(t)&&1==t},e.utils.assert.isDefined=function(t,s){var r=!e.utils.assert.isUndefined(t);return r&&!e.utils.assert.isUndefined(s)&&null!=s&&(s||(r=null!=t)),r},e.utils.assert.AssertIsDefined=function(t,s){e.utils.assert.isNullOrUndefined(t)&&(s?e.utils.PLogger.error(s,s):e.utils.PLogger.error("Object is undefined","Object is undefined"))},e.utils.assert.assignDefaultValue=function(t,s){return e.utils.assert.isUndefined(t)?s:t},e.utils.assert.isObject=function(t){return"object"==typeof t},e.utils.assert.isString=function(t){return"string"==typeof t},e.utils.assert.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.utils.assert.isFunction=function(t){return"function"==typeof t},e.utils.assert.exists=function(t,e){for(var s=e.split("."),r=t,n=1;n<s.length;n++)r="undefined"==r?r:r[s[n]];return r},e.utils.assert.AssertIsNullOrUndefined=function(t,e){}}(window,window.Personetics=window.Personetics||{}),function(t,e,s,r){e.utils=e.utils||{},e.utils.d3Extensions={};var n=e.utils.persoHelper;e.utils.d3Extensions.html=function(t){if("string"==typeof t){var e=s("<span>").html(t).first().children()[0];if(void 0===e)this.text(t);else{var r=this.append("tspan"),n=e.attributes;s.each(n,function(t,e){r.attr(e.name,e.value)});var i=s(e).children();s.each(i,function(t,e){var n=r.append("tspan").text(s(e).text()),i=e.attributes;s.each(i,function(t,e){n.attr(e.name,e.value)})})}}},d3.selection.prototype.html=e.utils.d3Extensions.html,e.utils.d3Extensions.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);e=s(e).length>0?s(e)[0].innerText:e,this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=s(t).length>0?s(t)[0].innerText:t}):this.textContent},void 0!==n&&n.isOldAndroidVersion()&&(d3.selection.prototype.text=e.utils.d3Extensions.text)}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s){var r=[1,2,3,4,5,6,7,8,9,10,11,12],n={"en-short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],he:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],"he-short":["ינו'","פבר'","מרץ","אפר'","מאי","יונ'","יול'","אוג'","ספט'","אוק'","נוב'","דצמ'"],fr:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],"fr-short":["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],es:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],"es-short":["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"]};e.utils=e.utils?e.utils:{},e.utils.date={},e.utils.date.monthName=function(t,e,s){if(parseInt(t)!=t){var r=new Date(t),i=r.getMonth();null==i||null==i||isNaN(i)||(i=r.getMonth())}else try{var a=parseInt(t);if(!(a>=1&&a<=12))return t;i=a-1}catch(e){return t}1==s&&(e+="-short");var o=n[e];return o||(o=1==s?n["en-short"]:n.en),o[i]},e.utils.date.dayNumber=function(t,e){var s=t,r=new Date(t),n=r.getDate();return isNaN(n)||(s=r.getDate()),e&&"DD"==e&&s<10&&(s="0"+s),s},e.utils.date.monthNumber=function(t){if(parseInt(t)!=t){var e=new Date(t),s=e.getMonth();null==s||null==s||isNaN(s)||(s=e.getMonth())}else try{var n=parseInt(t);if(!(n>=1&&n<=12))return t;s=n-1}catch(e){return t}var i=r[s],a=i;return i<10&&(a="0"+a),a},e.utils.date.yearNumber=function(t,e){var s=new Date(t).getFullYear().toString();return e?s.substring(2):s},e.utils.date.nthDate=function(t,e){t=t.toLowerCase();for(var s=e+"-short",r=0;r<n[s].length&&-1===t.indexOf(n[s][r].toLowerCase());r++);var i=t.replace(n[s][r].toLowerCase(),""),a=n[e][r];return/^\d+$/.test(i)?a+" "+(i=parseInt(i,10))+function(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}(i):a}}(window,window.Personetics=window.Personetics||{}),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.dictionary={},e.utils.dictionary.overrideObjectProperties=function(t,r,n){e.utils.assert.assignDefaultValue(n,!0);var i=s.extend({},!0,t);return e.utils.assert.isNullOrUndefined(r)?i:e.utils.assert.isNullOrUndefined(i)?r:(s.each(r,function(t,e){i.hasOwnProperty(t)&&null!=i[t]&&!n||(i[t]=e)}),i)},e.utils.dictionary.hasItem=function(t,s,r){var n=e.utils.assert.isObject(t)&&e.utils.string.isValidString(s)&&t.hasOwnProperty(s);return r?n:n&&null!=t[s]},e.utils.dictionary.exists=function(t){for(var e=Array.prototype.slice.call(arguments,1),s=0;s<e.length;s++){if(!t||!t.hasOwnProperty(e[s]))return!1;t=t[e[s]]}return!0},e.utils.dictionary.removeInvalids=function(t){var r={};return void 0!==t&&t&&s.each(t,function(t,s){null!=s&&(e.utils.assert.isObject(s)&&!e.utils.assert.isArray(s)?r[t]=e.utils.dictionary.removeInvalids(s):r[t]=s)}),r}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.encodeDecode={},e.utils.encodeDecode.Base64={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){for(var s=new e.utils.string.StringBuffer,r=new e.utils.encodeDecode.Utf8EncodeEnumerator(t);r.moveNext();){var n=r.current;r.moveNext();var i=r.current;r.moveNext();var a=r.current,o=n>>2,l=(3&n)<<4|i>>4,c=(15&i)<<2|a>>6,u=63&a;isNaN(i)?c=u=64:isNaN(a)&&(u=64),s.append(this.codex.charAt(o)+this.codex.charAt(l)+this.codex.charAt(c)+this.codex.charAt(u))}return s.toString()},decode:function(t){for(var s=new e.utils.string.StringBuffer,r=new e.utils.encodeDecode.Base64DecodeEnumerator(t);r.moveNext();){var n=r.current;if(n<128)s.append(String.fromCharCode(n));else if(n>191&&n<224){r.moveNext();var i=r.current;s.append(String.fromCharCode((31&n)<<6|63&i))}else{r.moveNext();i=r.current;r.moveNext();var a=r.current;s.append(String.fromCharCode((15&n)<<12|(63&i)<<6|63&a))}}return s.toString()}},e.utils.encodeDecode.Utf8EncodeEnumerator=function(t){this._input=t,this._index=-1,this._buffer=[],this.current=Number.NaN,this.moveNext=function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var t=this._input.charCodeAt(++this._index);return 13==t&&10==this._input.charCodeAt(this._index+1)&&(t=10,this._index+=2),t<128?this.current=t:t>127&&t<2048?(this.current=t>>6|192,this._buffer.push(63&t|128)):(this.current=t>>12|224,this._buffer.push(t>>6&63|128),this._buffer.push(63&t|128)),!0}},e.utils.encodeDecode.Base64DecodeEnumerator=function(t){this._input=t,this._index=-1,this._buffer=[],this.current=64,this.moveNext=function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var t=e.utils.encodeDecode.Base64.codex.indexOf(this._input.charAt(++this._index)),s=e.utils.encodeDecode.Base64.codex.indexOf(this._input.charAt(++this._index)),r=e.utils.encodeDecode.Base64.codex.indexOf(this._input.charAt(++this._index)),n=e.utils.encodeDecode.Base64.codex.indexOf(this._input.charAt(++this._index)),i=t<<2|s>>4,a=(15&s)<<4|r>>2,o=(3&r)<<6|n;return this.current=i,64!=r&&this._buffer.push(a),64!=n&&this._buffer.push(o),!0}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.json={};var n=t.JSON||{};t.JSON=n,n.stringify=n.stringify||function(t){var e=typeof t;if("object"!=e||null===t)return"string"==e&&(t='"'+t+'"'),String(t);var s,r,i=[],a=t&&t.constructor==Array;for(s in t)t.hasOwnProperty(s)&&("string"==(e=typeof(r=t[s]))?r='"'+r+'"':"object"==e&&null!==r&&(r=n.stringify(r)),i.push((a?"":'"'+s+'":')+String(r)));return(a?"[":"{")+String(i)+(a?"]":"}")},e.utils.json.getJsonStringifyMethod=function(){return s.toJSON?s.toJSON:n.stringify},e.utils.json.toJSON=function(t){var s=e.utils.json.getJsonStringifyMethod();if("undefined"!=typeof Prototype&&void 0!==Array.prototype.toJSON){var r=Array.prototype.toJSON;delete Array.prototype.toJSON;var n=s(t);return Array.prototype.toJSON=r,n}return s(t)},e.utils.json.replacer=function(t,e,s,r,n){var i=e||"";return s&&(i=i+"<span class=json-key>"+s.replace(/[": ]/g,"")+"</span>: "),r&&(i=i+('"'==r[0]?"<span class=json-string>":"<span class=json-value>")+r+"</span>"),i+(n||"")},e.utils.json.prettyPrint=function(t){return n.stringify(t,null,3).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^( *)("[\w.+-]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/gm,e.utils.json.replacer)},e.utils.json.mergeString=function(t,s){var r=n.parse(t),i=n.parse(s),a=e.utils.json.mergeObject(r,i);return e.utils.json.toJSON(a)},e.utils.json.mergeObject=function(t,e){return s.extend({},t,e)},e.utils.json.mergeDeepObject=function(t,e){return s.extend(!0,{},t,e)}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s){e.utils=e.utils||{},e.PLoggerModes={VERBOSE:{name:"VERBOSE",value:1},DEBUG:{name:"DEBUG",value:2},ALERT:{name:"ALERT",value:3},ERROR:{name:"ERROR",value:4},PRODUCTION:{name:"PRODUCTION",value:5}};var r=function(){this.mode=e.PLoggerModes.ERROR.value};r.prototype.setDebugMode=function(t){null!=t&&t.hasOwnProperty("name")&&e.PLoggerModes.hasOwnProperty(t.name)&&(this.mode=t.value)},r.prototype.verbose=function(t){this.mode<=e.PLoggerModes.VERBOSE.value&&console.log(t)},r.prototype.debug=function(t){this.mode<=e.PLoggerModes.DEBUG.value&&console.log(t)},r.prototype.error=function(t,s,r){if(this.mode<=e.PLoggerModes.ERROR.value){if(void 0===r||!r.hasOwnProperty("shouldDisplayError")||void 0===r.shouldDisplayError||r.shouldDisplayError)e.processor.PStoryConfig.getConfig("context")?n(t):console.error("<< ERROR >>: "+t);if(e.utils.assert.isDefined(s,!1))throw s}},r.prototype.alert=function(t){this.mode<=e.PLoggerModes.ALERT.value&&alert(t)};var n=function(t){var s=e.processor.PStoryConfig.getConfig("context").toLowerCase(),r=this[e.processor.PStoryConfig.getConfig("serverCallBack")];if("server"===s){if("function"!=typeof r)throw t;r(t)}else{if("function"!=typeof r)throw'Error - invalid value for key "context", it should be "SERVER" \nProcessor error - '+t;r('Error - invalid value for key "context", it should be "SERVER" \nProcessor error - '+t)}};e.utils.PLogger=new r,e.verbose=e.utils.PLogger.verbose.bind(e.utils.PLogger),e.log=e.utils.PLogger.debug.bind(e.utils.PLogger),e.debug=e.utils.PLogger.debug.bind(e.utils.PLogger),e.error=e.utils.PLogger.error.bind(e.utils.PLogger),e.alert=e.utils.PLogger.alert.bind(e.utils.PLogger)}(window,window.Personetics=window.Personetics||{}),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.messages={},e.utils.messages.errorMessage=function(t){var s=e.UI.Handlebars.templates[t&&t.templateId?t.templateId:"error-msg"];if("undefined"!=typeof personetics&&null!==personetics&&personetics.hasOwnProperty("getDeviceType"))var r=personetics.getDeviceType()||"web";return s("web"===r?{textLarge:t.textLarge,textSmall:t.textSmall,imgClass:t.imgClass}:{textLarge:t.textLarge,textSmall:t.textSmall,imgClass:t.imgClass,isMobileDevice:!0})},e.utils.messages.noInsightsMessage=function(t){var s=e.UI.Handlebars.templates[t&&t.templateId?t.templateId:"no-insights-message"];if("undefined"!=typeof personetics&&null!==personetics&&personetics.hasOwnProperty("getDeviceType"))var r=personetics.getDeviceType()||"web";return s("web"===r?{textLarge:t.textLarge,textSmall:t.textSmall,imgClass:t.imgClass}:{textLarge:t.textLarge,textSmall:t.textSmall,imgClass:t.imgClass,isMobileDevice:!0})},e.utils.messages.noFilteredInsightsMessage=function(t){var s=e.UI.Handlebars.templates[t&&t.templateId?t.templateId:"no-filtered-insights-msg"];if("undefined"!=typeof personetics&&null!==personetics&&personetics.hasOwnProperty("getDeviceType"))var r=personetics.getDeviceType()||"web";return s("web"===r?{text:t.text}:{text:t.text,isMobileDevice:!0})}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.network={},e.utils.network.consts={base64EncodeResponse:!1,requestTimeoutInMillis:3e5,dataType:"json",async:!0,onComplete:function(){},onSuccess:function(t,s,r){e.log("request success")},onFailure:function(t,s,r){e.log("request failed: "+s+", "+r)}},e.utils.network.doAjaxGet=function(t,r,n){var i=e.utils.dictionary.overrideObjectProperties(n,e.utils.network.consts,!1);e.utils.assert.AssertIsDefined(t,"Personetics.utils.network.doAjaxGet: invalid request URL: "+t);var a={type:"GET",url:t,dataType:i.dataType,async:i.async,timeout:i.requestTimeoutInMillis,complete:i.onComplete,success:function(t){var r=t;1==i.base64EncodeResponse&&(r=e.utils.network.decodeDataWithBase64(t),r=s.parseJSON(r));i.onSuccess(r)},error:function(t,e,s){i.onFailure(t,e,s)}};e.utils.assert.isNullOrUndefined(r)||(a.data=r),s.ajax(a)},e.utils.network.doAjaxPost=function(t,r,n){var i=e.utils.dictionary.overrideObjectProperties(n,e.utils.network.consts,!1);e.utils.assert.AssertIsNullOrUndefined(t,"Personetics.utils.network.doAjaxPost: invalid request URL: "+t),s.ajax({type:"POST",url:t,data:r,dataType:i.dataType,async:i.async,headers:i.headers,timeout:i.requestTimeoutInMillis,complete:i.onComplete,success:function(t){var r=t;1==i.base64EncodeResponse&&(r=e.utils.network.decodeDataWithBase64(t),r=s.parseJSON(r));i.onSuccess(r)},error:function(t,e,s){i.onFailure(t,e,s)}})},e.utils.network.queueAjaxPost=function(t,r,n,i){var a=e.utils.dictionary.overrideObjectProperties(i,e.utils.network.consts,!1);return s.ajaxq(t,{type:"POST",url:r,data:n,dataType:a.dataType,timeout:a.requestTimeoutInMillis,success:function(t){var r=t;1==a.base64EncodeResponse&&(r=e.utils.network.decodeDataWithBase64(t),r=s.parseJSON(r));a.onSuccess(r)},error:function(t,e,s){a.onFailure(t,e,s)}})},e.utils.network.removeAjaxPostQueue=function(t){s.ajaxq(t)},e.utils.network.wasUserAborted=function(t,e){return!t.getAllResponseHeaders()&&"timeout"!=e},e.utils.network.createPostform=function(t,e,s,r,n){s.charset="utf-8";var i=s.createElement("form");for(var a in i.setAttribute("id","hintForm"),i.setAttribute("method","post"),i.setAttribute("action",e),t)if(t.hasOwnProperty(a)){var o=s.createElement("input");o.type="hidden",o.name=a,o.value=t[a],i.appendChild(o)}s.body.appendChild(i),i.submit(),s.body.removeChild(i)},e.utils.network.decodeDataWithBase64=function(t){return t=(t=t.replace(/(\r\n|\n|\r)/gm,"")).replace(/"/g,""),e.utils.encodeDecode.Base64.decode(t)}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s){e.utils=e.utils?e.utils:{},e.utils.persoHelper={},e.utils.persoHelper.constants={ANDROID_VERSIONS:{OLD_VERSION_MIN_TARGET:4.4,OLD_VERSION_MAX_TARGET:5}},e.utils.persoHelper.getAndroidVersionNumber=function(){var t;return r()&&(t=parseFloat(r())),t},e.utils.persoHelper.isOldAndroidVersion=function(){var t=this.getAndroidVersionNumber(),e=!1;return void 0!==t&&t>0&&t<this.constants.ANDROID_VERSIONS.OLD_VERSION_MAX_TARGET&&t>=this.constants.ANDROID_VERSIONS.OLD_VERSION_MIN_TARGET&&(e=!0),e};var r=function(){var t=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return!!t&&t[1]}}(window,window.Personetics=window.Personetics||{}),function(t,e,s,r){function n(t,e,s){var r=i({width:t.clientWidth,height:t.clientHeight,totalHeight:s.height}),n=s.x?s.x:0,a=s.y?s.y:0;e.addHTML(t,n,a,{pagesplit:!0,canvas:r},function(){r.parentElement&&s.parent.removeChild(r),e.save(s.fileName+s.format),s.callback&&s.callback()})}function i(t){var e=document.createElement("canvas");e.width=3*t.width,e.height=3*t.totalHeight,e.style.width=t.width+"px",e.style.height=t.height+"px";var s=e.getContext("2d");return s.scale(3,3),s.fillStyle="rgba(255, 255, 255, 1)",s.fillRect(0,0,e.width,e.height),e}function a(t,e,s){var r=document.createElement("canvas");r.width=3*e,r.height=3*s,r.style.width=e+"px",r.style.height=s+"px";var n=r.getContext("2d");return n.scale(3,3),n.fillStyle="rgba(255, 255, 255, 1)",n.fillRect(0,0,r.width,r.height),n.drawImage(t,0,0),r}e.utils=e.utils?e.utils:{},e.utils.print={},e.utils.print.printHtmlToPdf=function(t){var e=new jsPDF("p","pt","a4");e.addFont("Roboto"),e.setFont("Roboto");var s=t.parent;if(t.page&&t.page.el){var r=t.page.el;i=t.parent.getElementsByTagName("*");t.beforeExportCallback&&t.beforeExportCallback(i),html2canvas(r,{allowTaint:!1,useCORS:!0}).then(function(i){e.internal.scaleFactor=t.page.internalScaleFactor;var o=a(i,r.clientWidth,r.clientHeight);t.parent.appendChild(o);var l=t.x?t.x:0,c=t.y?t.y:0;e.addHTML(o,l,c,{pagesplit:!0,allowTaint:!1,useCORS:!0},function(){o.parentElement&&t.parent.removeChild(o),r.parentNode.removeChild(r),e.addPage(),e.internal.scaleFactor=t.internalScaleFactor,n(s,e,t)})})}else{var i=t.parent.getElementsByTagName("*");t.beforeExportCallback&&t.beforeExportCallback(i),e.internal.scaleFactor=t.internalScaleFactor,n(s,e,t)}},e.utils.print.printHtmlToPdfWithLoop=function(e){var s=new jsPDF("p","pt","a4"),r=e.parent;if(e.page&&e.page.html){s.internal.scaleFactor=2.5;var n=document.createElement("div");n.innerHTML=e.page.html;var o=n.firstChild;o.style.width=e.page.width,e.parent.appendChild(o);for(var l=o.getElementsByTagName("*"),c=0;c<l.length;c++)"none"!==t.getComputedStyle(l[c],null).getPropertyValue("background-image")&&(l[c].style.backgroundImage="none");html2canvas(o,{allowTaint:!1,useCORS:!0}).then(function(t){s.internal.scaleFactor=1;var n=a(t,o.clientWidth,o.clientHeight);e.parent.appendChild(n),s.addHTML(n,0,0,{pagesplit:!0,allowTaint:!1,useCORS:!0},function(){n.parentElement&&e.parent.removeChild(n),o.parentNode.removeChild(o),s.addPage(),s.internal.scaleFactor=3.75;var t=i({width:r.clientWidth,height:r.clientHeight,totalHeight:e.height});s.addHTML(r,{pagesplit:!0,canvas:t},function(){s.save(e.fileName+e.format),e.callback&&e.callback()})})})}else{s.internal.scaleFactor=3.75;var u=e.parent.getElementsByClassName("pstory-dialog-content"),d=i({width:r.clientWidth,height:r.clientHeight,totalHeight:e.height});s.addHTML(u[0],{pagesplit:!0,canvas:d},function(){d.parentElement&&e.parent.removeChild(d),function t(e,s,r,n){if(r==s.length)return e.save(n.fileName+n.format),void(n.callback&&n.callback());e.addPage();html2canvas(s[r],{allowTaint:!1,useCORS:!0}).then(function(i){e.internal.scaleFactor=1;var o=a(i,s[r].clientWidth,s[r].clientHeight);n.parent.appendChild(o),e.addHTML(o,0,0,{pagesplit:!0,allowTaint:!1,useCORS:!0},function(){o.parentElement&&n.parent.removeChild(o),t(e,s,r+1,n)})})}(s,u,1,e)})}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.scope={},e.utils.scope.bind=function(t,e){return function(){return e.apply(t,arguments)}},e.bind=e.utils.scope.bind,e.utils.scope.Callback=function(t,e){this.parameters=e,this.f=t;var s=this;this.invoke=function(){s.f.apply(s,s.parameters)}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.string={},e.utils.string.isString=function(t){return"string"==typeof t},e.utils.string.isEmpty=function(t){return e.utils.string.isString(t)&&0==t.length},e.utils.string.isValidString=function(t){return e.utils.assert.isString(t)&&null!=t&&t.length>0},e.utils.string.truncateLongWords=function(t,e){if(void 0!==t&&t&&t.length>0&&t.replace(/ /g,"").length>0){var r=t.split(" "),n=[];return s.each(r,function(t,s){s.length>e?n.push(s.substring(0,e-6)+"..."):n.push(s)}),n.join(" ")}return""},e.utils.string.stripTags=function(t){var e=["script"],r=t;return void 0!==t&&null!=t&&t.length>0&&s.each(e,function(t,s){var n=new RegExp("<"+e+".*>.*</"+s+">","ig");r=r.replace(n,"")}),r},e.utils.string.replaceNewLine=function(t){if(!t)return t;var r=typeof t;if("string"==r){var n=new RegExp("^<([A-Z][A-Z0-9]*)[^>]*>(.*?)</\\1>$","gim").exec(t.replace(/\n/g,""));t=n?t.replace(/\n/g,""):t.replace(/\n/g,"<br />")}else"object"==r&&s.each(t,function(s,r){if(r&&("string"!=typeof s||-1==s.toLowerCase().indexOf("speaking"))){t[s]=e.utils.string.replaceNewLine(r)}});return t},e.utils.string.StringBuffer=function(){this.buffer=[],this.append=function(t){return this.buffer.push(t),this},this.toString=function(){return this.buffer.join("")}},e.utils.string.decodeHTMLSpecialCharecters=function(t){return t.replace("&amp;","&")},e.utils.string.stripSpecialChars=function(t){return t.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"-")},e.utils.string.removeClass=function(t,e){var s=t;return"object"==typeof t&&(s=s.animVal),s=s.replace(new RegExp("(?:^|\\s)"+e+"(?:\\s|$)")," ")},e.utils.string.addClass=function(t,s){var r=t=e.utils.string.removeClass(t,s);return"object"==typeof t&&(r=r.animVal),r+=" "+s}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.url={},e.utils.url.getParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==e?null:decodeURIComponent(e[1].replace(/\+/g," "))},e.utils.url.getAbsoluteUrl=function(e){if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(e))return e;for(var s=t.location.href.split("/"),r="",n=0;n<s.length-1;n++)0!=n&&(r+="/"),r+=s[n];return r+"/"+e},e.utils.url.openTabWithPost=function(s,r,n){var i=e.utils.url.getAbsoluteUrl(s),a=t.open("","_blank");a.opener=null,a.focus();var o=a.document;e.utils.network.createPostform(name,n,i,o)},e.utils.url.iframeWithPost=function(t,e,s){var r=document.createElement("form");for(var n in r.setAttribute("method","post"),r.setAttribute("action",t),r.setAttribute("target",e),s)if(s.hasOwnProperty(n)){var i=document.createElement("input");i.type="hidden",i.name=n,i.value=s[n],r.appendChild(i)}document.body.appendChild(r),r.submit(),document.body.removeChild(r)},e.utils.url.urlCheck=function(t){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)},e.utils.url.encodePostParams=function(t){return s.each(t,e.bind(this,function(s,r){if(s.indexOf("64")>=0){var n=e.utils.json.toJSON(t[s]),i=e.utils.encodeDecode.Base64.encode(n);t[s]=i}})),t}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(t){var e=[0,2,1][t.length%3],s=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[i.charAt(s>>>18),i.charAt(s>>>12&63),e>=2?"=":i.charAt(s>>>6&63),e>=1?"=":i.charAt(63&s)].join("")},o=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?n(192|e>>>6)+n(128|63&e):n(224|e>>>12&15)+n(128|e>>>6&63)+n(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return n(240|e>>>18&7)+n(128|e>>>12&63)+n(128|e>>>6&63)+n(128|63&e)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return function(t){t=t.replace(/\r\n/g,"\n");for(var e="",s=0;s<t.length;s++){var r=t.charCodeAt(s);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(t.replace(l,o).replace(/[\s\S]{1,3}/g,a))},u=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),d=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return n(55296+(e>>>10))+n(56320+(1023&e));case 3:return n((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return n((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},p=function(t){for(var e={},s=0,r=t.length;s<r;s++)e[t.charAt(s)]=s;return e}(i),h=function(t){var e=t.length,s=e%4,r=(e>0?p[t.charAt(0)]<<18:0)|(e>1?p[t.charAt(1)]<<12:0)|(e>2?p[t.charAt(2)]<<6:0)|(e>3?p[t.charAt(3)]:0),i=[n(r>>>16),n(r>>>8&255),n(255&r)];return i.length-=[0,0,2,1][s],i.join("")},f=function(t){return t.replace(/[\s\S]{1,4}/g,h).replace(u,d)};e.utils=e.utils?e.utils:{},e.utils.encodeDecode={},e.utils.encodeDecode.Base64={encode:function(t,e){return e?c(t).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):c(t)},decode:function(t){return t=function(t){var e,s,r="",n=0;for(e=s=0;n<t.length;)(e=t.charCodeAt(n))<128?(r+=String.fromCharCode(e),n++):e>191&&e<224?(s=t.charCodeAt(n+1),r+=String.fromCharCode((31&e)<<6|63&s),n+=2):(s=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),r+=String.fromCharCode((15&e)<<12|(63&s)<<6|63&c3),n+=3);return r}(t),f(t.replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.PEvent=Base.extend({initialize:function(){this.eventMessage={type:"sendEvents",eventInfo:{},checkInPastEvent:!0}},setParam:function(t,e){this.eventMessage.eventInfo.params[t]=e},getJsonMessageEvent:function(){return JSON.stringify(this.eventMessage)},onSuccessCallback:function(){},onErrorCallback:function(){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.PEventsBuffer=function(){this.sendEventsTypesMapping={"account-selector":"AccountSelector","bar-chart":"BarChart","pie-chart":"PieChart",tabs:"Button",buttons:"Button",Navigation:"NavigateButton"},this.pastEvents=[],this.eventToSend=[],this.eventDelayInterval=e.projectConfiguration.getConfig("eventDelayInterval"),this.start=function(){var t=this;this.intervalId=setInterval(function(){t.sendEvents()},this.eventDelayInterval)},this.stop=function(){this.intervalId&&clearInterval(this.intervalId)},this.addEventToSend=function(t,e,s){1==this.shouldSendEvent(t)&&(this.eventToSend.push({eventData:t,onSuccessCallback:e,onErrorCallback:s}),"Navigation"===t.eventMessage.eventInfo.type&&this.sendEvents())},this.sendEvents=function(){var t=this,r=!1,n={},i=[];this.eventToSend.length&&(n.type=this.eventToSend[0].eventData.eventMessage.type,n.ctxId="dashboard",n.lang=e.processor.PStoryConfig.getConfig("lang"),n.protocolVersion=this.eventToSend[0].eventData.eventMessage.protocolVersion),s.each(this.eventToSend,function(e,s){void 0!==t.sendEventsTypesMapping[s.eventData.eventMessage.eventInfo.type]&&(s.eventData.eventMessage.eventInfo.type=t.sendEventsTypesMapping[s.eventData.eventMessage.eventInfo.type]),i.push(s.eventData.eventMessage.eventInfo),t.pastEvents.push(s)}),i.length&&(r=!0,n.eventsInfoList=i,personetics.pserverProxy.notifyEvent(n,this.onSuccess,this.onError)),1==r&&(this.eventToSend=[])},this.onSuccess=function(){},this.onError=function(){},this.shouldSendEvent=function(t){var e=!0,r=JSON.stringify(t.eventMessage.eventInfo);return 1==t.eventMessage.checkInPastEvent&&s.each(this.pastEvents,function(t,s){var n=s.eventData.eventMessage.eventInfo;if(JSON.stringify(n)===r)return e=!1,!1}),0==e?e:(s.each(this.eventToSend,function(t,s){var n=s.eventData.eventMessage.eventInfo;if(JSON.stringify(n)===JSON.stringify(r))return e=!1,!1}),e)},this.onEventSendSuccess=function(){},this.onEventSendError=function(){e.log("Error on sending events to PServer....")}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.PEventOptInOut=e.utils.PEvent.extend({initialize:function(){this.eventMessage={type:"sendEvents",eventInfo:{type:"opt-in",params:{}},checkInPastEvent:!1}},setOptInParam:function(t){var e="in";e=1==t?"in":"out",this.eventMessage.eventInfo.params.isOptIn=e},setSentTime:function(){this.eventMessage.eventInfo.params.timestamp=new Date},getJsonMessageEvent:function(){return JSON.stringify(this.eventMessage)},onSuccessCallback:function(){},onErrorCallback:function(){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{};var n=e.utils.PEvent.extend({initialize:function(){this.params={eventType:"sendEvents",checkInPastEvent:"false",protocolVersion:e.projectConfiguration.getConfig("protocolVersion"),userId:"",type:"",value:"",insightId:"",instanceId:""}},setValue:function(t){var e=this;s.each(t,function(t,s){e.params.hasOwnProperty(t)&&"undefined"!=s&&null!=s&&(e.params[t]=s)})},createMessage:function(){var t=this.params;return{type:t.eventType,userId:t.userId,checkInPastEvent:t.checkInPastEvent,protocolVersion:t.protocolVersion,eventInfo:{type:t.type,eventDateTime:new Date,params:{value:t.value,insightId:t.insightId,instanceId:t.instanceId}}}},notifyEvent:function(){var t={eventMessage:this.createMessage()};personetics.notifyEvent(t)}});e.utils.PEventReporting=new n}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PWebAnalytics=Base.extend({reportWidgetActive:function(t){},reportWidgetLoaded:function(t){},reportOverlayLoaded:function(t){},reportRatingsSent:function(t){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{};e.utils.allAccountsAnimation=new function(){var t={},r=function(t){var s=!1;return void 0===t.type||null===t.type?e.error("Required property 'type' is missing"):void 0===t.doAnimation||null===t.doAnimation?e.error("Required property 'doAnimation' is missing"):void 0===t.cancelAnimation||null===t.cancelAnimation?e.error("Required property 'cancelAnimation' is missing"):s=!0,s};function n(e){r(e)&&(t[e.type]={doAnimation:e.doAnimation,cancelAnimation:e.cancelAnimation})}n({type:"heapCards",doAnimation:function(t,e,r){var n=e.length,i=r.cardsStackTotalHeight||s(e).height()/5,a=r.maxSpaceBetweenCards||10,o=Math.min(a,i/n),l=(i-n*o)/2;s(t).css("top",l+"px"),s(t).css("zIndex",n+1),s.each(e,function(e,r){var i=s(t).offset().left-s(r).offset().left+parseInt(s(r).css("left"));s(r).css({left:i+"px",top:(e+1)*o+l+"px",zIndex:n-e})}),r.showBoxShadowForLastCardOnly?e.last().addClass("pstory-boxshadow-card"):e.add(t).addClass("pstory-boxshadow-card"),r.scale&&(s(t).css({transform:"scalex(1)"}),s.each(e,function(t,e){var n=1-(t+1)*r.scale;s(e).css({transform:"scalex("+n+")"})}))},cancelAnimation:function(t){t.css({left:"",top:""})}}),n({type:"fadingSlidingOut",doAnimation:function(t,e,r){var n=r.container||t.parents(".options-container");s.each(e.add(t),function(t,e){var r=s(e).offset().left-n.offset().left,i=parseInt(s(e).css("left")),a=s(".options-container").width()-r+i;s(e).css("left",a+"px")})},cancelAnimation:function(t){t.css({left:""})}}),this.addAnimation=n,this.getAnimation=function(s){if(t.hasOwnProperty(s))return t[s];e.error("All accounts animation doesn't support this type: "+s)}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.buttonAnimation={},e.utils.buttonAnimation.bindMaterialButtonEventsForAnimation=function(t){var e,r,n,i,a,o;s(t).bind("click",function(t){s(".ink").siblings().one("click",function(t){t.stopPropagation()}),s(t.currentTarget).find(".ink").siblings().click()}),s(t).bind("touchend",function(){s(".ink").css({opacity:"0"}),o=setTimeout(function(){s(".ink").remove()},800)}),s(t).bind("touchstart",function(t){r=t.originalEvent.touches[0].pageX,n=t.originalEvent.touches[0].pageY,e=s(this),a=s(this).css("color"),function(){e.prepend('<span class="ink"></span>'),(i=e.find(".ink")).css("background",a),i.height()||i.width()||(d=Math.max(e.outerWidth(),e.outerHeight()),i.css({height:d,width:d}));r=r-e.offset().left-i.width()/2,n=n-e.offset().top-i.height()/2,i.css({top:n+"px",left:r+"px"}).css({transform:"scale(1.8)"}),clearTimeout(o)}()})}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.carouselAnimation={},e.utils.carouselAnimation.bindCarouselEventsForAnimation=function(r,n){var i,a,o,l={},c={Space:32,Enter:13,LeftArrow:37,RightArrow:39,UpArrow:38,DownArrow:40};function u(t,e){void 0===t&&(t=o.filter(":not(.selected)").outerWidth(!0)),void 0===e&&(e=o.filter(".selected").outerWidth(!0)),l.itemWidth=t,l.selectedItemWidth=e;var n=0,c=-1;if(s.each(o,function(t,e){s(e).hasClass("selected")&&(c=t)}),-1==c){c=0;var u=o.first().attr("pstory-id");a.filter("[pstory-id='"+u+"']").addClass("selected")}var d=o.length;d>1&&(n-=t*(d-1),n-=e);var p=(n+=(r.width()-e)/2)-t*c;l.minLeft=n,i.css({"transition-duration":"0s","-webkit-transition-duration":"0s"}),i.css({left:p+"px"})}function d(t){"number"==typeof t&&(l.numItemsDispaly=t,t>o.length?a.filter("[clone='true']").addClass("carousel-hide-clone"):a.removeClass("carousel-hide-clone"))}function p(e){"function"==typeof n.beforeCarouselStart&&n.beforeCarouselStart(e),function(e,r){var c=e.currentTarget;if(s(c).hasClass("selected")||1==l.disableInputSelect)return;var u=l.swipeDirection;null==u&&(u=s(c).hasClass("prev")?1:-1);l.disableInputSelect=!0,a.removeClass("selected"),a.removeClass("prev"),a.removeClass("next");var d=s(c).attr("pstory-id");a.filter('[pstory-id="'+d+'"]').addClass("selected"),"number"!=typeof r&&(r=300);var p=o.length,h=l.minLeft,g=h-(l.itemWidth*(p-1)+l.selectedItemWidth),y=0;y=parseFloat(i.css("left"));var m=l.itemWidth*u+y,v=l.selectedItemWidth-l.itemWidth,b=s(c).index(),x=i.find(".carousel-item:lt("+b+")").filter(".selected").length;x>1?m-=v:0==x&&(m+=v);setTimeout(function(){i.css({"transition-duration":"0s","-webkit-transition-duration":"0s"}),Math.abs(m)>=Math.abs(g)-v?i.css({left:h+"px"}):Math.abs(m)<Math.abs(h)-v&&(g=g+l.itemWidth+v,i.css({left:g+"px"})),l.disableInputSelect=!1,"function"==typeof n.afterCarouselEnd&&n.afterCarouselEnd()},r),i.css({"transition-duration":r+"ms","-webkit-transition-duration":r+"ms"}),i.css({left:m+"px"}),l.swipeDirection=null,f(),function(e){var r=n&&n.isDesktop?null:s(".pstory-account-button.selected");r&&r.length<1&&a.filter(".selected:not([clone='true'])");var i=10+e;r&&(r.attr("tabindex","0"),r.blur());t.setTimeout(function(){r&&r.focus(),n&&n.onAnimationEnd&&n.onAnimationEnd()},i)}(r)}(e,n.animateDuration),n.showIndexDots&&this.dotAnimation.updateIndex(e)}function h(t){if(s(r).hasClass("carousel-disable")||this.disableInputSelect)n&&n.onAnimationEnd&&n.onAnimationEnd();else if("left"==t||"right"==t){var e=a.length,i=o.filter(".selected").index(),c="left"==t?1:-1;if((i+=c)==e&&(i=0),i<0&&(i=e-1),o.length<l.numItemsDispaly&&"true"==s(a[i]).attr("clone"))return l.swipeDirection=null,void(n&&n.onAnimationEnd&&n.onAnimationEnd());l.swipeDirection=-1*c;var u={};u.swipeDirection=t,u.currentTarget=a[i],p(u)}}function f(){var t=a.filter(".selected:not([clone='true'])");t.siblings().attr("aria-hidden",!0),t.attr("aria-hidden",!0),t.prev().addClass("prev"),t.next().addClass("next"),t.prev().addClass("prev"),t.next().addClass("next"),a.removeAttr("aria-label"),void 0!==n.text&&(void 0!==n.text.next&&t.next().attr("aria-label",n.text.next),void 0!==n.text.prev&&t.prev().attr("aria-label",n.text.prev))}!function(){i=s(r).find(".carousel-inner-wrapper"),o=i.find(".carousel-item"),i.attr("num-original-cards",o.length),void 0===n&&(n={});void 0!==n.itemWidth&&(l.itemWidth=n.itemWidth);void 0!==n.selectedItemWidth&&(l.selectedItemWidth=n.selectedItemWidth);void 0===n.numItemsDispaly&&(n.numItemsDispaly=3);if(o.length>1){var t=o.clone(!0);t.attr("clone","true");var g=t.clone(!0);i.prepend(s(t)),i.append(s(g).slice(0,2))}a=i.find(".carousel-item"),u(l.itemWidth,l.selectedItemWidth),this.dotAnimation=new e.utils.DotAnimation.bindDotEventsForAnimation(r,o,n),this.dotAnimation.setSelectedDot(),d(n.numItemsDispaly),function(){!1!==n.onClick&&(a.bind("click",function(t){0==s(r).hasClass("carousel-disable")&&p(t)}),s("#personetics-teaser-widget-carousel").bind("keydown",function(t){t.target===document.activeElement&&(-1!==[c.RightArrow].indexOf(t.which)&&h("right"),-1!==[c.LeftArrow].indexOf(t.which)&&h("left"),-1!==[c.Enter].indexOf(t.which)&&s(this).find(".account-button.selected").click())}));!1!==n.onSwipe&&s(r).swipe(function(t){0==s(r).hasClass("carousel-disable")&&h(t)},{preventDefault:!1})}(),f()}(),this.startCarousel=p,this.setConfig=u,this.setNumItemsToDispaly=d,this.onSwipe=h}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.DotAnimation={},e.utils.DotAnimation.bindDotEventsForAnimation=function(t,e,r){this.elementWrapper=t,this.params=r,this.setSelectedDot=function(){var t=0;if(s.each(e,function(e,r){s(r).hasClass("selected")&&(t=e)}),r.showIndexDots){var n=this.elementWrapper.find(".carousel-index-wrapper .carousel-index-dot");if(r.firstDot)s(n[0]).addClass("pstory-selected-index"),s.each(n,function(t,r){var n=t;s(r).attr("pstory-id",s(e[n]).attr("pstory-id"))});else{var i=e.length,a=Math.ceil(i/2)-1-t;a<0&&(a=i+a);for(var o=0,l=0;l<e.length;l++)if(s(e[l]).hasClass("selected")){o=l;break}s(n[o]).addClass("pstory-selected-index"),s.each(n,function(t,r){var n=t;s(r).attr("pstory-id",s(e[n]).attr("pstory-id"))})}}},this.updateIndex=function(t){var e=t.currentTarget,r=s(e).attr("pstory-id"),n=this.elementWrapper.find(".carousel-index-wrapper"),i=n.find(".carousel-index-dot");this.params&&this.params.updateDotsForAccessibility&&this.params.updateDotsForAccessibility(n,r),i.removeClass("pstory-selected-index"),i.filter('[pstory-id="'+r+'"]').addClass("pstory-selected-index")}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PStoryPreview=e.story.PStory.extend({initialize:function(t){this.super=e.story.PStory.prototype,this.super.initialize.call(this,t),this.previewDialogId=t.dialogId,this.previewBlockIndex=t.blockIndex,this.mode=t.mode},renderDialogs:function(){var t=this,r=this.storyDef.dialogs,n=null;s.each(r,function(e,s){if(s.id==t.previewDialogId)return n=s,!1}),n&&this.pushDlg(n,e.bind(this,this.highlightBlock))},fireEvent:function(t,e){},highlightBlock:function(){this.frameEl.find(".pstory-dialog-frame").find(".pstory-block-frame").eq(this.previewBlockIndex).addClass("pstory-preview-block")}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r,n){this.Personetics=this.Personetics||{},this.Personetics.UI=this.Personetics.UI||{},this.Personetics.UI.Handlebars=this.Personetics.UI.Handlebars||{},this.Personetics.UI.Handlebars.templates=this.Personetics.UI.Handlebars.templates||{},this.Personetics.UI.Handlebars.templates["error-msg"]=r.template({1:function(t,e,s,r,n){return'class="mobile-err"'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'<div id="personetics-error-container" '+(null!=(i=s.if.call(o,null!=e?e.isMobileDevice:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n    <div class="personetics-error-img '+u(typeof(a=null!=(a=s.imgClass||(null!=e?e.imgClass:e))?a:l)===c?a.call(o,{name:"imgClass",hash:{},data:n}):a)+'"></div>\r\n    <div class="personetics-error-larg">'+u(typeof(a=null!=(a=s.textLarge||(null!=e?e.textLarge:e))?a:l)===c?a.call(o,{name:"textLarge",hash:{},data:n}):a)+'</div>\r\n    <div class="personetics-error-small">'+u(typeof(a=null!=(a=s.textSmall||(null!=e?e.textSmall:e))?a:l)===c?a.call(o,{name:"textSmall",hash:{},data:n}):a)+"</div>\r\n\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["flow-selector-tmpl"]=r.template({1:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'    <option value="'+c(typeof(i=null!=(i=s.key||n&&n.key)?i:o)===l?i.call(a,{name:"key",hash:{},data:n}):i)+'">'+c(typeof(i=null!=(i=s.name||(null!=e?e.name:e))?i:o)===l?i.call(a,{name:"name",hash:{},data:n}):i)+"</option>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<select id="flow-selector">\r\n'+(null!=(i=s.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"</select>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["no-filtered-insights-msg"]=r.template({1:function(t,e,s,r,n){return'class="mobile-msg"'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div id="personetics-no-insights-filter-container" '+(null!=(i=s.if.call(o,null!=e?e.isMobileDevice:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n    <div class="personetics-nothing-toshow-msg">'+t.escapeExpression("function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:s.helperMissing)?a.call(o,{name:"text",hash:{},data:n}):a)+"</div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["no-insights-message"]=r.template({1:function(t,e,s,r,n){return'class="mobile-err"'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'<div id="personetics-no-insights-container" '+(null!=(i=s.if.call(o,null!=e?e.isMobileDevice:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n    <div class="personetics-no-insights-img '+u(typeof(a=null!=(a=s.imgClass||(null!=e?e.imgClass:e))?a:l)===c?a.call(o,{name:"imgClass",hash:{},data:n}):a)+'"></div>\r\n    <div class="personetics-no-insights-small">'+u(typeof(a=null!=(a=s.textSmall||(null!=e?e.textSmall:e))?a:l)===c?a.call(o,{name:"textSmall",hash:{},data:n}):a)+'</div>\r\n    <div class="personetics-no-insights-larg">'+u(typeof(a=null!=(a=s.textLarge||(null!=e?e.textLarge:e))?a:l)===c?a.call(o,{name:"textLarge",hash:{},data:n}):a)+"</div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector"]=r.template({1:function(t,e,s,r,n){return'\t\t\t\t<div class="header-container">\r\n\t\t\t\t\t<input type="button" value="All accounts" class="pstory-header-button selected" data-all="true" pstory-id="all"/>\t\t\t\t\r\n\t\t\t\t\t<input type="button" value="Choose account" class="pstory-header-button" data-all="false"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div class="pstory-header-button on-select no-select" data-all="false" pstory-id="all"></div>\x3c!--pstory-id for first time--\x3e\r\n\t\t\t\t\t<div class="pstory-header-button on-select select" data-all="true"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="options-container show-all allAccounts">\r\n'},3:function(t,e,s,r,n){return'        \t\t<div class="options-container">\r\n'},5:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression,h=t.lambda;return'\t\t\t\t\t<div class="pstory-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'"  pstory-event="'+p(typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)===d?l.call(c,{name:"event",hash:{},data:n}):l)+'" role="'+p(h(null!=a[1]?a[1].role:a[1],e))+'">\r\n\t\t\t\t\t\t<div class="card card_'+p(typeof(l=null!=(l=s.typeImage||(null!=e?e.typeImage:e))?l:u)===d?l.call(c,{name:"typeImage",hash:{},data:n}):l)+" cards"+p(typeof(l=null!=(l=s.numCards||(null!=e?e.numCards:e))?l:u)===d?l.call(c,{name:"numCards",hash:{},data:n}):l)+'" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'">\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class="perso-card-img" ></div>\r\n\t\t\t\t\t\t\t<span class="perso-account-name">'+p(typeof(l=null!=(l=s.name||(null!=e?e.name:e))?l:u)===d?l.call(c,{name:"name",hash:{},data:n}):l)+"</span>\r\n"+(null!=(o=s.if.call(c,null!=e?e.number:e,{name:"if",hash:{},fn:t.program(8,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t <div id="pop-'+p(h(e,e))+'" class="pstory-button-txt-wrapper" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'"><span class="pstory-button-txt">'+(null!=(o=typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)===d?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</span></div>\t\t           \r\n\t\t\t\t\t</div>\r\n"},6:function(t,e,s,r,n){return"selected"},8:function(t,e,s,r,n){var i;return'\t\t\t\t\t\t\t<span class="perso-account-number">Account No. '+t.escapeExpression("function"==typeof(i=null!=(i=s.number||(null!=e?e.number:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"number",hash:{},data:n}):i)+"</span>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'<div id="pstory-block-account-selector" class="pstory-block-frame pstory-block-account-selector '+p(typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)===d?l.call(c,{name:"class",hash:{},data:n}):l)+'"  data-show-header-tabs='+p(typeof(l=null!=(l=s.showHeaderTabs||(null!=e?e.showHeaderTabs:e))?l:u)===d?l.call(c,{name:"showHeaderTabs",hash:{},data:n}):l)+'>\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(o=s.if.call(c,null!=e?e.showHeaderTabs:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+'\t        \t<div class="cards-wrapper">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(5,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t        \t</div>\r\n\t\t\t\t<div class="pstory-all-accounts-txt">'+(null!=(o=typeof(l=null!=(l=s.allAccountsTxt||(null!=e?e.allAccountsTxt:e))?l:u)===d?l.call(c,{name:"allAccountsTxt",hash:{},data:n}):l)?o:"")+'</div>\r\n            </div>\r\n            <div class="pstory-comment">'+(null!=(o=typeof(l=null!=(l=s.comment||(null!=e?e.comment:e))?l:u)===d?l.call(c,{name:"comment",hash:{},data:n}):l)?o:"")+"</div>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-bar-chart-collapse"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'<div class="pstory-block-frame pstory-block-bar-chart-collapse pstory-inner-'+c(typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:o)===l?i.call(a,{name:"class",hash:{},data:n}):i)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-button-collapse">\r\n            \t<div class="pstory-inner-title">\r\n            \t\t'+c(typeof(i=null!=(i=s.txt||(null!=e?e.txt:e))?i:o)===l?i.call(a,{name:"txt",hash:{},data:n}):i)+'\r\n        \t\t</div>\r\n        \t\t<div class="pstory-button-collapse-icon"></div>\r\n        \t</div>\r\n            <div class="pstory-bar-chart-collapse-content">\r\n           \t\t<div class="image"></div>\r\n       \t\t</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-bar-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'<div class="pstory-block-frame pstory-block-bar-chart pstory-block-bar-chart '+c(typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:o)===l?i.call(a,{name:"class",hash:{},data:n}):i)+" "+c(typeof(i=null!=(i=s.direction||(null!=e?e.direction:e))?i:o)===l?i.call(a,{name:"direction",hash:{},data:n}):i)+'">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-bar-chart"></div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-buttons"]=r.template({1:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.navigateTarget:e,{name:"if",hash:{},fn:t.program(2,n,0,i,a),inverse:t.program(4,n,0,i,a),data:n}))?o:""},2:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'\t\t    <a href="#!" class="pstory-link-navigateTo pstory-button ripple-closed" pnavigate-id="'+t.escapeExpression(typeof(a=null!=(a=s.navigateTarget||(null!=e?e.navigateTarget:e))?a:l)===c?a.call(o,{name:"navigateTarget",hash:{},data:n}):a)+'" >'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"</a>\r\n"},4:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.toggleState:e,{name:"if",hash:{},fn:t.program(5,n,0,i,a),inverse:t.program(8,n,0,i,a),data:n}))?o:""},5:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'\t\t                <input type="button" class="pstory-button pstory-toggle-button '+u(typeof(a=null!=(a=s.toggleState||(null!=e?e.toggleState:e))?a:l)===c?a.call(o,{name:"toggleState",hash:{},data:n}):a)+" "+(null!=(i=s.if.call(o,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0),inverse:t.noop,data:n}))?i:"")+'" value="'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-type-text="Toggle '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-id="'+u(typeof(a=null!=(a=s.toggleState||(null!=e?e.toggleState:e))?a:l)===c?a.call(o,{name:"toggleState",hash:{},data:n}):a)+'"/>\r\n'},6:function(t,e,s,r,n){return"selected"},8:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=a[1]?a[1].typeRadio:a[1],{name:"if",hash:{},fn:t.program(9,n,0,i,a),inverse:t.program(12,n,0,i,a),data:n}))?o:""},9:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'                                <div class="pstory-button pstory-radio-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'  ripple-closed" tabindex="0" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'"  pstory-event="'+p(typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)===d?l.call(c,{name:"event",hash:{},data:n}):l)+'">\r\n                                    <input id="pstory-radio-'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" name="radio-'+p(t.lambda(null!=a[1]?a[1].id:a[1],e))+'" type="radio" '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(10,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'/>\r\n                                    <label for="pstory-radio-'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" role="text">'+(null!=(o=typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)===d?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</label>\r\n                                </div>\r\n"},10:function(t,e,s,r,n){return"checked"},12:function(t,e,s,r,n){var i,a,o=t.escapeExpression,l=null!=e?e:t.nullContext||{},c=s.helperMissing,u="function";return'                                    <button id="pop-'+o(t.lambda(e,e))+'" class="pstory-button pstory-regular-button '+(null!=(i=s.if.call(l,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0),inverse:t.noop,data:n}))?i:"")+' ripple-closed" pstory-type-text="Button '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:c)===u?a.call(l,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-id="'+o(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:c)===u?a.call(l,{name:"id",hash:{},data:n}):a)+'" pstory-event="'+o(typeof(a=null!=(a=s.event||(null!=e?e.event:e))?a:c)===u?a.call(l,{name:"event",hash:{},data:n}):a)+'">\r\n                                        '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:c)===u?a.call(l,{name:"text",hash:{},data:n}):a)?i:"")+"\r\n                                    </button>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'<div id="pstory-block-buttons_'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" class="pstory-block-frame pstory-block-buttons '+p(typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)===d?l.call(c,{name:"class",hash:{},data:n}):l)+'">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(1,n,0,i,a),inverse:t.noop,data:n}))?o:"")+"        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-compare-block"]=r.template({1:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'                        <div class="perso-compare" role="text">\r\n                            <div class="perso-compare-text label">'+(null!=(i=typeof(a=null!=(a=s.label1||(null!=e?e.label1:e))?a:l)===c?a.call(o,{name:"label1",hash:{},data:n}):a)?i:"")+'</div>\r\n                            <div class="perso-compare-text value">'+(null!=(i=typeof(a=null!=(a=s.label2||(null!=e?e.label2:e))?a:l)===c?a.call(o,{name:"label2",hash:{},data:n}):a)?i:"")+'</div>\r\n                        </div>\r\n                <div id="'+(null!=(i=typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)?i:"")+'_wrapper" class="perso-compare-bar-wrapper">\r\n                    <div id="'+(null!=(i=typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)?i:"")+'" class="perso-compare-bar"></div>\r\n                </div>\r\n\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div class="pstory-block-frame pstory-block-compareBlock '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:s.helperMissing)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n            <div class="perso-compareBlock-wrapper" role="text">\r\n'+(null!=(i=s.each.call(o,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-date-box"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'<div class="pstory-block-frame pstory-block-date-box '+c(typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:o)===l?i.call(a,{name:"class",hash:{},data:n}):i)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content" tabindex="0">\r\n            <div class="pstory-block-date-month">'+c(typeof(i=null!=(i=s.month||(null!=e?e.month:e))?i:o)===l?i.call(a,{name:"month",hash:{},data:n}):i)+'</div>\r\n            <div class="pstory-block-date-day">'+c(typeof(i=null!=(i=s.day||(null!=e?e.day:e))?i:o)===l?i.call(a,{name:"day",hash:{},data:n}):i)+"</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-hbox-columns"]=r.template({1:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'        <div class="pstory-hbox-column-frame '+c(typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:o)===l?i.call(a,{name:"class",hash:{},data:n}):i)+'" data-v-align="'+c(typeof(i=null!=(i=s["v-align"]||(null!=e?e["v-align"]:e))?i:o)===l?i.call(a,{name:"v-align",hash:{},data:n}):i)+'" data-width="'+c(typeof(i=null!=(i=s.width||(null!=e?e.width:e))?i:o)===l?i.call(a,{name:"width",hash:{},data:n}):i)+'" >\r\n            <div class="pstory-hbox-blocks-container"></div>\r\n        </div>\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div class="pstory-block-hbox-columns-frame '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:s.helperMissing)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n'+(null!=(i=s.each.call(o,null!=e?e.columns:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-hbox"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="pstory-block-frame pstory-block-hbox">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n            <div class="hbox-block-content"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-image"]=r.template({1:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'            <div class="pstory-block-content" id="'+c(typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:o)===l?i.call(a,{name:"id",hash:{},data:n}):i)+'" style="background-image:url(\''+c(typeof(i=null!=(i=s.url||(null!=e?e.url:e))?i:o)===l?i.call(a,{name:"url",hash:{},data:n}):i)+"')\"></div>\r\n"},3:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'            <div class="pstory-block-content perso-image perso-'+c(typeof(i=null!=(i=s.url||(null!=e?e.url:e))?i:o)===l?i.call(a,{name:"url",hash:{},data:n}):i)+'" id="'+c(typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:o)===l?i.call(a,{name:"id",hash:{},data:n}):i)+'"></div>\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div class="pstory-block-frame pstory-block-image '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:s.helperMissing)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n'+(null!=(i=s.if.call(o,null!=e?e.isAbsoluteURL:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-layout"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-layout">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n            <div class="layout-block-content" id="'+t.escapeExpression("function"==typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"id",hash:{},data:n}):i)+'"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-line-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-line-chart pstory-block-line-chart '+t.escapeExpression("function"==typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"class",hash:{},data:n}):i)+'">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-line-chart"></div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-map"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="pstory-block-frame pstory-block-map">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-map-frame"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-pie-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="pstory-block-frame pstory-block-pie-chart">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-pie-chart"></div>\r\n            <div class="pstory-pie-data">\r\n                <div class="pstory-next-arrow"></div>\r\n                <div class="pstory-pie-info">\r\n                </div>\r\n                <div class="pstory-previous-arrow"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-pinGraph-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-pinGraph-chart_'+t.escapeExpression("function"==typeof(i=null!=(i=s.index||(null!=e?e.index:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"index",hash:{},data:n}):i)+' pstory-block-pinGraph-chart">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-pinGraph-chart"></div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-selectOne"]=r.template({1:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'\t            <div class="pstory-selectOne-wrapper">\r\n\t\t            <span class="pstory-selectOne" pstory-id="'+c(typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:o)===l?i.call(a,{name:"id",hash:{},data:n}):i)+'"\r\n\t\t                   pstory-event="'+c(typeof(i=null!=(i=s.event||(null!=e?e.event:e))?i:o)===l?i.call(a,{name:"event",hash:{},data:n}):i)+'">'+c(typeof(i=null!=(i=s.txt||(null!=e?e.txt:e))?i:o)===l?i.call(a,{name:"txt",hash:{},data:n}):i)+'</span>\r\n                    <input type="button" class="pstory-button pstory-selectOne-icon" pstory-id="'+c(typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:o)===l?i.call(a,{name:"id",hash:{},data:n}):i)+'"\r\n\t\t                   pstory-event="'+c(typeof(i=null!=(i=s.event||(null!=e?e.event:e))?i:o)===l?i.call(a,{name:"event",hash:{},data:n}):i)+'"/>\r\n\t            </div>\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-selectOne">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(i=s.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-spline-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="pstory-block-frame pstory-block-spline-chart">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-spline-chart"></div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.twoCols:e,{name:"if",hash:{},fn:t.program(4,n,0,i,a),inverse:t.program(10,n,0,i,a),data:n}))?o:""},4:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{};return(null!=(i=s.if.call(a,null!=e?e.showHeaders:e,{name:"if",hash:{},fn:t.program(5,n,0),inverse:t.noop,data:n}))?i:"")+(null!=(i=s.each.call(a,null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(8,n,0),inverse:t.noop,data:n}))?i:"")},5:function(t,e,s,r,n){var i;return"                            <tr>\r\n"+(null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.displayedCols:e,{name:"each",hash:{},fn:t.program(6,n,0),inverse:t.noop,data:n}))?i:"")+"                            </tr>\r\n"},6:function(t,e,s,r,n){var i;return'                                    <th role="cell">'+(null!=(i=t.lambda(e,e))?i:"")+"</th>\r\n"},8:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td class="perso-td-first" role="cell">'+(null!=(i=a(null!=e?e[0]:e,e))?i:"")+'</td>\r\n                                <td align="right">\r\n                                    <span class="perso-td-second" role="cell">\r\n                                        '+(null!=(i=a(null!=e?e[1]:e,e))?i:"")+"\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n"},10:function(t,e,s,r,n,i,a){var o,l=null!=e?e:t.nullContext||{};return(null!=(o=s.if.call(l,null!=e?e.showHeaders:e,{name:"if",hash:{},fn:t.program(11,n,0,i,a),inverse:t.noop,data:n}))?o:"")+(null!=(o=s.each.call(l,null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(16,n,0,i,a),inverse:t.noop,data:n}))?o:"")},11:function(t,e,s,r,n){var i;return'                            <tr>\r\n                                <th role="cell">'+t.escapeExpression(t.lambda(null!=(i=null!=e?e.displayedCols:e)?i[1]:i,e))+"</th>                           \r\n"+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.fourCols:e,{name:"if",hash:{},fn:t.program(12,n,0),inverse:t.program(14,n,0),data:n}))?i:"")+"                            </tr>\r\n"},12:function(t,e,s,r,n){var i;return'                                <th align="right" role="cell">'+t.escapeExpression(t.lambda(null!=(i=null!=e?e.displayedCols:e)?i[3]:i,e))+"</th>\r\n"},14:function(t,e,s,r,n){var i;return'                                    <th align="right" role="cell">'+t.escapeExpression(t.lambda(null!=(i=null!=e?e.displayedCols:e)?i[2]:i,e))+"</th>\r\n"},16:function(t,e,s,r,n,i,a){var o,l=t.lambda,c=null!=e?e:t.nullContext||{};return'                            <tr>\r\n                                <td>\r\n                                    <span class="perso-td-date" role="cell">\r\n                                        '+(null!=(o=l(null!=e?e[0]:e,e))?o:"")+'\r\n                                        </span>\r\n                                    <span class="perso-td-first" role="cell">\r\n                                        '+(null!=(o=l(null!=e?e[1]:e,e))?o:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td align="right">\r\n                                    <span class="perso-td-second" role="cell">\r\n                                        '+(null!=(o=l(null!=e?e[2]:e,e))?o:"")+"\r\n                                    </span>\r\n"+(null!=(o=s.if.call(c,null!=a[1]?a[1].fourCols:a[1],{name:"if",hash:{},fn:t.program(17,n,0,i,a),inverse:t.noop,data:n}))?o:"")+"                                </td>\r\n"+(null!=(o=s.if.call(c,null!=a[1]?a[1].fourCols:a[1],{name:"if",hash:{},fn:t.program(19,n,0,i,a),inverse:t.noop,data:n}))?o:"")+"                            </tr>\r\n"},17:function(t,e,s,r,n){var i;return'                                        <span class="perso-td-last" role="cell">\r\n                                            '+(null!=(i=t.lambda(null!=e?e[3]:e,e))?i:"")+"\r\n                                        </span>\r\n"},19:function(t,e,s,r,n){var i;return'                                    \x3c!--<td align="right">\r\n                                        <span class="perso-td-last" role="cell">\r\n                                            '+(null!=(i=t.lambda(null!=e?e[3]:e,e))?i:"")+"\r\n                                        </span>\r\n                                    </td>--\x3e\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table">\r\n'+(null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-tabs"]=r.template({1:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'            \r\n                <input type="button" class="pstory-tab pstory-button '+(null!=(i=s.if.call(o,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?i:"")+'" value="'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-id="'+t.escapeExpression(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'" />\r\n            '},2:function(t,e,s,r,n){return"selected"},4:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'                    <li  class="pstory-tab pstory-button '+(null!=(i=s.if.call(o,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?i:"")+'" aria-selected="'+u(typeof(a=null!=(a=s.selected||(null!=e?e.selected:e))?a:l)===c?a.call(o,{name:"selected",hash:{},data:n}):a)+'" role="tab" tabindex="'+u(typeof(a=null!=(a=s.index||n&&n.index)?a:l)===c?a.call(o,{name:"index",hash:{},data:n}):a)+'" pstory-id="'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'">'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"</li>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'<div id="pstory-block-tabs_'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'" class="pstory-block-frame pstory-block-tabs '+u(typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:l)===c?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            \x3c!--'+(null!=(i=s.each.call(o,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'--\x3e\r\n            <div class="pstory-tab-animated-border-bottom"></div>            \r\n            <ul class="tablist" role="tablist">\r\n'+(null!=(i=s.each.call(o,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:"")+"            </ul>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-textboxes"]=r.template({1:function(t,e,s,r,n){return"with-image"},3:function(t,e,s,r,n){var i;return null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.image:e,{name:"if",hash:{},fn:t.program(4,n,0),inverse:t.program(6,n,0),data:n}))?i:""},4:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'                       <div class="perso-textbox-with-image" role="text">\r\n                           <div class="perso-textbox-image '+(null!=(i=typeof(a=null!=(a=s.image||(null!=e?e.image:e))?a:l)===c?a.call(o,{name:"image",hash:{},data:n}):a)?i:"")+'"></div>\r\n                           <div class="perso-value">'+(null!=(i=typeof(a=null!=(a=s.value||(null!=e?e.value:e))?a:l)===c?a.call(o,{name:"value",hash:{},data:n}):a)?i:"")+'</div>\r\n                           <div class="perso-label">'+(null!=(i=typeof(a=null!=(a=s.label||(null!=e?e.label:e))?a:l)===c?a.call(o,{name:"label",hash:{},data:n}):a)?i:"")+"</div>\r\n                       </div>\r\n"},6:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'                       <div class="perso-textbox" role="text">\r\n                           <div class="perso-value">'+(null!=(i="function"==typeof(a=null!=(a=s.value||(null!=e?e.value:e))?a:l)?a.call(o,{name:"value",hash:{},data:n}):a)?i:"")+'</div>\r\n                           <div class="perso-label">'+(null!=(i="function"==typeof(a=null!=(a=s.label||(null!=e?e.label:e))?a:l)?a.call(o,{name:"label",hash:{},data:n}):a)?i:"")+"</div>\r\n                       </div>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div class="pstory-block-frame pstory-block-textboxes '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:s.helperMissing)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n           <div class="perso-textboxes-wrapper '+(null!=(i=s.if.call(o,null!=e?e.hasImage:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'" role="text">\r\n'+(null!=(i=s.each.call(o,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?i:"")+"           </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-txt-note"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'<div class="pstory-block-frame pstory-block-text '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:l)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-block-note-icon"></div>\r\n            <div class="pstory-block-note-txt" role="text">\r\n                '+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-txt"]=r.template({1:function(t,e,s,r,n){return'        <div class="pstory-block-content" aria-level="2" role="heading">\r\n'},3:function(t,e,s,r,n){return'        <div class="pstory-block-content" role="text">\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'<div class="pstory-block-frame pstory-block-text '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:l)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n'+(null!=(i=s.if.call(o,null!=e?e.needAccessibility:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            "+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-frame"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'<div class="pstory-frame '+c(typeof(i=null!=(i=s.langClass||(null!=e?e.langClass:e))?i:o)===l?i.call(a,{name:"langClass",hash:{},data:n}):i)+" "+c(typeof(i=null!=(i=s.directionClass||(null!=e?e.directionClass:e))?i:o)===l?i.call(a,{name:"directionClass",hash:{},data:n}):i)+" "+c(typeof(i=null!=(i=s.cssClass||(null!=e?e.cssClass:e))?i:o)===l?i.call(a,{name:"cssClass",hash:{},data:n}):i)+'" data-id="pstory-frame_'+c(typeof(i=null!=(i=s.storyId||(null!=e?e.storyId:e))?i:o)===l?i.call(a,{name:"storyId",hash:{},data:n}):i)+'">\r\n    <div class="pstory-container"></div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-post"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="post-frame">\r\n    <div class="post-container">\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-rating"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return"<div class=\"perso-ratings-wrapper\">\r\n   <div class='perso-ratings-text'>"+t.escapeExpression("function"==typeof(i=null!=(i=s.ratingTitle||(null!=e?e.ratingTitle:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"ratingTitle",hash:{},data:n}):i)+"</div>\r\n   <div class='perso-ratings-icons' data-rating-max='5'></div>\r\n</div>\r\n\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-teasers"]=r.template({1:function(t,e,s,r,n){var i,a,o=t.escapeExpression;return'<div class="perso-teaser" id="'+o("function"==typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"id",hash:{},data:n}):a)+'">'+o(t.lambda(null!=(i=null!=e?e.teaser:e)?i.title:i,e))+"</div>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.posts:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:""},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pfeed"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div>\r\n    <div class="perso-header">\r\n        Feed by \x3c!--<img src="resources/images/perso-logo.png" class="perso-logo">--\x3e\r\n        <svg  xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="187" height="37" viewBox="0 0 187 37">\r\n            <image width="187" height="37" preserveAspectRatio="none" id="image10" x="0" y="0"\r\n                    xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALsAAAAlCAYAAAAa/JhZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRCQjk1MzY1QkU4NjExRTU4OTQzRThGMDA3MzBBMTYxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRCQjk1MzY2QkU4NjExRTU4OTQzRThGMDA3MzBBMTYxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEJCOTUzNjNCRTg2MTFFNTg5NDNFOEYwMDczMEExNjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEJCOTUzNjRCRTg2MTFFNTg5NDNFOEYwMDczMEExNjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5K1DUkAAAMWElEQVR42uxcTXLruBGGX7x/yjqVMl05gOVdMrMwdQLLJ7B8AlknkHUCWScQfQLLJxC9mEl2pg+QMl9+1o/ZT8oBlK+tVhsNgpRdzzNPqGJJokigu/Hh60YD5J7ZlV0JlIM//HFpP1JxOv/y73/2PqrMfzpIXuT95Zf/FlbWyn3f33XndwfexH4k4nRlAVH8BnTr2o+5BXi+v/+7O/vp9Bzb8zdWv2wH9u+vDBwAJFPbo/crB3rHAd2CfGRBPraHA/69PS6cvpbtyx3Yv30HuU55cbW7stUgnuF7akHfs4Af2u9TB3j7fb4D+7d1uS4e7uD3wgL+7AOKOiIZedjzAeV0MmYgDxerjxGuuRCmsvZ93A91gGMcKFba4xETk6JBh7qJwikJALeS2TrKNwZOiknUCWS+t20sfi1AR+k7PazceQOdu6KvCs22LFY/8AEF9fli+KoN2KFjl80PKiZj7P0J6qB7yxB2LJt32c8bsDrh4GiPVd53MY9HMVlKVHStCW3rorgw8fzt7hm5CcMbTbbmnmyBM8qhYsCU6ehkWbz14IsIXR4U2zgiuKi599Iew0A/ucEykYPG3nvlidW18pJtUe5z9V8F5DtX9HvRE3WUnjr6AKl2fwH8ZRx/DAvOE02d/PbcJezkrqs+MYVuI4BuIIRT/gmCGY9R5wFhVxMJDIht2fHBA/SVjCSb6wDXlj2ecP0U8o/x/QGd9G7ZD1H/OGCbfoS+45p+cvZY2uun38hbjWuATvH1g8QAwHlbc38X/faENlcFA4fYfITTjtU/O1Z35LqHRp630HNjlNu6vkYOGjfajgNudwDBO/AmZ+RalTCA1+tkusZ1txHGv4j1NKizj3AgQXv3kmlYqHHLdFiA+ULlWIaKYK2HSLtuxNvODu/N7DX9EcSAref3zFbLBvdq3jvBYKLQJv/7l3Ll5fbxpwm4xA6LuX3F5TFdwxkElgo7Y9/B9fYFw4+RGvKVc1ZXAuD3agy7AHArxoS1RoNrjAH6AF7Lx8jODj0B1KXwiJeegdnxMLOUZx7Q9xEDr++5ZoqJ73uHaaHwl+Z9qUd3nu48DehnMB9LxcT5VYGuV96YPjQa+SoZwoKhEjZMEYf5yg0AkCOUSIRLii1pDdDdHIIb4FZh/QJMTBOeIgLkxBbjmmzArb32uEEa8cwTPh4ok++gN7LXjWAbadMhGN4B4Eph6tYroiCArgLUEQ00Fs+PCejC9l1Fx8rTD0dtEhD7rkHXQXUsiMoXCrvJ2Ty/rxAGuGwJdhMAus+tJorx2mRplp76KgZyzt79wMCXk1FHAIUAc9fj4Xz6ZsLOFQO89Dqjd2T1oRIGnUn5MNgWHlxoxcX1EyQRqhBrx5RPDRomoTPF7acICXyza36NDCG0rIPGnj7QXEVcZ8C8c9/EuobVE4/ch3DDVQQ4vRkp5uZlAsAEbLa635GLPJS0YFITqm6bWfIR1iSAn0LBW6EkQxyxfrVt3SLR0DqZsC/i87SmcSp3PiXdyLPC+GJ6ykLIe24UAy4jWb9UWKtQ4mHKBAwgUwG978FGlTL7fxV+4FrnFTPhrVI2SLQyY2091oA9UcLGJiXRiGXL0lUAnbdJdKBvOoFMVR/zkJkv9RnF7AH2UQd14L/CY5Bbj2FeMXJDoL+K6YTLPAaQ6zqL0l0v7FHXoYKZ7gMA0+x6HfJu78XEH7mgz3oRyYIOCHS+DdjTBq6rr7CsiQBYCZBeKLP6WKDnIQZxXgaTrh5i6JhJ42phzU2keQ43gjWbFM7qGgvW1UkeKfZ4r+X9MhD6tQG8C3GOkaGrm1sNmq7VtNkbo6WZqNNmRs8lv+R9PQaai0FUmnBeehJpQOrwC7aCSmmsTgDAbmHmMMJznTSYX0hW53V2hTfJlfCSBkxmvnFB2OoLF4ehSbEbDKF0KHTL2JzvRAlxziOTAbVhjBSwi438fYVlSzJAAIjncoKBFcYHwxYC2AROCxHKBntIpjSxAXO4FOUZFjPOAqzfUbxdV6QF+8qg96bjlHmB7Pijmrh4qnkeTFaXDTzTq4HZkJl9YLvEaqjx9PUSWZaujBjgUaccIy57hpTy4baDM8TsaeTKamXEwpCLxe29BwLA1HFPmNT9B53aVzzAImD0RSTQB8wzzJH2umfsXNVkbxIlpqZB4Mvl3wTmNRoJ3As7DMCYXUW2DjxPhmQBnTtlNnf/x6ZauyCciukcm3efKazrQDtk9pB9vRSLcLTN4BKDhXQrIVe/4bzyVdljnbdsOWDUpXaEJoOG9W1shlK2H/RimF15pKxJITZ5ahDDHiPnLRfQ1IWbBqu9bcqGrSL7uul2gYHxryzHEOUhBvXyLbG3VRjTpjGA9qLBCBx5Jq7FFqmtYkvdaEtp1uCeSpmoB3PPNbJWsXMUD3HkHtu96YQVGLhoceuI2aupTEXTeUtbsBODZZGGOKzJiKyuUSavsy06Z9LiXpKF6zYy4Tx1BaDnou0cIF5EDNBJDSgck8akU+syXsb4F8Nahwesn5vI1yMbwzaHsEEZ2UeNtzeEwpjS0/DWD0bIbQWR4Qi5OdfuTdNFC/Ggw5EIi5yOX+pSmYG985lR9ma3sE3fbC6+LZB5yT326Ht0ie4fTAIHqCMBwB/BmAthu9QT5uQ1/eWT7x4Dv4jor9Ssd5ZSPz2aLZ4/2IuNy3ZlA/RJw3BqVz5A2T2D2txdl+Z9lt535Z3Lp50JdmUH9l3Zld8o2IudKXblewH77gU9u/LdTFCjmf2HH/7s0kryecHHn3/+2wL/0XOlNIAoBUV5ZLcXe5WCMv9fbqcctkvr3Zn1VgBXzyN+u/QVPRLo6nW591zIQO1QuUG9CdqkJ2cSs16aLs06t8uvc0vWn0X9lO+fQq6M/cf1kIVkp+K2SfD1BJ/NUtzDZSbZpF3mrG2So8L3CyYTl1GzAS/cBl+YvtI29J88fwdc8b4rYceC6T6EHIVZr4uE9DdM7wmra+Mai0c/s2MVK4/EewJhBlAwZSAb4zffx3Bk1nlauocDNGH/8R2VvF7a4z5hHZkIufjzsbT8npj1o3Ik+wPrYNprb8R1tCvyCudSs37wfGBep2n7Rt+W2zWbj5LRK9lMwGYn+D32yMbtMjWbOXCSg3Z3zj3/hWzAC393y5TJor3ThZ/nzwpP0faEDTrSacnkoN91+hNWUkEi8hqV2Q3YNhUgfVUcgztWsSy+6iT7uwfGp33u1xAiE7cSmOv2Ko/N5vZQ6iRa9ctNzQuC2AAZmvVGKQJawa45M/6nfohBniFLzjp0YdZPzTRZXJswVkrYd81mFYjhRqmPtkT3jJ4K7XrkjLUBececDbKJ57x2/bNZvxGsRJsFA6iUw31/YoAN6X/OvMkoNgzn2ZiMCVq2CIn6EHhmNl97RkafQ6hFDSAuzea21iOz+ZhdauK2EOTm9fZYvk+cWG7WUEcKtU4b2meJY8DaDNmMHtDwAfES9dTtqZmY9bt32tigy7xOKVic68NBOAZ705scRqjjKzBw75HDsOuPavRPmJcv69jcC3b2ZI/bo3Dc4iWb5xAw8QjRYTFp6HUUBVhOY5qUGXO45XyFOiZ2Z2Rq1svqjYzMgDfBQBlH2MwwoJwo3ietkeMa8g5b2oD+L4S3vWH65MoAOUbbtLPxjA36JNJmPv3JZl18RpPOp+fnZ8OP8l//KO1RyfPyoOK+2xAmYWAYewycw3OMWJwfAkWXXXPH6l6YuOcUCZzyujvGRBPTbDPROQA5FnOQ2JLjuGH6hGxGHvbavH59xDVscW3q3885Evc3scEI/8udq/yxwFIMgjOWcODh1kJMOO+E/cgedzX6D1i429HmSz7MvtV2gZWb++mnv64M9+OPf0kQf8kwYgEDzY3+5Ak9pTRnhs3ACBkzykwBOLFLF52UiFDtHHXlLLtTRrANvX8lY514yn5PGSBmnnBtzOrJWWjQY53tsxk9dZ8oxDBA2xeBQZYxkIRs0GTgnyjZJRokSxaqOPkOGAHl+ORyDCCbZGuuP4V6h0zeJxYOkudwGHQfFxaTpW+C2rTcmfVrIHLOoq4B2xilufh1Bp3SZ0YpPN8zjNpc3HOEug49nTMT8R61z9/RQk+w07saiYkqcZ3xyDQRE8gZA+BIpN1KwYJXgv0ylm7j92g2O2MDecbqr/BfR7En16Nkcx/NBpru8vxn5XzB8EDeYII4/QR6ZUpfjBhBaPqXIp3KdSs9HnBDp/8JMAAoWRW8rHmVTQAAAABJRU5ErkJggg=="/>\r\n        </svg>\r\n    </div>\r\n    <div class="perso-main">\r\n        <div class="nano perso-container">\r\n            <div class="nano-content perso-scroll">\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="perso-footer">\r\n        <div class="footer-button">Close</div>\r\n    </div>\r\n</div>\r\n'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pslide"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="'+t.escapeExpression("function"==typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:s.helperMissing)?i.call(null!=e?e:t.nullContext||{},{name:"class",hash:{},data:n}):i)+'">\r\n    <div class="perso-header">\r\n        <sup><sup>Feed by </sup>\x3c!--<img src="resources/images/perso-logo.png" class="perso-logo">--\x3e\r\n            <svg  xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="187" height="37" viewBox="0 0 187 37">\r\n                <image width="187" height="37" preserveAspectRatio="none" id="image10" x="0" y="0"\r\n                       xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALsAAAAlCAYAAAAa/JhZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRCQjk1MzY1QkU4NjExRTU4OTQzRThGMDA3MzBBMTYxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRCQjk1MzY2QkU4NjExRTU4OTQzRThGMDA3MzBBMTYxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEJCOTUzNjNCRTg2MTFFNTg5NDNFOEYwMDczMEExNjEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEJCOTUzNjRCRTg2MTFFNTg5NDNFOEYwMDczMEExNjEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5K1DUkAAAMWElEQVR42uxcTXLruBGGX7x/yjqVMl05gOVdMrMwdQLLJ7B8AlknkHUCWScQfQLLJxC9mEl2pg+QMl9+1o/ZT8oBlK+tVhsNgpRdzzNPqGJJokigu/Hh60YD5J7ZlV0JlIM//HFpP1JxOv/y73/2PqrMfzpIXuT95Zf/FlbWyn3f33XndwfexH4k4nRlAVH8BnTr2o+5BXi+v/+7O/vp9Bzb8zdWv2wH9u+vDBwAJFPbo/crB3rHAd2CfGRBPraHA/69PS6cvpbtyx3Yv30HuU55cbW7stUgnuF7akHfs4Af2u9TB3j7fb4D+7d1uS4e7uD3wgL+7AOKOiIZedjzAeV0MmYgDxerjxGuuRCmsvZ93A91gGMcKFba4xETk6JBh7qJwikJALeS2TrKNwZOiknUCWS+t20sfi1AR+k7PazceQOdu6KvCs22LFY/8AEF9fli+KoN2KFjl80PKiZj7P0J6qB7yxB2LJt32c8bsDrh4GiPVd53MY9HMVlKVHStCW3rorgw8fzt7hm5CcMbTbbmnmyBM8qhYsCU6ehkWbz14IsIXR4U2zgiuKi599Iew0A/ucEykYPG3nvlidW18pJtUe5z9V8F5DtX9HvRE3WUnjr6AKl2fwH8ZRx/DAvOE02d/PbcJezkrqs+MYVuI4BuIIRT/gmCGY9R5wFhVxMJDIht2fHBA/SVjCSb6wDXlj2ecP0U8o/x/QGd9G7ZD1H/OGCbfoS+45p+cvZY2uun38hbjWuATvH1g8QAwHlbc38X/faENlcFA4fYfITTjtU/O1Z35LqHRp630HNjlNu6vkYOGjfajgNudwDBO/AmZ+RalTCA1+tkusZ1txHGv4j1NKizj3AgQXv3kmlYqHHLdFiA+ULlWIaKYK2HSLtuxNvODu/N7DX9EcSAref3zFbLBvdq3jvBYKLQJv/7l3Ll5fbxpwm4xA6LuX3F5TFdwxkElgo7Y9/B9fYFw4+RGvKVc1ZXAuD3agy7AHArxoS1RoNrjAH6AF7Lx8jODj0B1KXwiJeegdnxMLOUZx7Q9xEDr++5ZoqJ73uHaaHwl+Z9qUd3nu48DehnMB9LxcT5VYGuV96YPjQa+SoZwoKhEjZMEYf5yg0AkCOUSIRLii1pDdDdHIIb4FZh/QJMTBOeIgLkxBbjmmzArb32uEEa8cwTPh4ok++gN7LXjWAbadMhGN4B4Eph6tYroiCArgLUEQ00Fs+PCejC9l1Fx8rTD0dtEhD7rkHXQXUsiMoXCrvJ2Ty/rxAGuGwJdhMAus+tJorx2mRplp76KgZyzt79wMCXk1FHAIUAc9fj4Xz6ZsLOFQO89Dqjd2T1oRIGnUn5MNgWHlxoxcX1EyQRqhBrx5RPDRomoTPF7acICXyza36NDCG0rIPGnj7QXEVcZ8C8c9/EuobVE4/ch3DDVQQ4vRkp5uZlAsAEbLa635GLPJS0YFITqm6bWfIR1iSAn0LBW6EkQxyxfrVt3SLR0DqZsC/i87SmcSp3PiXdyLPC+GJ6ykLIe24UAy4jWb9UWKtQ4mHKBAwgUwG978FGlTL7fxV+4FrnFTPhrVI2SLQyY2091oA9UcLGJiXRiGXL0lUAnbdJdKBvOoFMVR/zkJkv9RnF7AH2UQd14L/CY5Bbj2FeMXJDoL+K6YTLPAaQ6zqL0l0v7FHXoYKZ7gMA0+x6HfJu78XEH7mgz3oRyYIOCHS+DdjTBq6rr7CsiQBYCZBeKLP6WKDnIQZxXgaTrh5i6JhJ42phzU2keQ43gjWbFM7qGgvW1UkeKfZ4r+X9MhD6tQG8C3GOkaGrm1sNmq7VtNkbo6WZqNNmRs8lv+R9PQaai0FUmnBeehJpQOrwC7aCSmmsTgDAbmHmMMJznTSYX0hW53V2hTfJlfCSBkxmvnFB2OoLF4ehSbEbDKF0KHTL2JzvRAlxziOTAbVhjBSwi438fYVlSzJAAIjncoKBFcYHwxYC2AROCxHKBntIpjSxAXO4FOUZFjPOAqzfUbxdV6QF+8qg96bjlHmB7Pijmrh4qnkeTFaXDTzTq4HZkJl9YLvEaqjx9PUSWZaujBjgUaccIy57hpTy4baDM8TsaeTKamXEwpCLxe29BwLA1HFPmNT9B53aVzzAImD0RSTQB8wzzJH2umfsXNVkbxIlpqZB4Mvl3wTmNRoJ3As7DMCYXUW2DjxPhmQBnTtlNnf/x6ZauyCciukcm3efKazrQDtk9pB9vRSLcLTN4BKDhXQrIVe/4bzyVdljnbdsOWDUpXaEJoOG9W1shlK2H/RimF15pKxJITZ5ahDDHiPnLRfQ1IWbBqu9bcqGrSL7uul2gYHxryzHEOUhBvXyLbG3VRjTpjGA9qLBCBx5Jq7FFqmtYkvdaEtp1uCeSpmoB3PPNbJWsXMUD3HkHtu96YQVGLhoceuI2aupTEXTeUtbsBODZZGGOKzJiKyuUSavsy06Z9LiXpKF6zYy4Tx1BaDnou0cIF5EDNBJDSgck8akU+syXsb4F8Nahwesn5vI1yMbwzaHsEEZ2UeNtzeEwpjS0/DWD0bIbQWR4Qi5OdfuTdNFC/Ggw5EIi5yOX+pSmYG985lR9ma3sE3fbC6+LZB5yT326Ht0ie4fTAIHqCMBwB/BmAthu9QT5uQ1/eWT7x4Dv4jor9Ssd5ZSPz2aLZ4/2IuNy3ZlA/RJw3BqVz5A2T2D2txdl+Z9lt535Z3Lp50JdmUH9l3Zld8o2IudKXblewH77gU9u/LdTFCjmf2HH/7s0kryecHHn3/+2wL/0XOlNIAoBUV5ZLcXe5WCMv9fbqcctkvr3Zn1VgBXzyN+u/QVPRLo6nW591zIQO1QuUG9CdqkJ2cSs16aLs06t8uvc0vWn0X9lO+fQq6M/cf1kIVkp+K2SfD1BJ/NUtzDZSbZpF3mrG2So8L3CyYTl1GzAS/cBl+YvtI29J88fwdc8b4rYceC6T6EHIVZr4uE9DdM7wmra+Mai0c/s2MVK4/EewJhBlAwZSAb4zffx3Bk1nlauocDNGH/8R2VvF7a4z5hHZkIufjzsbT8npj1o3Ik+wPrYNprb8R1tCvyCudSs37wfGBep2n7Rt+W2zWbj5LRK9lMwGYn+D32yMbtMjWbOXCSg3Z3zj3/hWzAC393y5TJor3ThZ/nzwpP0faEDTrSacnkoN91+hNWUkEi8hqV2Q3YNhUgfVUcgztWsSy+6iT7uwfGp33u1xAiE7cSmOv2Ko/N5vZQ6iRa9ctNzQuC2AAZmvVGKQJawa45M/6nfohBniFLzjp0YdZPzTRZXJswVkrYd81mFYjhRqmPtkT3jJ4K7XrkjLUBececDbKJ57x2/bNZvxGsRJsFA6iUw31/YoAN6X/OvMkoNgzn2ZiMCVq2CIn6EHhmNl97RkafQ6hFDSAuzea21iOz+ZhdauK2EOTm9fZYvk+cWG7WUEcKtU4b2meJY8DaDNmMHtDwAfES9dTtqZmY9bt32tigy7xOKVic68NBOAZ705scRqjjKzBw75HDsOuPavRPmJcv69jcC3b2ZI/bo3Dc4iWb5xAw8QjRYTFp6HUUBVhOY5qUGXO45XyFOiZ2Z2Rq1svqjYzMgDfBQBlH2MwwoJwo3ietkeMa8g5b2oD+L4S3vWH65MoAOUbbtLPxjA36JNJmPv3JZl18RpPOp+fnZ8OP8l//KO1RyfPyoOK+2xAmYWAYewycw3OMWJwfAkWXXXPH6l6YuOcUCZzyujvGRBPTbDPROQA5FnOQ2JLjuGH6hGxGHvbavH59xDVscW3q3885Evc3scEI/8udq/yxwFIMgjOWcODh1kJMOO+E/cgedzX6D1i429HmSz7MvtV2gZWb++mnv64M9+OPf0kQf8kwYgEDzY3+5Ak9pTRnhs3ACBkzykwBOLFLF52UiFDtHHXlLLtTRrANvX8lY514yn5PGSBmnnBtzOrJWWjQY53tsxk9dZ8oxDBA2xeBQZYxkIRs0GTgnyjZJRokSxaqOPkOGAHl+ORyDCCbZGuuP4V6h0zeJxYOkudwGHQfFxaTpW+C2rTcmfVrIHLOoq4B2xilufh1Bp3SZ0YpPN8zjNpc3HOEug49nTMT8R61z9/RQk+w07saiYkqcZ3xyDQRE8gZA+BIpN1KwYJXgv0ylm7j92g2O2MDecbqr/BfR7En16Nkcx/NBpru8vxn5XzB8EDeYII4/QR6ZUpfjBhBaPqXIp3KdSs9HnBDp/8JMAAoWRW8rHmVTQAAAABJRU5ErkJggg=="/>\r\n            </svg>\r\n        </sup>\r\n    </div>\r\n    <div class="perso-main">\r\n        <div class="nano perso-container">\r\n            <div  class="nano-content perso-scroll"></div>\r\n        </div>\r\n    </div>\r\n    <div class="perso-footer"><div class="footer-button">Close</div></div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pstory-dialog-continue-btn"]=r.template({1:function(t,e,s,r,n){var i;return"        \t\t"+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.showBtn:e,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?i:"")+"\r\n"},2:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l=t.escapeExpression;return'<div class="pstory-dialog-btn" data-action="'+l("function"==typeof(i=null!=(i=s.actionBtn||(null!=e?e.actionBtn:e))?i:o)?i.call(a,{name:"actionBtn",hash:{},data:n}):i)+'">'+l("function"==typeof(i=null!=(i=s.diaogBtn||(null!=e?e.diaogBtn:e))?i:o)?i.call(a,{name:"diaogBtn",hash:{},data:n}):i)+"</div>"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c=t.escapeExpression;return'<div class="pstory-dialog-frame perso-dialog-actions-btn '+c("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:l)?a.call(o,{name:"class",hash:{},data:n}):a)+'" id="pdlg-'+c("function"==typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)?a.call(o,{name:"id",hash:{},data:n}):a)+'">\r\n    <div class="pstory-dialog-container">\r\n        <div class="pstory-dialog-content" ></div>\r\n        <div class="pstory-dialog-buttons" data-numOfDialogBtn="'+c(t.lambda(null!=(i=null!=e?e.btn:e)?i.length:i,e))+'">\r\n'+(null!=(i=s.each.call(o,null!=e?e.btn:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"\t\t</div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pstory-dialog"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l=t.escapeExpression;return'<div class="pstory-dialog-frame '+l("function"==typeof(i=null!=(i=s.class||(null!=e?e.class:e))?i:o)?i.call(a,{name:"class",hash:{},data:n}):i)+'" id="pdlg-'+l("function"==typeof(i=null!=(i=s.id||(null!=e?e.id:e))?i:o)?i.call(a,{name:"id",hash:{},data:n}):i)+'">\r\n    <div class="pstory-dialog-container">\r\n        <div class="pstory-dialog-content" />\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pstory-title-inside-story"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a;return'<div class="pstory-title-outer-wrapper">\r\n    <div class="pstory-fixed pstory-title-wrapper">\r\n        <div class="pstory-title">\r\n            <div class="pstory-title-text pstory-title-inside-story">'+(null!=(i="function"==typeof(a=null!=(a=s.title||(null!=e?e.title:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"title",hash:{},data:n}):a)?i:"")+"</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pstory-title"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a;return'<div class="pstory-title-outer-wrapper">\r\n    <div class="pstory-fixed pstory-title-wrapper">\r\n        <div class="pstory-title">\r\n            <div class="pstory-title-text">'+(null!=(i="function"==typeof(a=null!=(a=s.title||(null!=e?e.title:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"title",hash:{},data:n}):a)?i:"")+'</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="story-frame-container"></div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-widget-story-error"]=r.template({1:function(t,e,s,r,n){return'class="mobile-err"'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'<div id="personetics-error-container" '+(null!=(i=s.if.call(o,null!=e?e.isMobileDevice:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n    <div class="personetics-error-img '+t.escapeExpression(typeof(a=null!=(a=s.imgClass||(null!=e?e.imgClass:e))?a:l)===c?a.call(o,{name:"imgClass",hash:{},data:n}):a)+'"></div> \r\n    <div class="personetics-error-large">'+(null!=(i=typeof(a=null!=(a=s.textLarge||(null!=e?e.textLarge:e))?a:l)===c?a.call(o,{name:"textLarge",hash:{},data:n}):a)?i:"")+'</div>\r\n    <div class="personetics-error-small">'+(null!=(i=typeof(a=null!=(a=s.textSmall||(null!=e?e.textSmall:e))?a:l)===c?a.call(o,{name:"textSmall",hash:{},data:n}):a)?i:"")+"</div>\r\n   \r\n\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-loading-animation"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a;return"<div id='perso-loading-widget'>\r\n    <div class='perso-loading-text' >\r\n         "+(null!=(i="function"==typeof(a=null!=(a=s.loadingText||(null!=e?e.loadingText:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"loadingText",hash:{},data:n}):a)?i:"")+"\r\n    </div>\r\n    <div class='perso-loading'></div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector-accessibility"]=r.template({1:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c=t.escapeExpression,u=t.lambda;return'\t\t\t\t<div class="header-container">\r\n\t\t\t\t\t<div class="pstory-tab-animated-border-bottom"></div>\r\n\t\t\t\t\t<ul class="tablist" role="tablist">\r\n\t\t\t\t\t\t<li  class="pstory-header-button" role="tab" tabindex="'+c("function"==typeof(a=null!=(a=s.index||n&&n.index)?a:l)?a.call(o,{name:"index",hash:{},data:n}):a)+'" data-all="true" pstory-id="all">'+(null!=(i=u(null!=(i=null!=e?e.headerTexts:e)?i[0]:i,e))?i:"")+'</li>\r\n\t\t\t\t\t\t<li  class="pstory-header-button" role="tab" tabindex="'+c("function"==typeof(a=null!=(a=s.index||n&&n.index)?a:l)?a.call(o,{name:"index",hash:{},data:n}):a)+'"  data-all="false">'+(null!=(i=u(null!=(i=null!=e?e.headerTexts:e)?i[1]:i,e))?i:"")+'</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="carousel-animate carousel-wrapper options-container show-all">\r\n'},3:function(t,e,s,r,n){return'        \t\t<div class="carousel-animate carousel-wrapper options-container">\r\n'},5:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression,h=t.lambda;return'\t\t\t\t\t<div class="carousel-item pstory-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" aria-hidden="true" pstory-event="'+p(typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)===d?l.call(c,{name:"event",hash:{},data:n}):l)+'" role="'+p(h(null!=a[1]?a[1].role:a[1],e))+'">\r\n\t\t\t\t\t\t<div class="card card_'+p(typeof(l=null!=(l=s.typeImage||(null!=e?e.typeImage:e))?l:u)===d?l.call(c,{name:"typeImage",hash:{},data:n}):l)+" cards"+p(typeof(l=null!=(l=s.numCards||(null!=e?e.numCards:e))?l:u)===d?l.call(c,{name:"numCards",hash:{},data:n}):l)+'" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'">\t\t\t\t\t\t\t\r\n'+(null!=(o=t.invokePartial(r.innerCard,e,{name:"innerCard",hash:{numberPrefAccessibility:null!=a[1]?a[1].numberPrefAccessibility:a[1],numberPref:null!=a[1]?a[1].numberPref:a[1]},data:n,indent:"\t\t\t\t\t\t\t",helpers:s,partials:r,decorators:t.decorators}))?o:"")+'\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t <div id="pop-'+p(h(e,e))+'" class="pstory-button-txt-wrapper" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'"><span class="pstory-button-txt">\r\n                             '+(null!=(o=typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)===d?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</span></div>\t\t           \r\n\t\t\t\t\t</div>\r\n"},6:function(t,e,s,r,n){return"selected"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'<div class="perso-accessibility-wrapper perso-accessibility-account-selector" role="text">\r\n\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountSelectorText||(null!=e?e.accountSelectorText:e))?l:u)===d?l.call(c,{name:"accountSelectorText",hash:{},data:n}):l)+'</span> \r\n</div>\r\n<div id="pstory-block-account-selector_'+p(typeof(l=null!=(l=s.index||(null!=e?e.index:e))?l:u)===d?l.call(c,{name:"index",hash:{},data:n}):l)+'" class="pstory-block-frame pstory-block-account-selector '+p(typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)===d?l.call(c,{name:"class",hash:{},data:n}):l)+'" data-showAll='+p(typeof(l=null!=(l=s.showAll||(null!=e?e.showAll:e))?l:u)===d?l.call(c,{name:"showAll",hash:{},data:n}):l)+'>\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(o=s.if.call(c,null!=e?e.showAll:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+'\t        \t<div class="carousel-inner-wrapper cards-wrapper">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(5,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t        \t</div>\r\n\t\t\t\t<div class="perso-accessibility-wrapper account-button selected" role="text">\r\n\t\t\t\t\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountName||(null!=e?e.accountName:e))?l:u)===d?l.call(c,{name:"accountName",hash:{},data:n}):l)+". "+p(typeof(l=null!=(l=s.numberPrefAccessibility||(null!=e?e.numberPrefAccessibility:e))?l:u)===d?l.call(c,{name:"numberPrefAccessibility",hash:{},data:n}):l)+" "+p(typeof(l=null!=(l=s.accountNumber||(null!=e?e.accountNumber:e))?l:u)===d?l.call(c,{name:"accountNumber",hash:{},data:n}):l)+'</span>\r\n\t\t\t\t</div>\r\n                <input class="account-button prev" id="prev" type="button" value="" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'"/>\r\n\t\t\t\t<input class="account-button next" id="next" type="button" value="" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'"/>\r\n\t\t\t\t<div class="pstory-all-accounts-txt" role="text">'+(null!=(o=typeof(l=null!=(l=s.allAccountsTxt||(null!=e?e.allAccountsTxt:e))?l:u)===d?l.call(c,{name:"allAccountsTxt",hash:{},data:n}):l)?o:"")+'</div>\r\n            </div>\r\n            <div class="pstory-comment">'+(null!=(o=typeof(l=null!=(l=s.comment||(null!=e?e.comment:e))?l:u)===d?l.call(c,{name:"comment",hash:{},data:n}):l)?o:"")+"</div>\r\n        </div>\r\n    </div>\r\n</div>"},usePartial:!0,useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector-inner-card"]=r.template({1:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{},o=s.helperMissing,l="function",c=t.escapeExpression;return'\t\t\t<span class="perso-account-number" aria-label="'+c(typeof(i=null!=(i=s.numberPrefAccessibility||(null!=e?e.numberPrefAccessibility:e))?i:o)===l?i.call(a,{name:"numberPrefAccessibility",hash:{},data:n}):i)+" "+c(typeof(i=null!=(i=s.number||(null!=e?e.number:e))?i:o)===l?i.call(a,{name:"number",hash:{},data:n}):i)+'.">'+c(typeof(i=null!=(i=s.number||(null!=e?e.number:e))?i:o)===l?i.call(a,{name:"number",hash:{},data:n}):i)+"</span>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'<div class="card card_'+u(typeof(a=null!=(a=s.typeImage||(null!=e?e.typeImage:e))?a:l)===c?a.call(o,{name:"typeImage",hash:{},data:n}):a)+" cards"+u(typeof(a=null!=(a=s.numCards||(null!=e?e.numCards:e))?a:l)===c?a.call(o,{name:"numCards",hash:{},data:n}):a)+'" pstory-id="'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'">\t\t\t\t\t\t\t\r\n\t\t<span class="perso-account-name" aria-label="'+u(typeof(a=null!=(a=s.name||(null!=e?e.name:e))?a:l)===c?a.call(o,{name:"name",hash:{},data:n}):a)+'.">'+u(typeof(a=null!=(a=s.name||(null!=e?e.name:e))?a:l)===c?a.call(o,{name:"name",hash:{},data:n}):a)+"</span>\r\n"+(null!=(i=s.if.call(o,null!=e?e.number:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'\t\t<div id="pop-'+u(t.lambda(e,e))+'" class="pstory-button-txt-wrapper" pstory-id="'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'"><span class="pstory-button-txt">'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"</span></div>\t\r\n\t</div>\r\n\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector"]=r.template({1:function(t,e,s,r,n,i,a){var o;return'\t\t\t<div class="header-container">\r\n\t\t\t\t<div class="pstory-tab-animated-border-bottom"></div>\r\n\t\t\t\t<ul class="tablist" role="tablist">\r\n'+(null!=(o=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.headersArray:e,{name:"each",hash:{},fn:t.program(2,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<div class="carousel-outer-wrapper">\r\n\t\t\t\t<div class="carousel-animate options-container carousel-wrapper pstory-show-header-tabs">\r\n'},2:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing;return'\t\t\t\t\t\t<li class="pstory-header-button" '+(null!=(o=s.if.call(c,null!=a[1]?a[1].isDesktopMode:a[1],{name:"if",hash:{},fn:t.program(3,n,0,i,a),inverse:t.noop,data:n}))?o:"")+' role="tab" data-all="'+t.escapeExpression("function"==typeof(l=null!=(l=s.isAll||(null!=e?e.isAll:e))?l:u)?l.call(c,{name:"isAll",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isAll:e,{name:"if",hash:{},fn:t.program(5,n,0,i,a),inverse:t.noop,data:n}))?o:"")+">"+(null!=(o="function"==typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</li>\r\n"},3:function(t,e,s,r,n){var i,a;return' tabindex="0"  aria-label="'+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"text",hash:{},data:n}):a)?i:"")+'" '},5:function(t,e,s,r,n){return'pstory-id="all"'},7:function(t,e,s,r,n){return'\t\t\t\t\t<div class="carousel-outer-wrapper">\r\n\t\t\t\t\t\t<div class="carousel-animate options-container carousel-wrapper">\r\n'},9:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d=t.escapeExpression;return'\t\t\t\t\t\t\t\t<div class="carousel-item pstory-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(10,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'" aria-hidden="true" pstory-id="'+d("function"==typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)?l.call(c,{name:"id",hash:{},data:n}):l)+'" pstory-event="'+d("function"==typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)?l.call(c,{name:"event",hash:{},data:n}):l)+'"\r\n\t\t\t\t\t\t\t\t role="'+d(t.lambda(null!=a[1]?a[1].role:a[1],e))+'">\r\n\t\t\t\t\t\t\t\t\t'+(null!=(o=s.if.call(c,null!=a[1]?a[1].isDesktopMode:a[1],{name:"if",hash:{},fn:t.program(12,n,0,i,a),inverse:t.program(14,n,0,i,a),data:n}))?o:"")+"\r\n\t\t\t\t\t\t\t\t</div>\r\n"},10:function(t,e,s,r,n){return"selected"},12:function(t,e,s,r,n,i,a){var o;return" "+(null!=(o=t.invokePartial(r.innerCardDesktop,e,{name:"innerCardDesktop",hash:{numberPrefAccessibility:null!=a[1]?a[1].numberPrefAccessibility:a[1],numberPref:null!=a[1]?a[1].numberPref:a[1]},data:n,helpers:s,partials:r,decorators:t.decorators}))?o:"")+"\r\n\t\t\t\t\t\t\t\t\t"},14:function(t,e,s,r,n,i,a){var o;return" "+(null!=(o=t.invokePartial(r.innerCard,e,{name:"innerCard",hash:{numberPrefAccessibility:null!=a[1]?a[1].numberPrefAccessibility:a[1],numberPref:null!=a[1]?a[1].numberPref:a[1]},data:n,helpers:s,partials:r,decorators:t.decorators}))?o:"")+" "},16:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{};return'\t\t\t\t\t\t\t<div class="carousel-index-wrapper" '+(null!=(i=s.if.call(a,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(17,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n\t\t\t\t\t\t\t\t<div class="carousel-index-container">\r\n'+(null!=(i=s.each.call(a,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(19,n,0),inverse:t.noop,data:n}))?i:"")+"\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n"},17:function(t,e,s,r,n){var i;return' role="application" aria-labelledby="perso-accessibility-read-'+t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?e.options:e)?i[0]:i)?i.id:i,e))+'"'},19:function(t,e,s,r,n){return'\t\t\t\t\t\t\t\t\t<div class="carousel-index-dot">\r\n\t\t\t\t\t\t\t\t\t\t<div class="carousel-index-dot-circle"></div>\r\n\t\t\t\t\t\t\t\t\t</div> \r\n'},21:function(t,e,s,r,n){return' tabindex="-1" '},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'<div class="perso-accessibility-wrapper perso-accessibility-account-selector" role="text">\r\n\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountSelectorText||(null!=e?e.accountSelectorText:e))?l:u)===d?l.call(c,{name:"accountSelectorText",hash:{},data:n}):l)+'</span>\r\n</div>\r\n<div id="pstory-block-account-selector_'+p(typeof(l=null!=(l=s.index||(null!=e?e.index:e))?l:u)===d?l.call(c,{name:"index",hash:{},data:n}):l)+'" class="pstory-block-frame pstory-block-account-selector '+p(typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)===d?l.call(c,{name:"class",hash:{},data:n}):l)+'" data-show-header-tabs='+p(typeof(l=null!=(l=s.showHeaderTabs||(null!=e?e.showHeaderTabs:e))?l:u)===d?l.call(c,{name:"showHeaderTabs",hash:{},data:n}):l)+'>\r\n\t<div class="pstory-block-container">\r\n\t\t<div class="pstory-block-content">\r\n'+(null!=(o=s.if.call(c,null!=e?e.showHeaderTabs:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(7,n,0,i,a),data:n}))?o:"")+'\t\t\t\t\t\t\t<div class="carousel-inner-wrapper cards-wrapper" aria-hidden="true">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(9,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class="perso-accessibility-wrapper pstory-account-button selected" role="text">\r\n\t\t\t\t\t\t\t\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountName||(null!=e?e.accountName:e))?l:u)===d?l.call(c,{name:"accountName",hash:{},data:n}):l)+". "+p(typeof(l=null!=(l=s.numberPrefAccessibility||(null!=e?e.numberPrefAccessibility:e))?l:u)===d?l.call(c,{name:"numberPrefAccessibility",hash:{},data:n}):l)+" "+p(typeof(l=null!=(l=s.accountNumber||(null!=e?e.accountNumber:e))?l:u)===d?l.call(c,{name:"accountNumber",hash:{},data:n}):l)+"</span>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n"+(null!=(o=s.if.call(c,null!=e?e.showIndexDots:e,{name:"if",hash:{},fn:t.program(16,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t\t\t\t<div class="pstory-all-accounts-txt" role="text">'+(null!=(o=typeof(l=null!=(l=s.allAccountsTxt||(null!=e?e.allAccountsTxt:e))?l:u)===d?l.call(c,{name:"allAccountsTxt",hash:{},data:n}):l)?o:"")+'</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<input type="button" class="pstory-account-button pstory-prev-account-button" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(21,n,0,i,a),inverse:t.noop,data:n}))?o:"")+' />\r\n\t\t\t\t\t\t<input type="button" class="pstory-account-button pstory-next-account-button" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(21,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="pstory-comment">'+(null!=(o=typeof(l=null!=(l=s.comment||(null!=e?e.comment:e))?l:u)===d?l.call(c,{name:"comment",hash:{},data:n}):l)?o:"")+"</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>"},usePartial:!0,useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-pie-chart"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-pie-chart">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <div class="pstory-pie-chart"></div>\r\n            <div class="pstory-pie-data">\r\n                <input type="button" class="pstory-arrow pstory-next-arrow" aria-hidden="true"/>\r\n                <div class="pstory-pie-info perso-accessibility-wrapper" role="text">\r\n                </div>\r\n                <input type="button" class="pstory-arrow pstory-previous-arrow" aria-label="'+t.escapeExpression(t.lambda(null!=(i=null!=e?e.texts:e)?i.nextCategory:i,e))+'"/>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-minimal"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n,i,a){var o;return null!=(o=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0,i,a),inverse:t.noop,data:n}))?o:""},4:function(t,e,s,r,n,i,a){var o,l=t.lambda;return'                            <tr class="'+t.escapeExpression(l(null!=a[1]?a[1].class:a[1],e))+'">\r\n                                <td role="cell" class="perso-td-date">'+(null!=(o=l(null!=e?e.date:e,e))?o:"")+'</td>\r\n                                <td  align="right" role="cell" class="perso-td-amount-balance">'+(null!=(o=l(null!=e?e.amount:e,e))?o:"")+' </td>                                \r\n                                <td  align="right" class="perso-td-amount-balance  " role="cell"> '+(null!=(o=l(null!=e?e.account:e,e))?o:"")+"</td>\r\n\r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table">\r\n'+(null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist1"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:""},4:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td>\r\n                                   <span class="perso-td-first-row perso-td-account-number">\r\n                                       '+(null!=(i=a(null!=e?e.accountNumber:e,e))?i:"")+'\r\n                                   </span>\r\n                                    <span class="perso-td-transaction">\r\n                                        '+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="rightAlign" >\r\n                                     <span class="perso-td-first-row perso-td-date">\r\n                                         '+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'\r\n                                     </span>\r\n                                    <span class="perso-td-amount-balance perso-td-amount">\r\n                                        '+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist1">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist2"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:""},4:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td>\r\n                                    <span class="perso-td-first-row perso-td-transaction">\r\n                                        '+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="rightAlign" >\r\n                                    <span class="perso-td-first-row perso-td-date">\r\n                                        '+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'\r\n                                    </span>\r\n                                    <span class="perso-td-amount-balance perso-td-amount">\r\n                                        '+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist2">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist3"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n,i,a){var o;return null!=(o=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0,i,a),inverse:t.noop,data:n}))?o:""},4:function(t,e,s,r,n,i,a){var o,l=t.lambda;return'                            <tr >\r\n                                <td>\r\n                                    <span class="perso-td-first-row perso-td-date">\r\n                                        '+(null!=(o=l(null!=e?e.date:e,e))?o:"")+'\r\n                                    </span>                                    \r\n                                </td>\r\n                                <td> \r\n                                    <span class="perso-td-first-row perso-td-account-number">\r\n                                        '+(null!=(o=l(null!=e?e.accountNumber:e,e))?o:"")+'\r\n                                    </span>\r\n                                    <span class="perso-td-transaction">\r\n                                        '+(null!=(o=l(null!=e?e.transaction:e,e))?o:"")+'\r\n                                    </span>                           \r\n                                </td>\r\n                                <td class="rightAlign" >\r\n                                     <span class="perso-td-first-row perso-td-balance-title perso-td-small">\r\n                                        '+t.escapeExpression(l(null!=a[1]?a[1].balanceLabel:a[1],e))+'\r\n                                    </span>\r\n                                    <span class="perso-td-amount-balance perso-td-balance">\r\n                                        '+(null!=(o=l(null!=e?e.balance:e,e))?o:"")+"\r\n                                    </span>\r\n                                </td>   \r\n                                \r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist3">\r\n'+(null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist4"]=r.template({1:function(t,e,s,r,n){var i;return'                <div id="perso-legend-wrapper">\r\n'+(null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.legendTexts:e,{name:"each",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?i:"")+"                </div>\r\n"},2:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'                        <div class="perso-legend-container">\r\n                            <div class="perso-legend-dot '+(null!=(i="function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:l)?a.call(o,{name:"class",hash:{},data:n}):a)?i:"")+'-dot"></div>\r\n                            <span class="perso-legend-text">'+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"</span>\r\n                        </div>\r\n"},4:function(t,e,s,r,n){return'                    <div class="perso-table-row">\r\n                        <div class="perso-loading-tbl">\r\n                            <span>Loading...</span>\r\n                        </div>\r\n                    </div>\r\n'},6:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(7,n,0),inverse:t.noop,data:n}))?i:""},7:function(t,e,s,r,n){var i,a=t.lambda;return'                    <div class="perso-table-row scheduled-'+(null!=(i=a(null!=e?e.isScheduled:e,e))?i:"")+'">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.isScheduled:e,{name:"if",hash:{},fn:t.program(8,n,0),inverse:t.program(10,n,0),data:n}))?i:"")+'                        <div class="perso-table-cell perso-cell-1">\r\n                            <div class="perso-transaction-title">'+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'</div>\r\n                            <div class="perso-transaction-date">'+(null!=(i=a(null!=e?e.isAnticipated:e,e))?i:"")+" "+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'</div>\r\n                        </div>\r\n                        <div class="perso-table-cell perso-cell-2">\r\n                            <div class="perso-td-amount-balance perso-td-amount">'+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"</div>\r\n                        </div>\r\n                    </div>\r\n"},8:function(t,e,s,r,n){var i;return'                            <div class="perso-large-legend-dot scheduled-dot '+(null!=(i=t.lambda(null!=e?e.debitOrCredit:e,e))?i:"")+'"></div>\r\n'},10:function(t,e,s,r,n){var i;return'                            <div class="perso-large-legend-dot estimated-dot '+(null!=(i=t.lambda(null!=e?e.debitOrCredit:e,e))?i:"")+'"></div>\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{};return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(i=s.if.call(a,null!=e?e.legendTexts:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'            <div class="pstory-table-type-2 pstory-table-txlist4">\r\n'+(null!=(i=s.if.call(a,null!=e?e.future:e,{name:"if",hash:{},fn:t.program(4,n,0),inverse:t.program(6,n,0),data:n}))?i:"")+"            </div>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist5"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n,i,a){var o;return null!=(o=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0,i,a),inverse:t.noop,data:n}))?o:""},4:function(t,e,s,r,n,i,a){var o,l=t.lambda;return'                            <tr >\r\n                                <td>\r\n                                    <span class="perso-td-first-row perso-td-date">\r\n                                        '+(null!=(o=l(null!=e?e.date:e,e))?o:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="leftAlign">\r\n                                    <span class="perso-td-first-row perso-td-transaction perso-td-small">\r\n                                        '+(null!=(o=l(null!=e?e.transaction:e,e))?o:"")+'\r\n                                    </span>\r\n                                      <span class="perso-td-amount-balance perso-td-amount">\r\n                                        '+(null!=(o=l(null!=e?e.amount:e,e))?o:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="leftAlign" role="cell">\r\n                                    <span class="perso-td-first-row perso-td-balance-title perso-td-small">\r\n                                        '+t.escapeExpression(l(null!=a[1]?a[1].balanceLabel:a[1],e))+'\r\n                                    </span>\r\n                                      <span class="perso-td-amount-balance perso-td-balance">\r\n                                          '+(null!=(o=l(null!=e?e.balance:e,e))?o:"")+"\r\n                                      </span>\r\n                                </td>\r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist5">\r\n'+(null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(3,n,0,i,a),data:n}))?o:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist6"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:""},4:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td>\r\n                                    <span class="perso-td-date">\r\n                                        '+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td >\r\n                                    <span class="perso-td-transaction">\r\n                                        '+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="rightAlign">\r\n                                       <span class="perso-td-amount-balance perso-td-amount">\r\n                                           '+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"\r\n                                       </span>\r\n                                </td>\r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist6">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-pstory-title"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'<div class="pstory-title-outer-wrapper">\r\n    <div class="pstory-title-wrapper pstory-fixed">\r\n        <div class="pstory-title">\r\n            <input aria-label="'+t.escapeExpression("function"==typeof(a=null!=(a=s.backButtonText||(null!=e?e.backButtonText:e))?a:l)?a.call(o,{name:"backButtonText",hash:{},data:n}):a)+'" type="button" class="pstory-title-close"/>\r\n            <div role="heading" aria-level="1" class="pstory-title-text">'+(null!=(i="function"==typeof(a=null!=(a=s.title||(null!=e?e.title:e))?a:l)?a.call(o,{name:"title",hash:{},data:n}):a)?i:"")+'</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="story-frame-container"></div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-perso-feedback"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function";return'<div class="perso-feedback-wrapper">\r\n    <div class="textarea-wrapper">\r\n        <div class="textarea-container">\r\n            <textarea class="perso-feedback-text direction-text-left" maxlength="500" placeholder="'+(null!=(i=typeof(a=null!=(a=s.lblfeedbackprompt||(null!=e?e.lblfeedbackprompt:e))?a:l)===c?a.call(o,{name:"lblfeedbackprompt",hash:{},data:n}):a)?i:"")+'"></textarea>\r\n            <div class="textarea-size" ></div>\r\n        </div>\r\n        <input class="perso-feedback-submit" type="button" value="'+(null!=(i=typeof(a=null!=(a=s.btnsubmit||(null!=e?e.btnsubmit:e))?a:l)===c?a.call(o,{name:"btnsubmit",hash:{},data:n}):a)?i:"")+'"/>\r\n    </div>\r\n    <div class="perso-feedback-reaction">'+(null!=(i=typeof(a=null!=(a=s.lblreactionFeedback||(null!=e?e.lblreactionFeedback:e))?a:l)===c?a.call(o,{name:"lblreactionFeedback",hash:{},data:n}):a)?i:"")+"</div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["error-msg"]=r.template({1:function(t,e,s,r,n){return'class="mobile-err"'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'<div id="personetics-error-container" '+(null!=(i=s.if.call(o,null!=e?e.isMobileDevice:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n    <div class="personetics-error-img"></div>\r\n    <div class="personetics-error-large">'+(null!=(i="function"==typeof(a=null!=(a=s.textLarge||(null!=e?e.textLarge:e))?a:l)?a.call(o,{name:"textLarge",hash:{},data:n}):a)?i:"")+'</div>\r\n    <div class="personetics-error-small">'+(null!=(i="function"==typeof(a=null!=(a=s.textSmall||(null!=e?e.textSmall:e))?a:l)?a.call(o,{name:"textSmall",hash:{},data:n}):a)?i:"")+"</div>\r\n\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector-inner-card"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'<div class="card card_'+u(typeof(a=null!=(a=s.typeImage||(null!=e?e.typeImage:e))?a:l)===c?a.call(o,{name:"typeImage",hash:{},data:n}):a)+" cards"+u(typeof(a=null!=(a=s.numCards||(null!=e?e.numCards:e))?a:l)===c?a.call(o,{name:"numCards",hash:{},data:n}):a)+'" pstory-id="'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'">\t\t\r\n    <div class="perso-card-details">\r\n        <span class="perso-account-name">'+u(typeof(a=null!=(a=s.name||(null!=e?e.name:e))?a:l)===c?a.call(o,{name:"name",hash:{},data:n}):a)+" "+u(typeof(a=null!=(a=s.type||(null!=e?e.type:e))?a:l)===c?a.call(o,{name:"type",hash:{},data:n}):a)+'</span>\r\n        <br/>\r\n    </div>\r\n    <div id="pop-'+u(t.lambda(e,e))+'" class="pstory-button-txt-wrapper" pstory-id="'+u(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:l)===c?a.call(o,{name:"id",hash:{},data:n}):a)+'"><span class="pstory-button-txt">'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+"</span></div>\t\r\n</div>\r\n\r\n\r\n\r\n\t\t\t"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-account-selector"]=r.template({1:function(t,e,s,r,n,i,a){var o;return'\t\t\t<div class="header-container">\r\n\t\t\t\t<div class="pstory-tab-animated-border-bottom"></div>\r\n\t\t\t\t<ul class="tablist" role="tablist">\r\n'+(null!=(o=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.headersArray:e,{name:"each",hash:{},fn:t.program(2,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<div class="carousel-outer-wrapper">\r\n\t\t\t\t<div class="carousel-animate options-container carousel-wrapper pstory-show-header-tabs">\r\n'},2:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing;return'\t\t\t\t\t\t<li class="pstory-header-button" '+(null!=(o=s.if.call(c,null!=a[1]?a[1].isDesktopMode:a[1],{name:"if",hash:{},fn:t.program(3,n,0,i,a),inverse:t.noop,data:n}))?o:"")+' role="tab" data-all="'+t.escapeExpression("function"==typeof(l=null!=(l=s.isAll||(null!=e?e.isAll:e))?l:u)?l.call(c,{name:"isAll",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isAll:e,{name:"if",hash:{},fn:t.program(5,n,0,i,a),inverse:t.noop,data:n}))?o:"")+">"+(null!=(o="function"==typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</li>\r\n"},3:function(t,e,s,r,n){var i,a;return' tabindex="0"  aria-label="'+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:s.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"text",hash:{},data:n}):a)?i:"")+'" '},5:function(t,e,s,r,n){return'pstory-id="all"'},7:function(t,e,s,r,n){return'\t\t\t\t\t<div class="carousel-outer-wrapper">\r\n\t\t\t\t\t\t<div class="carousel-animate options-container carousel-wrapper">\r\n'},9:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d=t.escapeExpression;return'\t\t\t\t\t\t\t\t<div class="carousel-item pstory-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(10,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'" aria-hidden="true" pstory-id="'+d("function"==typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)?l.call(c,{name:"id",hash:{},data:n}):l)+'" pstory-event="'+d("function"==typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)?l.call(c,{name:"event",hash:{},data:n}):l)+'"\r\n\t\t\t\t\t\t\t\t role="'+d(t.lambda(null!=a[1]?a[1].role:a[1],e))+'">\r\n\t\t\t\t\t\t\t\t\t'+(null!=(o=s.if.call(c,null!=a[1]?a[1].isDesktopMode:a[1],{name:"if",hash:{},fn:t.program(12,n,0,i,a),inverse:t.program(14,n,0,i,a),data:n}))?o:"")+"\r\n\t\t\t\t\t\t\t\t</div>\r\n"},10:function(t,e,s,r,n){return"selected"},12:function(t,e,s,r,n,i,a){var o;return" "+(null!=(o=t.invokePartial(r.innerCardDesktop,e,{name:"innerCardDesktop",hash:{numberPrefAccessibility:null!=a[1]?a[1].numberPrefAccessibility:a[1],numberPref:null!=a[1]?a[1].numberPref:a[1]},data:n,helpers:s,partials:r,decorators:t.decorators}))?o:"")+"\r\n\t\t\t\t\t\t\t\t\t"},14:function(t,e,s,r,n,i,a){var o;return" "+(null!=(o=t.invokePartial(r.innerCard,e,{name:"innerCard",hash:{numberPrefAccessibility:null!=a[1]?a[1].numberPrefAccessibility:a[1],numberPref:null!=a[1]?a[1].numberPref:a[1]},data:n,helpers:s,partials:r,decorators:t.decorators}))?o:"")+" "},16:function(t,e,s,r,n){var i,a=null!=e?e:t.nullContext||{};return'\t\t\t\t\t\t\t<div class="carousel-index-wrapper" '+(null!=(i=s.if.call(a,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(17,n,0),inverse:t.noop,data:n}))?i:"")+'>\r\n\t\t\t\t\t\t\t\t<div class="carousel-index-container">\r\n'+(null!=(i=s.each.call(a,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(19,n,0),inverse:t.noop,data:n}))?i:"")+"\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n"},17:function(t,e,s,r,n){var i;return' role="application" aria-labelledby="perso-accessibility-read-'+t.escapeExpression(t.lambda(null!=(i=null!=(i=null!=e?e.options:e)?i[0]:i)?i.id:i,e))+'"'},19:function(t,e,s,r,n){return'\t\t\t\t\t\t\t\t\t<div class="carousel-index-dot">\r\n\t\t\t\t\t\t\t\t\t\t<div class="carousel-index-dot-circle"></div>\r\n\t\t\t\t\t\t\t\t\t</div> \r\n'},21:function(t,e,s,r,n){return' tabindex="-1" '},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'<div class="perso-accessibility-wrapper perso-accessibility-account-selector" role="text">\r\n\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountSelectorText||(null!=e?e.accountSelectorText:e))?l:u)===d?l.call(c,{name:"accountSelectorText",hash:{},data:n}):l)+'</span>\r\n</div>\r\n<div id="pstory-block-account-selector_'+p(typeof(l=null!=(l=s.index||(null!=e?e.index:e))?l:u)===d?l.call(c,{name:"index",hash:{},data:n}):l)+'" class="pstory-block-frame pstory-block-account-selector '+p(typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)===d?l.call(c,{name:"class",hash:{},data:n}):l)+'" data-show-header-tabs='+p(typeof(l=null!=(l=s.showHeaderTabs||(null!=e?e.showHeaderTabs:e))?l:u)===d?l.call(c,{name:"showHeaderTabs",hash:{},data:n}):l)+'>\r\n\t<div class="pstory-block-container">\r\n\t\t<div class="pstory-block-content">\r\n'+(null!=(o=s.if.call(c,null!=e?e.showHeaderTabs:e,{name:"if",hash:{},fn:t.program(1,n,0,i,a),inverse:t.program(7,n,0,i,a),data:n}))?o:"")+'\t\t\t\t\t\t\t<div class="carousel-inner-wrapper cards-wrapper" aria-hidden="true">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(9,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class="perso-accessibility-wrapper pstory-account-button selected" role="text">\r\n\t\t\t\t\t\t\t\t<span class="perso-accessibility-read">'+p(typeof(l=null!=(l=s.accountName||(null!=e?e.accountName:e))?l:u)===d?l.call(c,{name:"accountName",hash:{},data:n}):l)+". "+p(typeof(l=null!=(l=s.numberPrefAccessibility||(null!=e?e.numberPrefAccessibility:e))?l:u)===d?l.call(c,{name:"numberPrefAccessibility",hash:{},data:n}):l)+" "+p(typeof(l=null!=(l=s.accountNumber||(null!=e?e.accountNumber:e))?l:u)===d?l.call(c,{name:"accountNumber",hash:{},data:n}):l)+"</span>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n"+(null!=(o=s.if.call(c,null!=e?e.showIndexDots:e,{name:"if",hash:{},fn:t.program(16,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'\t\t\t\t\t\t\t<div class="pstory-all-accounts-txt" role="text">'+(null!=(o=typeof(l=null!=(l=s.allAccountsTxt||(null!=e?e.allAccountsTxt:e))?l:u)===d?l.call(c,{name:"allAccountsTxt",hash:{},data:n}):l)?o:"")+'</div>\r\n\t\t\t\t\t\t\t<input type="button" class="pstory-account-button pstory-prev-account-button" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(21,n,0,i,a),inverse:t.noop,data:n}))?o:"")+' />\r\n\t\t\t\t\t\t\t<input type="button" class="pstory-account-button pstory-next-account-button" aria-label="'+p(typeof(l=null!=(l=s.next||(null!=e?e.next:e))?l:u)===d?l.call(c,{name:"next",hash:{},data:n}):l)+'" '+(null!=(o=s.if.call(c,null!=e?e.isDesktopMode:e,{name:"if",hash:{},fn:t.program(21,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="pstory-comment">'+(null!=(o=typeof(l=null!=(l=s.comment||(null!=e?e.comment:e))?l:u)===d?l.call(c,{name:"comment",hash:{},data:n}):l)?o:"")+"</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>"},usePartial:!0,useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-buttons"]=r.template({1:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.navigateTarget:e,{name:"if",hash:{},fn:t.program(2,n,0,i,a),inverse:t.program(4,n,0,i,a),data:n}))?o:""},2:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'\t\t            <a href="#!" class="pstory-link-navigateTo pstory-button ripple-closed" pnavigate-id="'+t.escapeExpression("function"==typeof(a=null!=(a=s.navigateTarget||(null!=e?e.navigateTarget:e))?a:l)?a.call(o,{name:"navigateTarget",hash:{},data:n}):a)+'" >\r\n                        '+(null!=(i="function"==typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'\r\n                        <span class="perso-navigateTo-arrow"></span>\r\n                    </a>\r\n'},4:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.toggleState:e,{name:"if",hash:{},fn:t.program(5,n,0,i,a),inverse:t.program(8,n,0,i,a),data:n}))?o:""},5:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing,c="function",u=t.escapeExpression;return'\t\t                <input type="button" class="pstory-button pstory-toggle-button '+u(typeof(a=null!=(a=s.toggleState||(null!=e?e.toggleState:e))?a:l)===c?a.call(o,{name:"toggleState",hash:{},data:n}):a)+" "+(null!=(i=s.if.call(o,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0),inverse:t.noop,data:n}))?i:"")+'" value="'+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-type-text="Toggle '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:l)===c?a.call(o,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-id="'+u(typeof(a=null!=(a=s.toggleState||(null!=e?e.toggleState:e))?a:l)===c?a.call(o,{name:"toggleState",hash:{},data:n}):a)+'"/>\r\n'},6:function(t,e,s,r,n){return"selected"},8:function(t,e,s,r,n,i,a){var o;return null!=(o=s.if.call(null!=e?e:t.nullContext||{},null!=a[1]?a[1].typeRadio:a[1],{name:"if",hash:{},fn:t.program(9,n,0,i,a),inverse:t.program(12,n,0,i,a),data:n}))?o:""},9:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d="function",p=t.escapeExpression;return'                                <div class="pstory-button pstory-radio-button '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'  ripple-closed" pstory-id="'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'"  pstory-event="'+p(typeof(l=null!=(l=s.event||(null!=e?e.event:e))?l:u)===d?l.call(c,{name:"event",hash:{},data:n}):l)+'">\r\n                                    <input id="pstory-radio-'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" name="radio-'+p(t.lambda(null!=a[1]?a[1].id:a[1],e))+'" type="radio" '+(null!=(o=s.if.call(c,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(10,n,0,i,a),inverse:t.noop,data:n}))?o:"")+'/>\r\n                                    <label for="pstory-radio-'+p(typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)===d?l.call(c,{name:"id",hash:{},data:n}):l)+'" role="text">'+(null!=(o=typeof(l=null!=(l=s.text||(null!=e?e.text:e))?l:u)===d?l.call(c,{name:"text",hash:{},data:n}):l)?o:"")+"</label>\r\n                                </div>\r\n"},10:function(t,e,s,r,n){return"checked"},12:function(t,e,s,r,n){var i,a,o=t.escapeExpression,l=null!=e?e:t.nullContext||{},c=s.helperMissing,u="function";return'                                    <button id="pop-'+o(t.lambda(e,e))+'" class="pstory-button pstory-regular-button '+(null!=(i=s.if.call(l,null!=e?e.selected:e,{name:"if",hash:{},fn:t.program(6,n,0),inverse:t.noop,data:n}))?i:"")+' ripple-closed" pstory-type-text="Button '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:c)===u?a.call(l,{name:"text",hash:{},data:n}):a)?i:"")+'" pstory-id="'+o(typeof(a=null!=(a=s.id||(null!=e?e.id:e))?a:c)===u?a.call(l,{name:"id",hash:{},data:n}):a)+'" pstory-event="'+o(typeof(a=null!=(a=s.event||(null!=e?e.event:e))?a:c)===u?a.call(l,{name:"event",hash:{},data:n}):a)+'">\r\n                                        '+(null!=(i=typeof(a=null!=(a=s.text||(null!=e?e.text:e))?a:c)===u?a.call(l,{name:"text",hash:{},data:n}):a)?i:"")+'\r\n                                        <span class="perso-navigateTo-arrow"></span>\r\n                                    </button>\r\n'},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n,i,a){var o,l,c=null!=e?e:t.nullContext||{},u=s.helperMissing,d=t.escapeExpression;return'<div id="pstory-block-buttons_'+d("function"==typeof(l=null!=(l=s.id||(null!=e?e.id:e))?l:u)?l.call(c,{name:"id",hash:{},data:n}):l)+'" class="pstory-block-frame pstory-block-buttons '+d("function"==typeof(l=null!=(l=s.class||(null!=e?e.class:e))?l:u)?l.call(c,{name:"class",hash:{},data:n}):l)+'">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n'+(null!=(o=s.each.call(c,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(1,n,0,i,a),inverse:t.noop,data:n}))?o:"")+"        </div>\r\n    </div>\r\n</div>"},useData:!0,useDepths:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist1"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:""},4:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td>\r\n                                    <span class="perso-td-first-row perso-td-date">\r\n                                        '+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'\r\n                                    </span>\r\n                                    <span class="perso-td-transaction">\r\n                                        '+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'\r\n                                    </span>\r\n                                    <span class="perso-td-first-row perso-td-account-number">\r\n                                        '+(null!=(i=a(null!=e?e.accountNumber:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="rightAlign" >\r\n                                    <span class="perso-td-amount-balance perso-td-amount">\r\n                                        '+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist1">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-table-perso-txlist2"]=r.template({1:function(t,e,s,r,n){return'                    <tr>\r\n                        <td class="perso-loading-table">Loading...</td>\r\n                    </tr>\r\n'},3:function(t,e,s,r,n){var i;return null!=(i=s.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?i:""},4:function(t,e,s,r,n){var i,a=t.lambda;return'                            <tr>\r\n                                <td>\r\n                                    <span class="perso-td-first-row perso-td-date">\r\n                                        '+(null!=(i=a(null!=e?e.date:e,e))?i:"")+'\r\n                                    </span>\r\n                                    <span class="perso-td-first-row perso-td-transaction">\r\n                                        '+(null!=(i=a(null!=e?e.transaction:e,e))?i:"")+'\r\n                                    </span>\r\n                                </td>\r\n                                <td  class="rightAlign" >\r\n                                    <span class="perso-td-amount-balance perso-td-amount">\r\n                                        '+(null!=(i=a(null!=e?e.amount:e,e))?i:"")+"\r\n                                    </span>\r\n                                </td>\r\n                            </tr>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i;return'<div class="pstory-block-frame pstory-block-table">\r\n    <div class="pstory-block-container">\r\n        <div class="pstory-block-content">\r\n            <table class="pstory-table pstory-table-txlist2">\r\n'+(null!=(i=s.if.call(null!=e?e:t.nullContext||{},null!=e?e.future:e,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(3,n,0),data:n}))?i:"")+"            </table>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Personetics.UI.Handlebars.templates["pstory-block-textboxes"]=r.template({1:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{},l=s.helperMissing;return'\t\t\t\t\t<div class="perso-textbox" role="text">\r\n\t\t\t\t\t\t<div class="perso-label">'+(null!=(i="function"==typeof(a=null!=(a=s.label||(null!=e?e.label:e))?a:l)?a.call(o,{name:"label",hash:{},data:n}):a)?i:"")+'</div>\r\n\t\t\t\t\t\t<div class="perso-value">'+(null!=(i="function"==typeof(a=null!=(a=s.value||(null!=e?e.value:e))?a:l)?a.call(o,{name:"value",hash:{},data:n}):a)?i:"")+"</div>\r\n\t\t\t\t\t</div>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){var i,a,o=null!=e?e:t.nullContext||{};return'<div class="pstory-block-frame pstory-block-textboxes '+t.escapeExpression("function"==typeof(a=null!=(a=s.class||(null!=e?e.class:e))?a:s.helperMissing)?a.call(o,{name:"class",hash:{},data:n}):a)+'">\r\n    <div class="pstory-block-contanier">\r\n        <div class="pstory-block-content">\r\n           <div class="perso-textboxes-wrapper" role="text">\r\n'+(null!=(i=s.each.call(o,null!=e?e.options:e,{name:"each",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?i:"")+"           </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-story-widget-multi-title"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return'<div class="pstory-title-outer-wrapper">\r\n    <div class="pstory-multi-title-wrapper">\r\n        <div class="pstory-title">\r\n            <input aria-label="back" type="button" class="pstory-title-close">\r\n            <div role="heading" aria-level="1" class="pstory-title-text pstory-title-inside-story"></div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}),this.Personetics.UI.Handlebars.templates["tmpl-story-widget-multi"]=r.template({compiler:[7,">= 4.0.0"],main:function(t,e,s,r,n){return"<div class='perso-multi-story-dots'>\r\n    <div class='perso-dots carousel-index-wrapper'>\r\n    </div>\r\n</div>\r\n<div class='perso-multi-story-carousel carousel-animate carousel-wrapper'>\r\n    <div class='perso-multi-story-inner-carousel carousel-inner-wrapper'></div>\r\n</div>"},useData:!0})}(window,window.Personetics=window.Personetics||{},jQuery,window.Personetics.UI.Handlebars),function(t,e,s,r){e.story=e.story||{},e.story.AccountSelectorBlockProduct=e.story.AccountSelectorBlock.extend({beforeRender:function(t,r){e.story.AccountSelectorBlock.prototype.beforeRender.call(this,t,r);var n,i=s.extend(!0,[],r.options),a=this;this.showHeaderTabs=!1,this.defaultTab="choose-account",s.each(i,function(t,e){if("all"==e.id)return n=t,a.showHeaderTabs=!0,a.all=s.extend(!0,{},e),e.selected&&(a.defaultTab="all"),!1}),void 0!==n&&i.splice(n,1),i.cardsLength=i.length,this.options=i,"desktop"===this.story.cfg.widthMode?(this.config=this.story.uxCtrl.getAccountSelectorConfigDesktop(),this.isDesktopMode=!0):(this.config=this.story.uxCtrl.getAccountSelectorConfig(),this.isDesktopMode=!1),this.showArrows=this.config.showArrows&&this.options.cardsLength>=this.config.minAccountsForDisplayingArrows},render:function(t,e){this.el=t;var r=this.getAccountSelectorText();this.setImageValueForOptions();var n={options:this.options,class:e.class,showHeaderTabs:this.showHeaderTabs,headersArray:this.getHeadersArray(),showIndexDots:this.config.showIndexDots,isDesktopMode:this.isDesktopMode};n=s.extend(n,r);var i=this.template(n);t.append(i),this.frameEl=t.find(".pstory-block-frame").last()},getHeadersArray:function(){return[{text:e.dictionary.getText("lblaccSelectAll"),isAll:!0},{text:e.dictionary.getText("lblaccSelectChoose"),isAll:!1}]},getAccountSelectorText:function(){return{allAccountsTxt:this.all?this.all.text:"",next:e.dictionary.getText("lblaccSelectNextAcc"),prev:e.dictionary.getText("lblaccSelectPreviousAcc"),allAccountsName:e.dictionary.getText("lblaccSelectAll"),numberPref:e.dictionary.getText("lblaccSelectAccount"),numberPrefAccessibility:e.dictionary.getText("lblaccSelectAccountAccessibility"),accountSelectorText:e.dictionary.getText("lblAccessibiliotyAccountSelectorText")}},setImageValueForOptions:function(){s.each(this.options,function(t,s){var r=e.imageMap.getImageClass(s.image,"account_selector");s.isAbsoluteURL=r.isAbsoluteURL,s.image=r.url})},bindEvents:function(){e.story.OptionsBlock.prototype.bindEvents.call(this);var t=this;this.frameEl.find(".pstory-header-button").bind("click",e.bind(this,this.optionHeaderClickEvent)),this.frameEl.find(".pstory-prev-account-button").bind("click",function(e){var s=t.frameEl.find(".pstory-button.selected:not([clone='true'])");s.parents(".carousel-disable").length>0||(t.showArrows&&"ltr"==t.config.nextArrowDir?s.next().click():s.prev().click())}),this.frameEl.find(".pstory-next-account-button").bind("click",function(e){var s=t.frameEl.find(".pstory-button.selected:not([clone='true'])");s.parents(".carousel-disable").length>0||(t.showArrows&&"ltr"==t.config.nextArrowDir?s.prev().click():s.next().click())})},onInputSelect:function(t){},optionClickEvent:function(t){},getReportValue:function(t){return"Switch"},optionHeaderClickEvent:function(t){var e=s(t.currentTarget),r=e.data("all");this.frameEl.find(".options-container").hasClass("allAccounts")!=r&&(this.headerTabsAnimation(e),r?this.onAllAccountsClick(!0):this.onChooseAccountClick(e),this.updateAccessibilityButtons(r),this.setFocusOnRelevantElement(r),this.frameEl.find(".pstory-header-button").attr("aria-selected","false"),e.attr("aria-selected","true"),this.notifyReportHeaderEvent(r))},setFocusOnRelevantElement:function(t){var e;e=t?this.frameEl.find(".pstory-all-accounts-txt"):this.frameEl.find(".pstory-account-button.selected"),this.putFocusAccessibility(e)},notifyReportHeaderEvent:function(t){var e={};e.type=this.layoutInstructions.type,e.value=t?"All":"Specific",this.notifyReportEvent(e)},headerTabsAnimation:function(t){if(null!=t&&0!=t.length){var e=s(this.frameEl).find(".pstory-tab-animated-border-bottom"),r=t.offset().left-this.frameEl.offset().left,n=t.innerWidth();e.css({left:r+"px",width:n+"px"})}},onAllAccountsClick:function(t){this.frameEl.find(".options-container").addClass("allAccounts"),this.frameEl.find(".options-container").addClass("carousel-disable"),this.frameEl.find(".options-container").addClass("on-animation"),this.carouselAnimation.setConfig(),this.allAccountsSelectedAnimation(t),this.parent.notifyEvent(this,"setSelectedValue",this.all),this.frameEl.find(".pstory-all-accounts-txt").removeAttr("aria-hidden")},onChooseAccountClick:function(t){this.chooseAccountSelectedAnimation(),this.frameEl.find(".options-container").removeClass("allAccounts"),this.frameEl.find(".options-container").removeClass("carousel-disable"),this.carouselAnimation.setConfig();var e=this.frameEl.find('.pstory-button.selected:not([clone="true"])');e.prev().addClass("prev"),e.next().addClass("next");var s=this.getOptionById(e.attr("pstory-id"));this.parent.notifyEvent(this,"setSelectedValue",s),this.frameEl.find(".pstory-all-accounts-txt").attr("aria-hidden",!0)},setAccessibility:function(t){if(1==this.options.cardsLength){var e=this.frameEl.find(".pstory-prev-account-button, .pstory-next-account-button");e.css("display","none"),e.attr("aria-hidden",!0),this.setAccSelectedButtonAriaLabel()}else this.updateAccessibilityButtons(t)},updateAccessibilityButtons:function(t,e){var s=this.frameEl.find(".pstory-account-button");if(t)s.attr("aria-hidden",!0);else{s.attr("aria-hidden",!1);var r=s.filter(".pstory-prev-account-button"),n=s.filter(".pstory-next-account-button");n.hasClass("pstory-disable")?n.attr("aria-hidden",!0):r.attr("aria-hidden",!0),this.setAccSelectedButtonAriaLabel(e)}},setAccSelectedButtonAriaLabel:function(t){null==t&&(t=this.frameEl.find('.pstory-button.selected:not([clone="true"])'));var r=this.getOptionById(t.attr("pstory-id")),n=this.frameEl.find('.pstory-button:not([clone="true"])'),i=n.index(t)+1;i=0==i?1:i;var a=s("<span>"+r.text+"</span>");a.find("br").length>0&&a.find("br").replaceWith(" "),this.frameEl.find(".pstory-account-button.selected .perso-accessibility-read").attr("aria-label",r.name+". "+e.dictionary.getText("lblaccSelectAccountAccessibility")+": "+r.number+". "+a.text()+". "+i+" "+e.dictionary.getText("accessibilityOutOfTxt")+" "+n.length+". "+e.dictionary.getText("accessibilitySelected")).attr("id","perso-accessibility-read-"+r.id)},putFocusAccessibility:function(e){e.attr("tabindex","0"),e.blur();t.setTimeout(function(){e.focus()},10)},allAccountsSelectedAnimation:function(t){var e=this.frameEl.find(".pstory-all-accounts-txt"),s=this.getAllAccountsAnimationCards(),r=s.filter(".selected"),n=s.filter(":not(.selected)");n.length;0!=r.length&&(1==t?s.add(e).addClass("pstory-card-transition"):s.add(e).removeClass("pstory-card-transition"),s.addClass("pstory-all-animated"),this.frameEl.find(".options-container .pstory-button:not(.pstory-all-animated)").addClass("pstory-button-hidden"),s.removeClass("pstory-all-animated-last"),n.last().addClass("pstory-all-animated-last"),this.allAccountsAnimation.doAnimation(r,n,this.config.allAnimation))},chooseAccountSelectedAnimation:function(){var t=this.frameEl.find(".pstory-all-accounts-txt");this.frameEl.find(".pstory-button").add(t).addClass("pstory-card-transition");var e=this.frameEl.find(".options-container .pstory-button");e.removeClass("pstory-all-animated").removeClass("pstory-button-hidden"),this.allAccountsAnimation.cancelAnimation(e)},getAllAccountsAnimationCards:function(){var t,e,s=this.frameEl.find(".options-container .pstory-button:not(.carousel-hide-clone)"),r=this.frameEl.find('.options-container .pstory-button.selected:not([clone="true"])'),n=s.index(r);return t=n-Math.floor(this.options.cardsLength/2),e=n+Math.ceil(this.options.cardsLength/2),t<0?(e+=Math.abs(t),t=0):e>s.length&&(t+=e-s.length,e=s.length),s.slice(t,e)},afterRender:function(t){if(this.frameEl.parents(".pstory-dialog-frame").addClass("perso-account-selector"),this.setDefaultSelect(),this.setAccountSelectorColors(),this.bindCarousel(),this.setDisableArrows(),this.accSelectedAccountButtons(),this.showArrows?this.frameEl.find(".pstory-account-button:not(.selected)").addClass("pstory-arrow"):this.accPrevNextAccountButtons(),this.showHeaderTabs){this.setCssForAllAnimation(),this.allAccountsAnimation=e.utils.allAccountsAnimation.getAnimation(this.config.allAnimation.type);var s="all"===this.defaultTab;this.frameEl.find(".pstory-header-button[data-all='true']").attr("aria-selected",s),this.frameEl.find(".pstory-header-button[data-all='false']").attr("aria-selected",!s),this.frameEl.find(".cards-wrapper").attr("aria-hidden",s);var r=this.frameEl.find("[aria-selected='true']");this.headerTabsAnimation(r),"all"===this.defaultTab&&this.onAllAccountsClick()}e.story.AccountSelectorBlock.prototype.afterRender.call(this,t),this.setAccessibility("all"===this.defaultTab);var n=this.frameEl;this.el.find(".perso-accessibility-account-selector").css({height:n.outerHeight(),width:n.width()})},accSelectedAccountButtons:function(){var t=this.frameEl.find(".options-container"),e=this.frameEl.find(".pstory-button.selected:not([clone=true])").find(".card");this.frameEl.find(".pstory-account-button.selected").css({top:e.offset().top-t.offset().top,height:e.outerHeight(!0),width:e.outerWidth(!0),left:e.offset().left-t.offset().left})},accPrevNextAccountButtons:function(){var t=this.frameEl.find(".options-container"),e=this.frameEl.find(".pstory-button.selected:not([clone=true])"),r=this.frameEl.find(".pstory-button.next .card, .pstory-button.prev .card"),n=this.frameEl.find(".pstory-account-button:not(.selected)");s.each(r,function(r,i){var a=s(i),o=a.parent().outerWidth()-a.parent().width(),l=(t.width()-e.outerWidth())/2-o/2;s(n[r]).css({top:a.offset().top-t.offset().top,height:a.outerHeight(),width:l,left:Math.max(a.offset().left-t.offset().left,0)})})},setDefaultSelect:function(t){0==this.frameEl.find(".pstory-button.selected").length&&s(this.frameEl.find(".pstory-button")[0]).addClass("selected")},bindCarousel:function(){var t=this.prepareCarouselParam();this.carouselAnimation=new e.utils.carouselAnimation.bindCarouselEventsForAnimation(this.frameEl.find(".options-container"),t)},prepareCarouselParam:function(){var t=this.getOptionsWidth();return t.showIndexDots=this.config.showIndexDots,t.beforeCarouselStart=e.bind(this,this.beforeCarouselStart),t},beforeCarouselStart:function(t){e.story.AccountSelectorBlock.prototype.optionClickEvent.call(this,t),this.optionClickEvent(t),this.setDisableArrows(t.currentTarget),this.updateAccessibilityButtons(!1,s(t.currentTarget))},setDisableArrows:function(t){if(null==t&&(t=this.frameEl.find('.pstory-button.selected:not([clone="true"])')),!this.config.enableInfiniteCarousel||2==this.options.cardsLength){var e=this.el.find(".pstory-prev-account-button"),r=this.el.find(".pstory-next-account-button");"true"==s(t).prev().attr("clone")?"ltr"==this.config.nextArrowDir&&this.showArrows?(r.addClass("pstory-disable"),e.removeClass("pstory-disable")):(e.addClass("pstory-disable"),r.removeClass("pstory-disable")):"true"==s(t).next().attr("clone")&&("ltr"==this.config.nextArrowDir&&this.showArrows?(e.addClass("pstory-disable"),r.removeClass("pstory-disable")):(r.addClass("pstory-disable"),e.removeClass("pstory-disable")))}},getOptionsWidth:function(){var t=this.frameEl.find(".options-container"),e=t.hasClass("allAccounts");t.removeClass("allAccounts");var s=t.find(".pstory-button:not(.selected)").outerWidth(!0);void 0===s&&(s=null);var r=t.find(".pstory-button.selected").outerWidth(!0);return void 0===r&&(r=null),1==e&&t.addClass("allAccounts"),{itemWidth:s,selectedItemWidth:r}},setAccountSelectorColors:function(){for(var t=this.frameEl.find(".pstory-button"),e=this.story.uxCtrl.getAccountSelectorPalette(),r=Math.ceil(t.length/e.length),n=[],i=0;i<r;i++)n=n.concat(e);t.each(function(t,e){s(e).addClass(n[t])})},setCssForAllAnimation:function(){var t=this.frameEl.find(".options-container");t.addClass("pstory-all-animation-"+this.config.allAnimation.type),t.height(t.height())},doScrollEvent:function(t){if(1==e.projectConfiguration.getConfig("supportCollapse")){var s=e.story.BlockChartFactory.generateHelperClazz("collapseHelper",this.story.cfg);this.collapseHelper=void 0===this.collapseHelper?s:this.collapseHelper;var r=this.frameEl.find(".carousel-outer-wrapper");this.collapseHelper.scrollEvent(this,r,t)}},onCollapsed:function(t,e,s){},onUnCollapsed:function(t){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.D3BarChartBlockProduct=e.story.D3BarChartBlock.extend({beforeRender:function(t,s){e.story.D3BarChartBlock.prototype.beforeRender.call(this,t,s)},afterRender:function(t){"vertical"!=this.chartType&&"multiVertical"!=this.chartType&&"pinGraph"!=this.chartType||(this.xAxis=this.frameEl.find(".x.axis")[0]),e.story.D3BarChartBlock.prototype.afterRender.call(this,t);var s=t.find(".pstory-bar-chart svg, .pstory-pinGraph-chart svg").attr("width").baseVal,r=(null!=s?s.value:t.find(".pstory-bar-chart svg, .pstory-pinGraph-chart svg").attr("width"))/2+"px";t.find(".pstory-bar-chart, .pstory-pinGraph-chart svg").css("padding-left","calc(50% - "+r+")"),this.renderAccessibility(t,this.chartType)},renderAccessibility:function(t,e){var r,n,i,a,o=s("<div class='accessibility-chart-wrapper'></div>"),l=this.layoutInstructions,c=this,u=s(t).find("svg.perso-svg-chart-container").offset();"pinGraph"!=e&&(t.find("svg .x.axis .tick").each(function(d,p){a=s("<input type='button' id='accessibility-chart-button_"+l.categories[d]+"' class='accessibility-chart-button'/>"),c.setUnclickableClass(a,e,d),r=s(p).get(0).getBBox().height,a.css("width",s(p).get(0).getBBox().width+"px"),n=s(p).offset().top-u.top,i=s(p).offset().left-u.left,a.css({left:i+"px",top:n+"px"}),a.height(r),c.ariaLabelAccessibilityButtons(a,l,d,e),c.ariaLabelSetSelected(t,p,a),s(a).bind("click",function(r){c.handleClickAccessibilityButtons(l,d,e),c.ariaLabelSetSelected(t,p,s(this))}),o.prepend(a)}),t.find(".pstory-bar-chart, .pstory-pinGraph-chart").append(o))},getETransform:function(t){var e=t.find("svg .perso-bar, svg .perso-chart-rect").parent(),s=e.css("transform");if("none"!=s)if(void 0!==typeof s&&null!==s||(s=e.css("-webkit-transform")),"undefined"!=typeof WebKitCSSMatrix)var r=new WebKitCSSMatrix(s).e;else r=new MSCSSMatrix(s).e;else if(void 0!==(s=e.attr("transform")).baseVal)r=s.baseVal.getItem(0).matrix.e;return r},ariaLabelSetSelected:function(t,e,r){var n=s(e).find(".perso-xAxis-label.selected").length>0?" selected":"",i=t.find(".accessibility-chart-button.selected");if(i.length>0){var a=i.attr("aria-label").split("selected");i.attr("aria-label",a[0]+""),i.removeClass("selected")}" selected"==n&&r.addClass("selected"),r.attr("aria-label",r.attr("aria-label")+n)},ariaLabelAccessibilityButtons:function(t,s,r,n){var i=s.categories.length-r,a=e.processor.PUtils.getUtilsInstance("dateUtils").getMonthNumber(e.processor.PStoryConfig.getConfig("lang")+"-short",s.categories[r]),o=e.processor.PUtils.getUtilsInstance("dateUtils").getMonthName(e.processor.PStoryConfig.getConfig("lang"))[a];o=o||s.categories[r];var l=e.projectConfiguration.getConfig("currencySymbol");"multiVertical"==n?t.attr("aria-label",o+", "+e.dictionary.getText("accessibilitySeriesIn")+": "+l+Math.round(s.series[0][r].value).toLocaleString("en")+", "+e.dictionary.getText("accessibilitySeriesOut")+": -"+l+Math.round(s.series[1][r].value).toLocaleString("en")+", "+i+" "+e.dictionary.getText("accessibilityOutOfTxt")+" "+s.categories.length):t.attr("aria-label",o+", "+l+Math.round(s.series[r].value).toLocaleString("en")+", "+i+" "+e.dictionary.getText("accessibilityOutOfTxt")+" "+s.categories.length)},handleClickAccessibilityButtons:function(t,r,n){var i,a=t.series;if("multiVertical"==n){var o=t.series[0][r];0===a[1][r].value&&0===a[0][r].value||a[1][r].category!==o.category||a[0][r].category!==o.category||this.handleClick.call(this,o,r)}else{o=t.series[r];this.handleClick.call(this,o,r)}var l=this.el.parents(".pstory-dialog-frame").next().find(".pstory-block-content, .pstory-block-content *");this.frameEl.hasClass("perso-collapsed")||void 0!==e.utils.accessibility&&null!==e.utils.accessibility&&(s.each(l,function(t,r){if(e.utils.accessibility.isFocusable(r))return i=s(r),!1}),void 0!==i&&i.length>0&&this.putFocusAccessibility(i))},putFocusAccessibility:function(e){e.attr("tabindex","0"),e.blur();t.setTimeout(function(){e.focus()},10)},doScrollEvent:function(t){if(1==e.projectConfiguration.getConfig("supportCollapse")&&("vertical"==this.chartType||"multiVertical"==this.chartType)){this.collapseHelper=void 0===this.collapseHelper?new e.story.CollapseHelper:this.collapseHelper;var r=s(this.xAxis);this.collapseHelper.scrollEvent(this,r,t)}},onCollapsed:function(t,e,s){},onUnCollapsed:function(t,e,s){t[0].setAttribute("transform",t[0].getAttribute("transform"))},handleClick:function(t,s){e.story.D3BarChartBlock.prototype.handleClick.call(this,t,s)},setUnclickableClass:function(t,e,s){var r=this.layoutInstructions.series;"multiVertical"==e?0===r[0][s].value&&0===r[1][s].value&&t.addClass("perso-unclickable"):0===r[s].value&&t.addClass("perso-unclickable")}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.ButtonsBlockProduct=e.story.ButtonsBlock.extend({bindEvnetsForAnimation:function(){e.utils.buttonAnimation&&s.isFunction(e.utils.buttonAnimation.bindMaterialButtonEventsForAnimation)&&e.utils.buttonAnimation.bindMaterialButtonEventsForAnimation(this.frameEl.find(".pstory-button"))}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.story=e.story||{},e.story.PieChartBlockProduct=e.story.PieChartBlock.extend({beforeRender:function(t,r){e.story.PieChartBlock.prototype.beforeRender.call(this,t,r);var i=t.parents(".pstory-dialog-frame").prev(".pstory-dialog-frame").find(".pstory-block-tabs").find(".pstory-button.selected").attr("pstory-id");"function"==typeof this.story.uxCtrl.getPieOptions&&void 0!==this.story.uxCtrl.getPieOptions().arcs&&(this.cornerRadiusPie=void 0!==this.story.uxCtrl.getPieOptions().arcs.cornerRadius?this.story.uxCtrl.getPieOptions().arcs.cornerRadius.radiusCorner:9),this.colors=n.scale.ordinal().range(this.getGraphPalette(i)),this.selectedTabId=i,this.texts=s.extend(!0,this.texts,{nextCategory:e.dictionary.getText("accessibilityNextCategory"),previousCategory:e.dictionary.getText("accessibilityPreviousCategory"),selectedCategoryTitle:e.dictionary.getText("accessibilitySelectedCategoryTitle")})},getGraphPalette:function(t){return this.story.uxCtrl.getPieGraphPalette(t)},renderPieBase:function(t){e.story.PieChartBlock.prototype.renderPieBase.call(this,t),1==this.options.arcs.filter.grayFilter&&this.renderGrayFilter()},renderGrayFilter:function(){this.svg.append("filter").attr("id",this.grayscaleId).append("feColorMatrix").attr("type","matrix").attr("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0")},renderGradient:function(){var t=this.options.arcs.gradients,e=this.svg.append("defs");t&&s.each(t,function(t,r){r&&(e=e.append("linearGradient").attr("id",r.id).attr("x1","0").attr("x2","0").attr("y1","0").attr("y2","1"),s.each(r.stopColors,function(t,s){e.append("stop").attr("offset",r.offset[t]).attr("stop-color",s)}))})},renderArcs:function(t){e.story.PieChartBlock.prototype.renderArcs.call(this,t);var r=this.grayscaleId;if(1==this.options.arcs.filter.grayFilter){var i=this.frameEl.find(".pstory-pie-chart svg .perso-arc path");s.each(i,function(t,e){n.select(e).style("filter","url(#"+r+")")})}this.arcs=i},afterRender:function(t){var s=this;if(this.frameEl){this.frameEl.addClass(this.selectedTabId);var r=this.frameEl.find(".pstory-pie-chart svg .perso-arc path.perso-selected")[0];this.story.uxCtrl.getPieOptions().arcs.cornerRadius&&this.story.uxCtrl.getPieOptions().arcs.cornerRadius.radiusCorner;n.select(r).attr("d",s.arcOver.cornerRadius(this.cornerRadiusPie)).style("filter",this.dropShadow).style("fill",function(t,e){return s.colorArcs(t.data.category)}),this.renderGradient(),s.arcPaths=s.frameEl.find(".pstory-pie-chart svg .perso-arc path"),n.select(r).moveToFront();var i=this.layoutInstructions.slices[this.getSelectedPathIndex(s.arcPaths)];s.initPieInfoValues(i),this.layoutInstructions.slices.length>1?this.frameEl.find(".pstory-pie-data .pstory-arrow").show():this.frameEl.find(".pstory-pie-data .pstory-arrow").hide(),e.story.PieChartBlock.prototype.afterRender.call(this,t)}},bindEvents:function(){if(this.frameEl){var t=this,e=this.frameEl.find(".pstory-next-arrow"),r=this.frameEl.find(".pstory-previous-arrow"),n=t.arcPaths;e.bind("click",function(e){var r=t.getSelectedPathIndex(n);r==n.length-1?(t.moveArcs(0),t.handleClick(t.layoutInstructions.slices[0],0)):(t.moveArcs(++r),t.handleClick(t.layoutInstructions.slices[r],r)),document.activeElement==this&&t.putFocusAccessibility(s(this).closest(".pstory-block-content"))}),r.bind("click",function(e){var r=t.getSelectedPathIndex(n);0==r?(t.moveArcs(n.length-1),t.handleClick(t.layoutInstructions.slices[n.length-1],n.length-1)):(t.moveArcs(--r),t.handleClick(t.layoutInstructions.slices[r],r)),document.activeElement==this&&t.putFocusAccessibility(s(this).closest(".pstory-block-content"))})}},putFocusAccessibility:function(e){e.attr("tabindex","0"),e.blur();t.setTimeout(function(){e.focus()},10)},onPieItemClick:function(t,s,r){var i=this,a=this.el.find(".perso-arc path.perso-selected"),o="";1==this.options.arcs.filter.grayFilter&&(o="url(#"+this.grayscaleId+")"),a[0]!=r&&(a.length&&(a[0].className.baseVal=e.utils.string.removeClass(a[0].className,"perso-selected"),n.select(a[0]).attr("d",i.arc).style("filter",o)),n.select(r).attr("d",i.arcOver.cornerRadius(this.cornerRadiusPie)).attr("class","perso-selected").style("filter",this.dropShadow).style("fill",function(t,e){return i.colorArcs(t.data.category)}),n.select(r).moveToFront(),this.handleClick(t,s),this.updatePieInfoValues(t.data))},updatePieInfoValues:function(t){if(t){var e='<div class="pstory-pie-amount perso-accessibility-no-read"><span>'+t.label+"</span></div>",r='<div class="pstory-pie-category perso-accessibility-no-read"><span>'+t.category+"</span></div>",n=this.frameEl.find(".pstory-pie-info");n.empty(),n.append(e),n.append(r),this.addInfoTextForAccessibility(n,t),1==this.options.arcs.filter.grayFilter&&s(".pstory-pie-amount").css("color",this.colors(t.category))}},initPieInfoValues:function(t){this.updatePieInfoValues(t)},addInfoTextForAccessibility:function(t,e){t.prepend('<span class="perso-accessibility-read">'+e.label+", "+e.category+"</span>"),t.find(".perso-accessibility-no-read").attr("aria-hidden",!0)},moveArcs:function(t){var s=this,r=s.arcPaths[t],i="";1==this.options.arcs.filter.grayFilter&&(i="url(#"+this.grayscaleId+")");var a=this.el.find(".perso-arc path.perso-selected");r&&(n.select(".pstory-frame .perso-arc path.perso-selected").attr("d",s.arc).style("filter",i),a[0].className.baseVal=e.utils.string.removeClass(a[0].className,"perso-selected"),n.select(r).attr("d",s.arcOver.cornerRadius(this.cornerRadiusPie)).attr("class","perso-selected").style("filter",this.dropShadow).style("fill",function(t,e){return s.colorArcs(t.data.category)}),n.select(r).moveToFront(),s.updatePieInfoValues(s.layoutInstructions.slices[t]))},colorArcs:function(t){var e=this,s=e.colors(t);return e.selectedTabId?"Out"==e.selectedTabId&&null!=e.options.arcs.selectedOutflowPrimaryColor?s=e.options.arcs.selectedOutflowPrimaryColor:"In"==e.selectedTabId&&null!=e.options.arcs.selectedInflowPrimaryColor&&(s=e.options.arcs.selectedInflowPrimaryColor):null!=e.options.arcs.selctedPrimaryColor&&(s=e.options.arcs.selctedPrimaryColor),s},doScrollEvent:function(t){if(1==e.projectConfiguration.getConfig("supportCollapse")){this.collapseHelper=void 0===this.collapseHelper?new e.story.CollapseHelper:this.collapseHelper;var s=this.frameEl.find(".pstory-pie-data");this.collapseHelper.scrollEvent(this,s,t)}}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.D3PinGraphChartBlockProduct=e.story.D3BarChartBlockProduct.extend({beforeRender:function(t,s){e.story.D3BarChartBlockProduct.prototype.beforeRender.call(this,t,s),this.texts.accessibilityPinGraphTitle=e.dictionary.getText("accessibilityPinGraphTitle")},getHtmlTemplateId:function(t){return"pinGraph-chart"},render:function(t,s){e.story.Block.prototype.render.call(this,t,s);var r=this.frameEl.find(".pstory-pinGraph-chart");r.length>0&&this.renderBarChart(r,s)},renderBarChart:function(t,e){this.chartHelper.prepareChart(e,this.options),this.chartHelper.renderChart(t)},beforeRenderChart:function(t,e){this.layoutInstructions.series=this.layoutInstructions.series[0],this.chartType=this.getChartType(),this.chartTypeHelper=this.chartType+"Helper",this.initChartHelper(this.chartTypeHelper),this.options=this.story.uxCtrl.getPinGraphChartOptions()},barsDirection:function(){e.processor.PStoryConfig.isRtl()&&this.barsDirectionRTL()},getChartType:function(){return"pinGraph"},getAccessibilityTitle:function(){return this.texts.accessibilityPinGraphTitle}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TableBlockProduct=e.story.TableBlock.extend({getHtmlTemplateId:function(t){var e,r=t?t.split(" "):[];if(s.each(r,function(t,s){if(s.indexOf("perso-txlist")>-1)return e=s.trim(),!1}),this.classStr=e,void 0===this.classStr)switch(this.layoutInstructions.columns.length){case 3:this.classStr="perso-txlist4";break;case 4:this.classStr="perso-txlist1";break;case 6:this.classStr="perso-txlist3";break;default:this.classStr="perso-txlist1"}return"table-"+this.classStr},afterRender:function(t){if(e.story.TableBlock.prototype.afterRender.call(this,t),1==e.projectConfiguration.getConfig("supportCollapse")){var s=e.story.BlockChartFactory.generateHelperClazz("collapseHelper",this.story.cfg);this.collapseHelper=void 0===this.collapseHelper?s:this.collapseHelper;var r=this.collapseHelper.getHeightPrevFixedElements()-this.frameEl.offset().top,n=this.frameEl.parents(".pstory-frame"),i=n.find(".pstory-container"),a=n[0].scrollHeight-i.height();r>0&&n.scrollTop(n.scrollTop()-r),i.css("min-height",n.height()+n.scrollTop()-a)}}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.AccountSelectorBlockChase=e.story.AccountSelectorBlockProduct.extend({beforeRender:function(t,s){e.story.AccountSelectorBlockProduct.prototype.beforeRender.call(this,t,s);var r=e.dictionary.getText("lblaccSelectAll");void 0!==this.all&&(this.all.text="<span class='perso-account-name'>"+r+"</span></br>"+this.all.text)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PieChartBlockChase=e.story.PieChartBlockProduct.extend({setPieSize:function(){e.story.PieChartBlockProduct.prototype.setPieSize.call(this),this.innerRadius=90,this.outerRadius=71,this.innerRadiusOver=95,this.outerRadiusOver=61},renderPieTitle:function(t){var e=this.options.totaltxt_SpaceFromCenter||"-1.2em";this.svg.append("text").attr("class","perso-total-txt").attr("dy",e).html(t)},renderPieAmount:function(t){var e=this.options.totalAmount_SpaceFromCenter||".9em";this.svg.append("text").attr("class","perso-total-amount").attr("dy",e).html(t)},updatePieInfoValues:function(t){if(t){var e='<div class="pstory-pie-amount"><span>'+t.label+"</span></div>",s='<div class="pstory-pie-category"><span>'+t.category+"</span></div>",r=this.frameEl.find(".pstory-pie-info");r.empty(),r.append(e),r.append(s)}}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.TextBlockChase=e.story.TextBlock.extend({beforeRender:function(t,s){var r=s.text.replace(/{{Emoji /g,"<span>&#x");r=r.replace(/}}/g,"</span>"),s.text=r,e.story.TextBlock.prototype.beforeRender.call(this,t,s)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.BlockChartFactory=new function(){this.chartHelperFactoryMap={},this.registerChartHelper=function(t,e){if(e.hasOwnProperty("helperClass")){if(e.helperClass){var s=this.chartHelperFactoryMap[t];s||(s={type:t,class:{},widthModes:{}},this.chartHelperFactoryMap[t]=s),e.class?s.class[e.class]=e.helperClass:e.widthMode?s.widthModes[e.widthMode]=e.helperClass:s.helperClass=e.helperClass}}else this.chartHelperFactoryMap[t]=e},this.generateHelperClazz=function(t,s){var r=null;if(void 0!==t&&null!=t&&this.chartHelperFactoryMap.hasOwnProperty(t)){var n=this.chartHelperFactoryMap[t].helperClass;if(s.hasOwnProperty("widthMode")&&void 0!==s.widthMode&&null!==s.widthMode&&s.widthMode.length>0&&null!=this.chartHelperFactoryMap[t].widthModes[s.widthMode])n=this.chartHelperFactoryMap[t].widthModes[s.widthMode];r=new n}else e.log("The helper"+t+"is not valid");return r}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.BlockHelperBase=Base.extend({prepareChart:function(t,e){this.options=e,this.width=this.getValueByScreenWidth(this.options.svgWidth)},renderSVGBase:function(t,e){return e||(e=""),n.select(t.get(0)).append("svg").attr("class","perso-svg-chart-container "+e).attr("width",this.width).attr("height",this.getValueByScreenWidth(this.options.svgHeight)).append("g").attr("transform","translate(0,0)")},renderLabels:function(){var t=this;this.options.labels.drawLabels&&this.svg.append("g").selectAll().data(t.seriesData).enter().append("text").attr("class","perso-label").attr("class",function(t){var e="perso-label";return t.selected&&(e+=" selected"),e}).attr("text-anchor","middle").attr("x",function(e,s){return t.xScale(t.categoriesData[s])+t.xScale.rangeBand()/2}).attr("y",function(e){var s=this.options.labels.marginBottom>0?this.options.labels.marginBottom:0;return t.yScale(e.value)-s}).html(function(t){return t.label})},renderXAxis:function(){var t=this;this.xAxis&&this.svg.append("g").attr("class","x axis").attr("transform",function(e,s){var r=0,n=0;return t.options.axis.translation.x&&(r=t.options.axis.translation.x),"height"==t.options.axis.translation.y&&(n+=t.height+t.margin.bottom),"translate("+r+","+n+")"}).call(t.xAxis)},wrapLabelText:function(t){t.each(function(){var t,e=n.select(this),s=[],r=0,i=e.attr("y"),a=parseFloat(e.attr("dy"));for(null!=e.text().match(/\d+/g)&&(s[0]=e.text().match(/\d+/g)[0]),null!=e.text().match(/[a-zA-Z]+/)&&(s[1]=e.text().match(/[a-zA-Z]+/)[0]),e.text(null);t=s.pop();)tspan=e.append("tspan").attr("x",0).attr("y",i).attr("dy",.8*r*1.5+a+"em"),tspan.text(t),r++})},renderYAxis:function(t){var e=this;this.options.yAxisLineDisplay&&this.svg.append("g").attr("class","y axis perso-grid").attr("transform",function(s,r){var n=void 0!==e.options.yAxisTop?e.options.yAxisTop:0;"boolean"==typeof t&&t&&(n=e.negativeYAxisTop);var i=void 0!==e.options.horizontalLineLeft?e.options.horizontalLineLeft:0;return"translate("+e.getValueByScreenWidth(i)+","+e.getValueByScreenWidth(n)+")"}).call(e.yAxis).selectAll(".tick line").attr("x2",function(t,s){var r=void 0!==e.options.horizontalLineWidth?e.options.horizontalLineWidth:e.options.svgWidth||0;return e.getValueByScreenWidth(r)}),this.options.yAxisTextDisplay||(this.svg.selectAll(".y.perso-grid .tick text").remove(),this.svg.selectAll(".y.perso-grid path").remove())},renderHorizontalLines:function(t){var e=this;this.svg.append("g").attr("transform","translate("+-1*e.margin.left+",0)").selectAll("g").data(e.seriesData).enter().append("g").attr("class","perso-chart-line").attr("transform",function(t,e){return"translate(0,"+y1Scale(e)*(e+1)+")"}).selectAll(".line").data(function(t){return t}).enter().append("line").attr("class","perso-chart-line").attr("x1","0").attr("x2",e.width).attr("y1",function(s,r){return t(r)+e.options.rectangles.paddingBottom}).attr("y2",function(s,r){return t(r)+e.options.rectangles.paddingBottom})},renderVerticalLines:function(t){var e=this;if(e.options.drowVerticalLines){var s=e.options.lineMarginLeft?e.options.lineMarginLeft:-30;this.svg.append("g").attr("transform","translate("+e.getValueByScreenWidth(s)+","+e.getValueByScreenWidth(e.options.verticalLineTop)+")").selectAll("g").data(e.seriesData).enter().append("g").attr("class","perso-chart-line").attr("transform",function(t,e){return"translate(0,0)"}).selectAll(".line").data(function(t){return t}).enter().append("line").attr("class","perso-chart-line").attr("y1","0").attr("y2",e.getValueByScreenWidth(e.options.lineHeight)).attr("x1",function(s,r){return t(r)+e.getValueByScreenWidth(e.options.rectangles.paddingBottom)}).attr("x2",function(s,r){return t(r)+e.getValueByScreenWidth(e.options.rectangles.paddingBottom)})}},renderGradient:function(){var t=this.options.rectangles.gradients,e=this.svg.append("defs");t&&s.each(t,function(t,r){r&&(e=e.append("linearGradient").attr("id",r.id).attr("x1","0").attr("x2","0").attr("y1","0").attr("y2","1"),s.each(r.stopColors,function(t,s){e.append("stop").attr("offset",r.offset[t]).attr("stop-color",s)}))})},renderFilter:function(){var t=this.options.rectangles.filter,e=this.svg.selectAll("defs");t&&s.each(t,function(t,s){if(s){var r=e.append("filter").attr("id",s.id);r.append("feGaussianBlur").attr("in",s.in).attr("stdDeviation",s.stdDeviation),r.append("feOffset").attr("dx",s.dxOffset).attr("dy",s.dyOffset);var n=r.append("feMerge");n.append("feMergeNode"),n.append("feMergeNode").attr("in",s.in)}})},getValueByScreenWidth:function(e){var r=s(t).width();return r>=this.options.desktopScreenWidth?e:r<347?e:r>=414?e*this.options.screen.ratio_large:e*this.options.screen.ratio_medium}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.MultiVerticalChartHelper=e.utils.d3Helpers.BlockHelperBase.extend({MIN_BAR_HEIGHT:20,prepareChart:function(t,s,r){e.utils.d3Helpers.BlockHelperBase.prototype.prepareChart.call(this,t,s);this.handleClick=r,this.seriesData=t.series,this.categoriesData=t.categories,this.seriesLabelsData=t.seriesLabels,this.series=t.series,this.width=this.getValueByScreenWidth(this.options.svgWidth),this.yScale=n.scale.linear().range([this.getValueByScreenWidth(this.options.maxBarHeight)-this.MIN_BAR_HEIGHT,0],.1),this.yAxisScale=n.scale.linear().range([this.getValueByScreenWidth(this.options.yAxisHeight),0]),this.colorScale=n.scale.ordinal().rangeRoundBands([0,this.width],.1),this.colors=this.colorScale.range(this.options.palette),this.colorsLabels=n.scale.ordinal().rangeRoundBands([0,this.width],.1).range(this.options.paletteLabels),this.dispatch=n.dispatch("clickOnMonth");var i=0;this.seriesData.map(function(t){return i+=t.length,t}),this.dataLength=i,this.xScale=n.scale.ordinal().domain(this.categoriesData).rangeBands([0,this.width]),this.x0Scale=n.scale.ordinal().domain(n.range(this.categoriesData.length)).rangeBands([0,this.width],0),this.xAxis=n.svg.axis().scale(this.xScale).outerTickSize(0)},renderChart:function(t){this.yScale.domain([0,n.max(this.seriesData,function(t){return n.max(t,function(t){return t.value})})]),this.modifyData(),this.svg=this.renderSVGBase(t,"multiVertical"),this.renderGradient(),this.renderFilter(),this.renderMultiVerticalBars(),this.renderHiddenRects(this.seriesData),this.renderLabels(),this.renderXAxis(),this.renderVerticalLines(this.x0Scale)},renderMultiVerticalBars:function(){var t=this,e=[].concat.apply([],this.seriesData);this.minValue=n.min(e,function(t){return t.value||1/0}),this.maxValue=n.max(e,function(t){return t.value}),t.sortedData=t.sortData();var s=this.svg.append("g").attr("transform",function(e,s){return"translate("+(t.options.rectangles.marginLeft?t.options.rectangles.marginLeft:0)+","+t.getValueByScreenWidth(t.options.barTop)+")"}).selectAll("g").data(t.sortedData).enter().append("g").style("fill",function(e,s){return t.colors(s)}).attr("transform",function(e,s){return"translate("+t.getSeriesTranslateValue(s)+",0)"}).selectAll("rect").data(function(t){return t});s.enter().append("rect").attr("class",function(t){var e="perso-chart-rect "+t.mode;return t.selected&&(e+=" selected"),e}).attr("y",this.getValueByScreenWidth(this.options.maxBarHeight)).attr("height",0).attr("x",function(e,s){return t.xScale(t.categoriesData[s])+t.width/t.dataLength-15}).attr("width",function(e,s){return t.getValueByScreenWidth(t.options.rectangles.width)}).attr("rx",function(e){var s=t.options.rectangles.borderRadius.rx?t.options.rectangles.borderRadius.rx:"0";return t.getValueByScreenWidth(s)}).attr("ry",function(e){var s=t.options.rectangles.borderRadius.ry?t.options.rectangles.borderRadius.ry:"0";return t.getValueByScreenWidth(s)}).on("click",function(e,s){"function"==typeof t.handleClick&&t.handleClick(e,s)}),this.MultiVerticalBarsTransition(s)},MultiVerticalBarsTransition:function(t){var e=this;t.transition().duration(e.options.rectangles.transition.duration).delay(e.options.rectangles.transition.delay).attr("y",function(t){return e.getBarsY(t)}).attr("height",function(t){return e.getBarsHeight(t)})},getBarsHeight:function(t){var e=Math.abs(t.value),s=t.value?this.getValueByScreenWidth(this.options.maxBarHeight)-this.yScale(e):0;return t.barHeight=s,s},getBarsY:function(t){return t.value<0?this.getValueByScreenWidth(this.options.maxBarHeight):this.yScale(t.value)},renderLabels:function(){var t=this;if(t.sortedData=t.sortData(),this.options.labels.drawLabels){var e="perso-label perso-label-fadeIn";this.categoriesData.length>=4&&(e+=" minimize-font"),this.svg.append("g").attr("transform",function(e,s){t.width;return"translate(0,"+t.getValueByScreenWidth(t.options.labelTop)+")"}).selectAll("g").data(t.sortedData).enter().append("g").style("fill",function(e,s){return t.colorsLabels(s)}).attr("transform",function(e,s){var r=t.getValueByScreenWidth(t.options.nextLabelTop)*!s;return"translate("+t.getValueByScreenWidth(t.options.labels.right)+","+r+")"}).selectAll("text").data(function(t){return t}).enter().append("text").attr("text-anchor","middle").attr("class",function(t){var s=e+" "+t.mode;return t.selected&&(s+=" selected"),s}).attr("x",function(e,s){return t.xScale(t.categoriesData[s])+t.width/t.dataLength}).attr("y",function(e,s,r){var n=t.getMaxBarHeightInMonth(t.categoriesData[s]);return t.yScale(0)-n}).attr("dy","0.4em"),s.each(t.seriesLabelsData,function(e,r){var n=t.svg.selectAll(".perso-label."+r).append("tspan");s.each(n[0],function(r,n){var i=s(t.seriesData[e][r].label)[0].attributes;s.each(i,function(t,e){n.setAttribute(e.name,e.value)}),s(n).attr("perso-index",r);var a=s(s(t.seriesData[e][r].label)[0]).children();s.each(a,function(e,n){var i=t.svg.select('[perso-index="'+r+'"]').append("tspan").text(s(n).text()),a=n.attributes;s.each(a,function(t,e){i.attr(e.name,e.value)})})})})}},renderXAxis:function(){var t=this;if(this.xAxis)this.svg.append("g").attr("class","x axis").attr("transform",function(e,s){var r=0;return t.options.axis.translation.x&&(r=t.options.axis.translation.x),"translate("+r+","+t.getValueByScreenWidth(t.options.xAxiaTop)+")"}).call(t.xAxis).selectAll(".tick text").attr("y","0").data(this.seriesData[0]).attr("class",function(e,s){var r="perso-xAxis-label";return e.selected&&(r+=" selected"),0===t.seriesData[1][s].value&&0===t.seriesData[0][s].value&&t.seriesData[1][s].category===e.category&&t.seriesData[0][s].category===e.category&&(r+=" perso-unclickable"),r}).on("click",function(e,s){0===t.seriesData[1][s].value&&0===t.seriesData[0][s].value||t.seriesData[1][s].category!==e.category||t.seriesData[0][s].category!==e.category||"function"==typeof t.handleClick&&t.handleClick(e,s)})},renderHiddenRects:function(t){var e=this,s=e.getValueByScreenWidth(2*e.options.rectangles.width+e.options.rectangles.paddingRight),r=e.getValueByScreenWidth(e.options.maxBarHeight);e.seriesData=t,this.svg.append("g").attr("class","perso-hidden-rects").attr("transform",function(t,s){return"translate("+(e.options.rectangles.marginLeft?e.options.rectangles.marginLeft:0)+","+e.getValueByScreenWidth(e.options.barTop)+")"}).selectAll("g").data(this.seriesData[0]).enter().append("rect").attr("class",function(t,s){var r="hidden-rect";return 0===e.seriesData[1][s].value&&0===e.seriesData[0][s].value&&e.seriesData[1][s].category===t.category&&e.seriesData[0][s].category===t.category&&(r+=" perso-unclickable"),r}).attr("height",function(t,e){return r}).attr("width",s).attr("x",function(t,s){return e.xScale(e.categoriesData[s])+e.width/e.dataLength-15}).attr("fill-opacity",0).on("click",function(t,s){0===e.seriesData[1][s].value&&0===e.seriesData[0][s].value||e.seriesData[1][s].category!==t.category||e.seriesData[0][s].category!==t.category||"function"==typeof e.handleClick&&e.handleClick(t,s)})},getMaxBarHeightInMonth:function(t){var e=this,r=0;return this.series&&this.series.length>0&&s.each(e.seriesData,function(n,i){s.each(i,function(s,n){e.categoriesData[s]==t&&Math.abs(n.barHeight)>r&&(r=Math.abs(n.barHeight))})}),r},sortData:function(){var t=this;if(this.seriesData){var e=this.seriesLabelsData.slice().reverse(),s=[];e.forEach(function(r,n){s[e.indexOf(t.seriesLabelsData[n])]=t.seriesData[n]})}return s},modifyData:function(){var t=this;if(this.seriesData){var e=this.seriesLabelsData;s.each(e,function(r){s.each(t.seriesData[r],function(t,s){s.mode=e[r]})})}},getSeriesTranslateValue:function(t){var e=this.options.rectangles.paddingRight?this.options.rectangles.paddingRight:0;return this.getValueByScreenWidth(e)*t}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.VerticalChartHelper=e.utils.d3Helpers.BlockHelperBase.extend({MIN_BAR_HEIGHT:20,prepareChart:function(t,s,r){e.utils.d3Helpers.BlockHelperBase.prototype.prepareChart.call(this,t,s);this.handleClick=r,this.seriesData=t.series,this.categoriesData=t.categories,this.width=this.getValueByScreenWidth(this.options.svgWidth),this.negativeBarTop=this.options.negativeBarTop||this.options.svgHeight,this.negativeYAxisTop=this.options.negativeYAxisTop||this.options.svgHeight;var i=this.options.rectangles,a=(this.width+this.getValueByScreenWidth(i.space))/this.getValueByScreenWidth(i.width+i.space);this.numOfBars=this.categoriesData.length>a?Math.floor(a):this.categoriesData.length,this.calcLeft=(this.width-(this.numOfBars+1)*this.getValueByScreenWidth(i.width+i.space))/2;this.accessibilityCategories;if(e.processor.PStoryConfig.isRtl()){var o=this.categoriesData.length-(this.categoriesData.length-this.numOfBars);this.categoriesData=this.categoriesData.slice(0,o),this.seriesData=this.seriesData.slice(0,o)}else this.categoriesData=this.categoriesData.slice(this.categoriesData.length-this.numOfBars,this.categoriesData.length),this.seriesData=this.seriesData.slice(this.categoriesData.length-this.numOfBars,this.categoriesData.length);this.xScale=n.scale.ordinal().rangeRoundBands([0,(this.numOfBars+1)*this.getValueByScreenWidth(i.width+i.space)],1),this.yScale=n.scale.linear().range([this.getValueByScreenWidth(this.options.maxBarHeight)-this.MIN_BAR_HEIGHT,0]),this.xAxis=n.svg.axis().scale(this.xScale).outerTickSize(0),this.yAxisScale=n.scale.linear().range([this.getValueByScreenWidth(this.options.yAxisHeight),0]),this.yAxis=n.svg.axis().scale(this.yAxisScale).orient("left").innerTickSize(-this.width).outerTickSize(0).ticks(5)},renderChart:function(t){this.config;this.minVal=0,this.maxVal=n.max(this.seriesData,function(t){return Math.abs(parseFloat(t.value))}),this.xScale.domain(this.categoriesData.map(function(t){return t})),this.yScale.domain([this.minVal,this.maxVal]),this.hasMinVals=!1,this.seriesMinVal=n.min(this.seriesData,function(t){return parseFloat(t.value)}),this.seriesMinVal<0&&(this.hasMinVals=!0,this.maxPositiveVal=n.max(this.seriesData,function(t){return parseFloat(t.value)}),this.maxNegativeBarHeight=this.options.maxBarHeight-this.yScale(Math.abs(this.seriesMinVal)),this.maxPositiveBarHeight=this.options.maxBarHeight-this.yScale(this.maxPositiveVal)),this.svg=this.renderSVGBase(t),this.renderGradient(),this.renderFilter(),this.renderYAxis(),this.hasMinVals&&this.renderYAxis(!0),this.options.hasOwnProperty("isDesktop")&&this.options.isDesktop&&this.renderAccessibilityHiddenRects(),this.renderVerticalBars(),this.renderLabels(),this.renderXAxis()},renderSVGBase:function(t){var e=this.getValueByScreenWidth(this.options.svgHeight),s=0;return this.hasMinVals&&(e+=this.getValueByScreenWidth(this.maxNegativeBarHeight+this.options.barTop),s=this.getValueByScreenWidth(this.maxPositiveBarHeight-this.options.maxBarHeight)),n.select(t.get(0)).append("svg").attr("class","perso-svg-chart-container").attr("width",this.width).attr("height",e+s).append("g").attr("class","perso-svg-container-group").attr("transform",function(){return"translate(0,"+s+")"})},renderVerticalBars:function(){var t=this;t.minAbsValue=n.min(t.seriesData,function(t){return Math.abs(t.value)||1/0}),t.maxValue=t.maxVal,t.minValue=t.minVal;var e=t.getValueByScreenWidth(t.options.rectangles.space||30),s=t.getValueByScreenWidth(t.options.rectangles.width),r=(t.width-(t.numOfBars*s+(t.numOfBars-1)*e))/2,i=this.svg.append("g").attr("transform",function(){return"translate("+r+","+t.getValueByScreenWidth(t.options.barTop)+")"}).selectAll("rect").data(t.seriesData).enter().append("rect").attr("class",function(t){var e="perso-bar";return t.selected&&(e+=" selected"),e}).attr("x",function(t,r){return r*(e+s)}).attr("width",function(t,e){return s}).attr("y",function(e,s){return e.value<0?t.getValueByScreenWidth(t.negativeBarTop-t.options.barTop):t.getValueByScreenWidth(t.options.maxBarHeight)}).attr("height",0).attr("rx",function(e){var s=t.options.rectangles.borderRadius.rx?t.options.rectangles.borderRadius.rx:"0";return t.getValueByScreenWidth(s)}).attr("ry",function(e){var s=t.options.rectangles.borderRadius.ry?t.options.rectangles.borderRadius.ry:"0";return t.getValueByScreenWidth(s)}).on("click",function(e,s){"function"==typeof t.handleClick&&t.handleClick(e,s)});this.barsTransition(i)},barsTransition:function(t){var e=this;t.transition().duration(e.options.rectangles.transition.duration).delay(e.options.rectangles.transition.delay).attr("y",function(t){return e.getBarsY(t)}).attr("height",function(t){return e.getBarsHeight(t)})},getBarsHeight:function(t){var e=Math.abs(t.value),s=t.value?this.getValueByScreenWidth(this.options.maxBarHeight)-this.yScale(e):0;return t.barHeight=s,s},getBarsY:function(t){return t.value<0?this.getValueByScreenWidth(this.negativeBarTop-this.options.barTop):this.yScale(t.value)},renderLabels:function(){var t="perso-label perso-label-fadeIn",e=this;if(e.seriesData.length>=6&&(t+=" minimize-font"),this.options.labels.drawLabels){this.svg.append("g").attr("transform",function(){var t=e.options.labelTop?e.getValueByScreenWidth(e.options.labelTop):0;return"translate("+e.calcLeft+","+t+")"}).selectAll().data(e.seriesData).enter().append("text").attr("class",function(e){var s=t;return e.selected&&(s+=" selected"),s}).attr("text-anchor","middle").attr("x",function(t,s){return e.xScale(e.categoriesData[s])}).attr("y",function(t){return e.getLabelsY(t)}).attr("dy",function(t){return t.value<0?"1em":0});var r=this.svg.selectAll(".perso-label").append("tspan");s.each(r[0],function(t,r){var n=s(e.seriesData[t].label)[0].attributes;s.each(n,function(t,e){r.setAttribute(e.name,e.value)}),s(r).attr("perso-index",t);var i=s(s(e.seriesData[t].label)[0]).children();s.each(i,function(r,n){var i=e.svg.select('[perso-index="'+t+'"]').append("tspan").text(s(n).text()),a=n.attributes;s.each(a,function(t,e){i.attr(e.name,e.value)})})})}},getLabelsY:function(t){return t.value<0?this.getValueByScreenWidth(this.options.barTop-this.options.labelTop+this.negativeBarTop-this.options.labelTop)+t.barHeight:this.yScale(0)-t.barHeight+this.MIN_BAR_HEIGHT},renderXAxis:function(){var t=this;this.xAxis&&this.svg.append("g").attr("class","x axis").attr("transform",function(e,s){return"translate("+t.calcLeft+","+t.getValueByScreenWidth(t.options.xAxisTop)+")"}).call(t.xAxis).selectAll(".tick text").data(t.seriesData).attr("y","0").attr("class",function(t,e){var s="perso-xAxis-label";return t.selected&&(s+=" selected"),0===t.value&&(s+=" perso-unclickable"),s})},renderAccessibilityHiddenRects:function(){var t=this,e=t.getValueByScreenWidth(3*t.options.rectangles.width+(t.options.rectangles.paddingRight||0)),s=t.getValueByScreenWidth(t.options.svgHeight-(t.options.labelTop||0)),r=t.getValueByScreenWidth(t.options.rectangles.space||30),n=t.getValueByScreenWidth(t.options.rectangles.width),i=(t.width-(t.numOfBars*n+(t.numOfBars-1)*r))/2,a=this.seriesData.slice().reverse();this.svg.append("g").attr("class","perso-hidden-rects").attr("transform",function(e,s){t.options.rectangles.marginLeft&&t.options.rectangles.marginLeft;return"translate("+i+","+t.getValueByScreenWidth(t.options.barTop-t.options.yAxisTop)+")"}).selectAll("g").data(a).enter().append("rect").attr("class",function(t){var e="access-hidden-rect";return 0===t.value&&(e+=" perso-unclickable"),e}).attr("height",function(t,e){return s}).attr("width",e).attr("x",function(s,i){return(t.seriesData.length-1-i)*(r+n)-e/3}).attr("fill-opacity",0)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.PinGraphChartHelper=e.utils.d3Helpers.VerticalChartHelper.extend({})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.HorizontalChartHelper=e.utils.d3Helpers.BlockHelperBase.extend({prepareChart:function(t){},renderChart:function(){}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.MultiHorizontalChartHelper=Base.extend({localConfigs:{barFillPercent:.55},prepareMultiHorizontalChart:function(t,e){this.prepareChart(t,e),this.maxDataArraLength=this.getMaxDataArray(t.layoutInstructions.series),this.height=t.options.chartHeight||this.maxDataArraLength*t.layoutInstructions.series.length*(this.getValueByScreenWidth(t.options.rectangles.height)+2*this.getValueByScreenWidth(this.options.rectangles.paddingBottom))+t.layoutInstructions.seriesLabels.length*this.options.rectangles.seriesPadding/2,this.localConfigs.barFillPercent=this.options.rectangles.barFillPercent?this.options.rectangles.barFillPercent:this.localConfigs.barFillPercent,this.xScale=n.scale.linear().range([0,this.width*this.localConfigs.barFillPercent]),this.colorScale=n.scale.ordinal().rangeRoundBands([0,this.width],.1);var s=t.defaultConfig.barGraphPalette,r=t.defaultConfig.barGraphLabelsPalette;this.colors=this.colorScale.range(s),this.colorsLabels=n.scale.ordinal().rangeRoundBands([0,this.width],.1).range(r),this.y0Scale=n.scale.ordinal().domain(n.range(t.layoutInstructions.categories.length)).rangeBands([this.height,0],.05),this.y1Scale=n.scale.ordinal().domain(n.range(t.layoutInstructions.series.length)).rangeBands([this.y0Scale.rangeBand(),0],.05),this.y2Scale=n.scale.ordinal().domain(t.layoutInstructions.categories).rangeBands([0,this.height]),this.xAxis=n.svg.axis().scale(this.xScale).orient("bottom"),this.yAxis=n.svg.axis().scale(this.y2Scale).orient("right")},renderMultiHorizontalChart:function(t,e,s){t.config;var r=this.xScale,i=this.y0Scale,a=this.y1Scale;this.y2Scale;r.domain([0,n.max(s.series,function(t){return n.max(t,function(t){return t.value})})]),this.svg=this.renderSVGBase(e,"multiHorizontal"),this.renderGradient(),this.renderFilter(),this.renderMultiHorizontalBars(t,s,r,a,i),this.renderHorizontalLines(s,r,i,a),this.renderLabels(s,r,i,a),this.renderYAxis()},renderSVGBase:function(t,e){return e||(e=""),n.select(t.get(0)).append("svg").attr("focusable",!1).attr("class","perso-svg-chart-container "+e).attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate("+this.getValueByScreenWidth(this.margin.left)+","+this.getValueByScreenWidth(this.margin.top)+")")},renderMultiHorizontalBars:function(t,e,s,r,i){var a=["Out","In"],o=this,l=[].concat.apply([],e.series);o.minValue=n.min(l,function(t){return t.value||1/0}),o.maxValue=n.max(l,function(t){return t.value});var c=this.svg.append("g").attr("transform",function(t,e){var s=o.getValueByScreenWidth(o.options.rectangles.paddingTop);return"translate("+o.getValueByScreenWidth(o.options.rectangles.paddingLeft)+","+s+")"}).attr("width",o.width).selectAll("g").data(e.series).enter().append("g").style("fill",function(t,e){return o.colors(e)}).attr("class",function(t,e){return a[e]}).attr("transform",function(t,e){screen.width;var s=o.options.rectangles.paddingBottom;return"translate(0,"+(s=r(e)*(e+1)+o.getValueByScreenWidth(s)*(e+1))+")"}).selectAll("rect").data(function(t){return t});c.enter().append("rect").attr("class",function(t){var e="perso-chart-rect";return t.selected&&(e+=" selected"),e}).attr("height",function(t,e){var s=o.options.rectangles.height;return o.getValueByScreenWidth(s)}).attr("y",function(t,e){return i(e)}).attr("width",1).attr("rx",function(t){var e=o.options.rectangles.borderRadius.rx?o.options.rectangles.borderRadius.rx:"0";return o.getValueByScreenWidth(e)}).attr("ry",function(t){var e=o.options.rectangles.borderRadius.ry?o.options.rectangles.borderRadius.ry:"0";return o.getValueByScreenWidth(e)}).on("click",function(e,s){t&&t.handleClick(e,s)}),c.transition().duration(1e3).delay(500).attr("width",function(t){var e=.166*(.4*o.width),r=o.minValue,n=o.maxValue,i=t.value,a=s(i),l=e;return i/n>.166||i>r?l+=a:0==i&&(l=a),l})},renderLabels:function(t,e,s,r){var n=this;this.options.drawLabels&&this.svg.append("g").attr("transform",function(t,e){var s=n.getValueByScreenWidth(n.options.rectangles.paddingTop);return"translate("+n.getValueByScreenWidth(n.options.rectangles.paddingLeft)+","+s+")"}).attr("width",n.width).selectAll("g").data(t.series).enter().append("g").attr("transform",function(t,e){var s=n.options.rectangles.paddingBottom;return"translate(-7,"+(s=r(e)*(e+1)+n.getValueByScreenWidth(s)*(e+1))+")"}).selectAll("text").data(function(t){return t}).enter().append("text").attr("class",function(t){var e="perso-label perso-label-fadeIn";return t.selected&&(e+=" selected"),e}).attr("text-anchor","start").style("fill",function(t,e,s){return n.colorsLabels(s)}).attr("x",function(t){var s=n.options.labels.paddingLeft?n.options.labels.paddingLeft:"0";return e(t.value)+n.getValueByScreenWidth(s)}).attr("y",function(t,e){return s(e)+n.options.rectangles.height/2}).attr("dy","0.4em").html(function(t){return t.label})},renderYAxis:function(){if(this.yAxis){var t=this.getValueByScreenWidth(this.options.axis.yAxis.transValue);this.svg.append("g").attr("transform","translate("+-1*this.options.axis.yAxis.paddingRight+","+t+")").attr("class","y axis").call(this.yAxis).selectAll(".tick text").call(this.wrapLabelText,.23*screen.width)}this.options.axis.yAxis.hide&&(this.svg.selectAll(".y .tick text").remove(),this.svg.selectAll(".y path").remove())},getMaxDataArray:function(t){var e=0;return t.length&&s.each(t,function(t,s){s.length>e&&(e=s.length)}),e},wrapLabelText:function(t,e){t.each(function(){var t=n.select(this),s=0,r=1;this.getComputedTextLength()>e&&(r=2,s=-5);for(var i,a=t.text().split(/\s+/).reverse(),o=[],l=0,c=(t.attr("y"),parseFloat(t.attr("dy"))),u=t.text(null).append("tspan").attr("x",9).attr("y",s*r).attr("dy",c+"em");i=a.pop();)o.push(i),u.text(o.join(" ")),u.node().getComputedTextLength()>e&&(o.pop(),u.text(o.join(" ")),o=[i],u=t.append("tspan").attr("x",9).attr("y",s*r).attr("dy",.95*++l*1.5+c+"em").text(i))})},prepareChart:function(t,e){this.options=t.options,this.totalWidth=e.width(),this.margin={top:this.getValueByScreenWidth(this.options.margin.top),right:this.getValueByScreenWidth(this.options.margin.right),bottom:this.getValueByScreenWidth(this.options.margin.bottom),left:this.getValueByScreenWidth(this.options.margin.left)},this.width=e.width()-this.margin.left-this.margin.right},renderHorizontalLines:function(t,e,s,r){this.svg.append("g").attr("transform","translate("+-1*this.margin.left+",0)").selectAll("g").data(t.series).enter().append("g").attr("class","perso-chart-line").attr("transform",function(t,e){return"translate(0,"+r(e)*(e+1)+")"}).selectAll(".line").data(function(t){return t}).enter().append("line").attr("class","perso-chart-line").attr("x1","0").attr("x2",this.totalWidth).attr("y1",function(t,e){return s(e)}).attr("y2",function(t,e){return s(e)})},renderGradient:function(){var t=this.options.rectangles.gradients,e=this.svg.append("defs");t&&s.each(t,function(t,s){s&&((e=e.append("linearGradient").attr("id",s.id).attr("x1","0").attr("x2","0").attr("y1","0").attr("y2","1")).append("stop").attr("offset",s.offset1).attr("stop-color",s.stopColor1),e.append("stop").attr("offset",s.offset2).attr("stop-color",s.stopColor2))})},renderFilter:function(){var t=this.options.rectangles.filter,e=this.svg.selectAll("defs");t&&s.each(t,function(t,s){if(s){var r=e.append("filter").attr("id",s.id);r.append("feGaussianBlur").attr("in",s.in).attr("stdDeviation",s.stdDeviation),r.append("feOffset").attr("dx",s.dxOffset).attr("dy",s.dyOffset);var n=r.append("feMerge");n.append("feMergeNode"),n.append("feMergeNode").attr("in",s.in)}})},getValueByScreenWidth:function(e){var r=s(t).width();return r>=790?e:r<347?e:r>=414?e*this.options.screen.ratio_large:e*this.options.screen.ratio_medium}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){var n=e.persoD3||t.d3;e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.LineChartHelper=Base.extend({prepareChart:function(t,e){this.options=e,this.seriesData=t.series,this.categoriesData=t.categories,this.graphWidth=this.getValueByScreenWidth(this.options.line_width),this.graphHeight=this.getValueByScreenWidth(this.options.line_height),this.xScale=n.time.scale().range([0,this.graphWidth]),this.yScale=n.scale.linear().range([this.graphHeight,0]),this.setXscaleAndYscaleDomain(),this.initAxes()},setXscaleAndYscaleDomain:function(){var t=n.min(this.seriesData,function(t){return parseFloat(t.value)}),e=n.max(this.seriesData,function(t){return parseFloat(t.value)}),s=n.min(this.categoriesData,function(t){return new Date(t.value)}),r=n.max(this.categoriesData,function(t){return new Date(t.value)});this.xScale.domain([s,r]),this.yScale.domain([t,e])},initAxes:function(){var t=this,e=this.categoriesData.map(function(t){return new Date(t.value)});this.xAxis=n.svg.axis().scale(this.xScale).orient("bottom").innerTickSize(this.getValueByScreenWidth(this.options.xAxis_line_height+this.options.xAxis_line_y)).tickValues(e).tickFormat(function(e){var s=n.time.format("%m-/%d-/%Y");return t.categoriesData.forEach(function(t,r){new Date(t.value).getTime()==e.getTime()&&(s=t.label)}),s}),this.yAxis=n.svg.axis().scale(this.yScale).ticks(5).orient("left")},renderChart:function(t){this.svg=this.renderSVGBase(t),this.renderXAxis(),this.renderYAxis(),this.renderArea(),this.renderHorizonalLine(),this.graph=this.renderGraph(),this.renderLine(),this.renderLabels(),this.renderDots()},renderSVGBase:function(t){var e=this.getValueByScreenWidth(this.options.svgWidth),s=this.getValueByScreenWidth(this.options.svgHeight);return n.select(t.get(0)).append("svg").attr("class","perso-svg-chart-container").attr("width",e).attr("height",s).append("g").attr("transform","translate(0,0)")},renderXAxis:function(){var t=this.getSelectedMonth();if(this.options.xAxis_display){var e=this.svg.append("g").attr("name","x axis").attr("class","perso-line-x axis").call(this.xAxis);e.selectAll(".perso-line-x.axis line").attr("x1",this.getValueByScreenWidth(this.options.xAxis_line_x)).attr("x2",this.getValueByScreenWidth(this.options.xAxis_line_x)).attr("y1",this.getValueByScreenWidth(this.options.xAxis_line_y)),e.selectAll(".perso-line-x.axis text").attr("y",this.getValueByScreenWidth(this.options.xAxis_text_y)).attr("x",this.getValueByScreenWidth(this.options.xAxis_text_x)).attr("class",function(e){var s="tick";return e.getTime()==t.getTime()&&(s="highlighted-text"),s})}},renderYAxis:function(){this.options.yAxis_display&&this.svg.append("g").attr("name","y axis").attr("class","perso-line-y axis").attr("transform","translate("+this.getValueByScreenWidth(this.options.yAxis_x)+","+this.getValueByScreenWidth(this.options.yAxis_y)+")").call(this.yAxis).selectAll("text").style("text-anchor","end").attr("x","0")},renderGraph:function(){return this.svg.append("g").attr("name","graph").attr("transform","translate("+this.getValueByScreenWidth(this.options.line_left)+","+this.getValueByScreenWidth(this.options.line_top)+")").attr("width",this.graphWidth).attr("height",this.graphHeight)},renderLine:function(){var t=this;this.line=n.svg.line().interpolate(this.setInterpolate(this.options.lineStyle_interpolate)).x(function(e){return t.xScale(new Date(e.category))}).y(function(e){return t.yScale(e.value)}),this.graph.append("g").attr("name","line").append("path").datum(this.seriesData).attr("class","perso-line").attr("stroke-width",this.getValueByScreenWidth(this.options.lineStyle_thickness)).attr("d",this.line).transition().duration(this.options.duration).attrTween("stroke-dasharray",function(){var t=this.getTotalLength();return function(e){return n.interpolateString("0,"+t,t+",0")(e)}})},renderDots:function(){var t=this;this.graph.append("g").attr("name","dots").selectAll("dot").data(this.seriesData).enter().append("circle").filter(function(e){return t.isDateInCategories(e.category)}).attr("cx",function(e){return t.xScale(new Date(e.category))}).attr("cy",function(e){return t.yScale(e.value)}).attr("class",function(t){var e="perso-dot";return t.highlight&&(e="perso-dot-selected"),e}).attr("r",0).transition().delay(this.options.duration).attr("r",this.getValueByScreenWidth(this.options.dots_radius)),this.graph.select("circle.perso-dot-selected").attr("r",0).transition().delay(this.options.duration).attr("r",this.getValueByScreenWidth(this.options.dots_radius_selected))},renderLabels:function(){var t=this,e=this.getSelectedMonth(),r=[];if(this.options.labels_display){this.svg.append("g").attr("name","labels").attr("transform","translate("+this.getValueByScreenWidth(this.options.labels_x)+","+this.getValueByScreenWidth(this.options.line_top-(this.options.labels_y+this.options.dots_radius))+")").selectAll().data(t.seriesData).enter().append("text").filter(function(e){return t.isDateInCategories(e.category)&&r.push(e),t.isDateInCategories(e.category)}).attr("class",function(t){var s="perso-label";return new Date(t.category).getTime()==e.getTime()&&(s+=" perso-label-selected"),s}).attr("text-anchor","middle").attr("x",function(e,s){return t.xScale(new Date(e.category))}).attr("y",function(e){return t.yScale(e.value)}).attr("dy",function(t){return t.value<0?"1em":0}).attr("opacity",0).transition().delay(this.options.duration).attr("opacity",1);var n=this.svg.selectAll(".perso-label").append("tspan");s.each(n[0],function(e,n){var i=s(r[e].label)[0].attributes;s.each(i,function(t,e){n.setAttribute(e.name,e.value)}),s(n).attr("perso-index",e);var a=s(s(r[e].label)[0]).children();s.each(a,function(r,n){var i=t.svg.select('[perso-index="'+e+'"]').append("tspan").text(s(n).text()),a=n.attributes;s.each(a,function(t,e){i.attr(e.name,e.value)})})})}},renderArea:function(){var t=this;if(this.options.area_display){var e=n.scale.linear().rangeRound([this.graphHeight,0]);this.area=n.svg.area().interpolate(this.setInterpolate(this.options.lineStyle_interpolate)).x(function(e){return t.xScale(new Date(e.category))}).y1(function(e){return t.yScale(e.value)}).y0(e(0)),this.svg.append("path").attr("transform","translate("+this.getValueByScreenWidth(this.options.line_left)+","+this.getValueByScreenWidth(this.options.line_top)+")").datum(this.seriesData).attr("d",this.area).attr("class","perso-line-area").attr("opacity",0).transition().delay(this.options.duration).attr("opacity",1)}},renderHorizonalLine:function(){this.options.horizonalLine_display&&this.svg.append("line").attr("name","horizonal-line").attr("class","perso-horizonal-line").attr("x1",this.getValueByScreenWidth(this.options.horizonalLine_x)).attr("x2",this.getValueByScreenWidth(this.options.horizonalLine_x+this.options.horizonalLine_length)).attr("y1",this.getValueByScreenWidth(this.options.horizonalLine_y)).attr("y2",this.getValueByScreenWidth(this.options.horizonalLine_y))},getSelectedMonth:function(){var t=new Date,e=this.setHighlightDot();return void 0!==e&&void 0!==this.seriesData[e]&&null!==this.seriesData[e]&&(t=new Date(this.seriesData[e].category)),t},isDateInCategories:function(t){var e=this.categoriesData,s=!1;return null!=t&&e.forEach(function(e,r){e.value==t&&(s=!0)}),s},setHighlightDot:function(){var t=this,e="max",s="min",r="first",i=n.max(this.seriesData,function(e){if(t.isDateInCategories(e.category))return parseFloat(e.value)}),a=n.min(this.seriesData,function(e){if(t.isDateInCategories(e.category))return parseFloat(e.value)}),o=t.options.highlightBy,l=t.seriesData.length-1;switch(o){case e:var c=t.getObjIndexByValue(t.seriesData,i);t.seriesData[c].highlight=!0,l=c;break;case s:var u=t.getObjIndexByValue(t.seriesData,a);t.seriesData[u].highlight=!0,l=u;break;case r:t.seriesData[0].highlight=!0,l=0;break;default:var d=t.seriesData.length-1;t.seriesData[d].highlight=!0}return l},getObjIndexByValue:function(t,e){return s.map(t,function(t,s){if(t.value==e)return s})[0]},setInterpolate:function(t){var e="linear",s="monotone",r="cardinal";switch(t){case s:r=s;break;case e:r=e}return r},getValueByScreenWidth:function(e){var r=s(t).width();return r>=790?e:r<347?e:r>=414?e*this.options.screen.ratio_large:e*this.options.screen.ratio_medium},renderAccessibilityData:function(t,e){this.texts=e;var s=t.parents(".pstory-dialog-frame").attr("id")+t.index(),r=this.getAccessibilityTitle()+". "+this.prepareAccessibilityText(),i=t.find(".perso-svg-chart-container")[0];n.select(i).append("title").attr("id",s+"_title").text(r),n.select(i).attr("role","presentation"),this.svg.attr("aria-labelledby",s+"_title"),this.svg.selectAll("*").attr("aria-hidden",!0)},filterSeriesByCategories:function(){for(var t=this.categoriesData,e=this.seriesData,s=[],r=0;r<t.length;r++)for(var n=0;n<e.length;n++)if(e[n].category===t[r].value){var i={label:t[r].label,value:e[n].value};e[n].highlight&&(i.highlight=!0),s.push(i);break}return s},prepareAccessibilityText:function(){var t=this,e="",r=this.filterSeriesByCategories().slice().reverse();return s.each(r,function(s,r){r.highlight&&(e=t.getAccessibilityHighlightedDotlbl()+", "+r.label+", "+Math.round(r.value)+",")}),s.each(r,function(t,s){s.highlight||(e+=" "+s.label+", "+Math.round(s.value)+",")}),e},getAccessibilityTitle:function(){return this.texts.accessibilityLineChartTitle},getAccessibilityHighlightedDotlbl:function(){return this.texts.accessibilityLineGraphHighlightedDot}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.VerticalChartHelperProduct=e.utils.d3Helpers.VerticalChartHelper.extend({renderXAxis:function(){var t=this;this.xAxis&&this.svg.append("g").attr("class","x axis").attr("transform",function(e,s){var r=t.getValueByScreenWidth(t.options.xAxisTop);return"translate("+t.calcLeft+","+r+")"}).call(t.xAxis).selectAll(".tick text").data(t.seriesData).attr("y","0").attr("class",function(t){var e="perso-xAxis-label";return t.selected&&(e+=" selected"),e}).on("click",function(e,s){"function"==typeof t.handleClick&&t.handleClick(e,s)})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.d3Helpers=e.utils.d3Helpers?e.utils.d3Helpers:{},e.utils.d3Helpers.PinGraphChartHelperProduct=e.utils.d3Helpers.VerticalChartHelperProduct.extend({})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.utils=e.utils?e.utils:{},e.utils.carouselAnimation={},e.utils.carouselAnimation.bindCarouselEventsForAnimation=function(r,n){var i,a,o,l={};function c(t,e){void 0===t&&(t=o.filter(":not(.selected)").outerWidth(!0)),void 0===e&&(e=o.filter(".selected").outerWidth(!0)),l.itemWidth=t,l.selectedItemWidth=e;var n=0,c=-1;if(s.each(o,function(t,e){s(e).hasClass("selected")&&(c=t)}),-1==c){c=0;var u=o.first().attr("pstory-id");a.filter("[pstory-id='"+u+"']").addClass("selected")}var d=o.length;d>1&&(n-=t*(d-1),n-=e);var p=(n+=(r.width()-e)/2)-t*c;l.minLeft=n,i.css({"transition-duration":"0s","-webkit-transition-duration":"0s"}),i.css({left:p+"px"})}function u(t){"number"==typeof t&&(l.numItemsDispaly=t,t>o.length?a.filter("[clone='true']").addClass("carousel-hide-clone"):a.removeClass("carousel-hide-clone"))}function d(e){"function"==typeof n.beforeCarouselStart&&n.beforeCarouselStart(e),function(e,r){var c=e.currentTarget;if(s(c).hasClass("selected")||1==l.disableInputSelect)return;var u=l.swipeDirection;null==u&&(u=s(c).hasClass("prev")?1:-1);l.disableInputSelect=!0,a.removeClass("selected"),a.removeClass("prev"),a.removeClass("next");var d=s(c).attr("pstory-id");a.filter('[pstory-id="'+d+'"]').addClass("selected"),"number"!=typeof r&&(r=300);var p=o.length,f=l.minLeft,g=f-(l.itemWidth*(p-1)+l.selectedItemWidth),y=0;y=parseFloat(i.css("left"));var m=l.itemWidth*u+y,v=l.selectedItemWidth-l.itemWidth,b=s(c).index(),x=i.find(".carousel-item:lt("+b+")").filter(".selected").length;x>1?m-=v:0==x&&(m+=v);setTimeout(function(){i.css({"transition-duration":"0s","-webkit-transition-duration":"0s"}),Math.abs(m)>=Math.abs(g)-v?i.css({left:f+"px"}):Math.abs(m)<Math.abs(f)-v&&(g=g+l.itemWidth+v,i.css({left:g+"px"})),l.disableInputSelect=!1,"function"==typeof n.afterCarouselEnd&&n.afterCarouselEnd()},r),i.css({"transition-duration":r+"ms","-webkit-transition-duration":r+"ms"}),i.css({left:m+"px"}),l.swipeDirection=null,h(),function(e){var r=n&&n.isDesktop?null:s(".pstory-account-button.selected");r&&r.length<1&&a.filter(".selected:not([clone='true'])");var i=10+e;r&&(r.attr("tabindex","0"),r.blur());t.setTimeout(function(){r&&r.focus(),n&&n.onAnimationEnd&&n.onAnimationEnd()},i)}(r)}(e,n.animateDuration),n.showIndexDots&&this.dotAnimation.updateIndex(e)}function p(t){if(s(r).hasClass("carousel-disable")||this.disableInputSelect)n&&n.onAnimationEnd&&n.onAnimationEnd();else if("left"==t||"right"==t){var e=a.length,i=o.filter(".selected").index(),c="left"==t?1:-1;if((i+=c)==e&&(i=0),i<0&&(i=e-1),o.length<l.numItemsDispaly&&"true"==s(a[i]).attr("clone"))return l.swipeDirection=null,void(n&&n.onAnimationEnd&&n.onAnimationEnd());l.swipeDirection=-1*c;var u={};u.swipeDirection=t,u.currentTarget=a[i],d(u)}}function h(){var t=a.filter(".selected:not([clone='true'])");t.siblings().attr("aria-hidden",!0),t.attr("aria-hidden",!0),t.prev().addClass("prev"),t.next().addClass("next"),t.prev().addClass("prev"),t.next().addClass("next"),a.removeAttr("aria-label"),void 0!==n.text&&(void 0!==n.text.next&&t.next().attr("aria-label",n.text.next),void 0!==n.text.prev&&t.prev().attr("aria-label",n.text.prev))}function f(t){n.carouselDisable=t}!function(){i=s(r).find(".carousel-inner-wrapper"),o=i.find(".carousel-item"),i.attr("num-original-cards",o.length),void 0===n&&(n={});void 0!==n.itemWidth&&(l.itemWidth=n.itemWidth);void 0!==n.selectedItemWidth&&(l.selectedItemWidth=n.selectedItemWidth);void 0===n.numItemsDispaly&&(n.numItemsDispaly=3);if(o.length>1){var t=o.clone(!0);t.attr("clone","true");var g=t.clone(!0);i.prepend(s(t)),i.append(s(g).slice(0,2))}a=i.find(".carousel-item"),c(l.itemWidth,l.selectedItemWidth),this.dotAnimation=new e.utils.DotAnimation.bindDotEventsForAnimation(r,o,n),this.dotAnimation.setSelectedDot(),u(n.numItemsDispaly),function(){!1!==n.onClick&&a.bind("click",function(t){0==s(r).hasClass("carousel-disable")&&d(t)});!1!==n.onSwipe&&(n.swipeSelector?s(r).find(n.swipeSelector).swipe(function(t){0==s(r).hasClass("carousel-disable")&&p(t)},{preventDefault:!1}):s(r).swipe(function(t,e){if(void 0!==n.disableSwipeAreaSelector&&null!==n.disableSwipeAreaSelector&&n.disableSwipeAreaSelector.length>0){var i=s(r).find(n.disableSwipeAreaSelector),a=i.offset();if("undefiend"!=typeof a&&null!==a&&e.clientY>a.top&&e.clientY<a.top+i.height())return}if(0==s(r).hasClass("carousel-disable")){if(1==n.carouselDisable)return;"right"!=t&&"left"!=t||f(!0),p(t)}},{preventDefault:!1}))}(),h()}(),this.setCarouselDisable=f,this.setConfig=c,this.setNumItemsToDispaly=u,this.onSwipe=p}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.PBlockRenderer=e.story.PCtrlBase.extend({initialize:function(t,s){e.story.PCtrlBase.prototype.initialize.call(this),this.parent=t,this.uxCtrl=null!=s?s:new e.story.skinController,this.uxCtrl.setStory(this),this.uxCtrl.registerBlocks(),this.templates={}},renderBlocks:function(t,r){this.layoutInstructions=r;var n=this;s(t).empty(),s.each(this.layoutInstructions,function(s,r){r.type;var i=e.story.PBlockFactory.createBlock(n,r,n);i&&(i.beforeRender(t,r),i.render(t,r),i.afterRender(t),i.bindEvents())})},notifyEvent:function(t,e,s){this.parent.notifyEvent(t,e,s)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{};var n=Base.extend({widgetsTextsMap:{},defaultLang:"en",getText:function(t,e,s){var r=s||"",n=r;if(this.widgetsTextsMap.hasOwnProperty(t)){var i=this.widgetsTextsMap[t];n=i[e]||i[this.defaultLang]||r}return n},registerText:function(t,e,s){s=s||this.defaultLang;this.widgetsTextsMap.hasOwnProperty(t)||(this.widgetsTextsMap[t]={}),this.widgetsTextsMap[t][s]=e}});e.UI.PWidgetsTextsFactory=new n}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{},e.UI.PAppCtrl=e.UI.PWidgetCtrl.extend({initialize:function(r){this.super=e.UI.PWidgetCtrl.prototype,this.super.initialize.call(this,r),this.config.parentCtrl=this,this.config.widthMode="",this.widgets={};var n=r.uxCtrl;n||(n=new e.story.skinController),this.uxCtrl=n,this.desktopScreenWidth=this.uxCtrl.getDesktopScreenWidth(),this.screenWidth=s(t).width(),this.screenWidth>this.desktopScreenWidth&&(this.config.widthMode="desktop"),this.setFirstWidgetType(r.widgetType),this.registerTexts()},setFirstWidgetType:function(t){this.firstWidgetType=t||"insights"},addConfigurationClasses:function(){var t=personetics.getDeviceType();this.el.addClass("personetics-device-"+t)},getWidgetEl:function(t){var e=this.el.find("#personetics-"+t);return 0==e.length&&(e=s("<div id='personetics-"+t+"'></div>"),this.el.append(e)),e},start:function(t){t.empty();var r=s("<div class='personetics-widgets-wrapper'></div>");t.append(r),this.el=r,this.addConfigurationClasses();var n=e.UI.PWidgetFactory.createWidget(this.firstWidgetType,this.config);this.widgets[this.firstWidgetType]=n;var i=this.getWidgetEl(this.firstWidgetType);n.start(i)},sendMessage:function(t){var e=t.targetWidget,s=t.message,r=t.arguments,n=this.widgets[e];if(n&&n.hasOwnProperty(s))return n[s].apply(n,r)},startWidget:function(t,s){s.parentCtrl=s.parentCtrl||this,s.widthMode=this.config.widthMode;var r=e.UI.PWidgetFactory.createWidget(t,s);r.start(s.el),r&&(this.widgets[t]=r)},closeLoading:function(){this.sendMessage({targetWidget:"loading-animation",message:"removeLoading"})},startManagement:function(t){var s=t.el,r=new e.UI.PManagementCtrl(t,this);return r.start(s),r},startRatings:function(t){var r=s(".pstory-frame");this.currentRatingsEl=r;var n=new e.UI.PRatingCtrl(t,this);return n.start(r),n},startInbox:function(t){var s=t.el,r=new e.story.PInboxCtrl(t,this);return r.start(s),r},registerTexts:function(){e.dictionary.setLanguage(this.config.lang)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{},e.UI.PAppCtrlProduct=e.UI.PAppCtrl.extend({setFirstWidgetType:function(t){this.firstWidgetType=t||"teaser-widget"},registerTexts:function(){e.UI.PAppCtrl.prototype.registerTexts.call(this)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{},e.UI.PRatingCtrl=e.UI.PWidgetCtrl.extend({initialize:function(t){this.super=e.UI.PWidgetCtrl.prototype,this.super.initialize.call(this,t),this.insight=this.config.insight,this.lang=this.config.lang,this.texts={accessibilityRatingLevelTitle:e.dictionary.getText("accessibilityRatingLevelTitle")},this.ratingTemplate="#tmpl-perso-rating",this.feedbackTemplate="#tmpl-perso-feedback"},start:function(t){this.el=t;var e=this.getRatingTemplate();t.append(e),this.fixRatingElToBottom(),this.sendGetRatings()},getRatingTemplate:function(){var t=e.dictionary.getText("lblstoryRating");return this.getTemplateHtml(this.ratingTemplate,{ratingTitle:t})},fixRatingElToBottom:function(){var t=this.el.find(".perso-ratings-wrapper"),e=t.height()+1;t.height(e);var s=t.outerHeight(!0);this.el.find(".pstory-container").css("minHeight","calc(100% - "+(s-2)+"px)")},sendGetRatings:function(){var s=t.testData?t.testData.ratings:null,r=this;if(s)setTimeout(function(){r.onGetRatigsResponse(s)},500);else{var n={id:this.insight.id};personetics.getInsightRating(n,e.bind(this,this.onGetRatigsResponse),e.bind(this,this.onGetRatingsError))}},onGetRatigsResponse:function(t){var e=t?t.rating:0,s=this.el.find(".perso-ratings-icons");this.id=t.id,this.starRating(s,e),this.afterRender()},onGetRatingsError:function(){this.onError();var t={id:this.insight.id,rating:0};this.onGetRatigsResponse(t)},starRating:function(t,r){var n=this,i=this.insight.id+"_"+this.el.index()+"_rating_";return t.each(function(){for(var a=t,o=0;o<a.data("rating-max");o++){var l=n.createRatingStarElement(o,r,i+o);a.append(l)}var c=a.children("input"),u=0;c.bind("click",{id:n.id,me:n},e.bind(n,n.rateClick)),null!=r&&(u=r,a.attr("data-val",u),s(c[u-1]).attr("checked",!0))})},createRatingStarElement:function(t,e,r){var n=this.texts.accessibilityRatingLevelTitle+" "+(t+1);return s("<input type='radio' id='"+r+"' name='rating' aria-label='"+n+"'/><label for='"+r+"'/>")},afterRender:function(){},rateClick:function(t){this.onRateClick(t),this.feedbackStart()},onRateClick:function(e){var r=e.currentTarget,n=s(r).index(".perso-ratings-icons input[type='radio']")+1;s("li:lt("+n+")",s(r).parent("ul")).addClass("perso-hover"),s("li:gt("+s(r).index()+")",s(r).parent("ul")).removeClass("perso-hover"),s(r).closest("[data-val]").attr("data-val",n),this.eventObj={id:e.data.id,rating:n};var i=t.testData?t.testData.ratingsResponse:null;if(i){setTimeout(function(){e.data.me.onSuccesRate(i)},500)}else personetics.updateInsightRating(this.eventObj,e.data.me.onSuccesRate,e.data.me.onError)},feedbackStart:function(){if(1==e.projectConfiguration.getConfig("showFeedback"))if(this.disableFeedBack){if(this.el.find(".perso-feedback-text").length>0&&""==this.el.find(".perso-feedback-text").val()){var t=e.dictionary.getText("lblfeedbackprompt"+this.eventObj.rating);this.el.find(".perso-feedback-text").attr({placeholder:t,"aria-label":t})}}else this.showFeedback()},onSuccesRate:function(t){e.log("rating succes")},onError:function(){e.log("rating error")},showFeedback:function(){this.el.find(".perso-feedback-wrapper").remove(),this.disableFeedBack=!0;var t=e.dictionary.getText("lblfeedbackprompt"+this.eventObj.rating),r=e.dictionary.getText("lblreactionFeedback"),n=e.dictionary.getText("btnsubmit"),i=this.getTemplateHtml(this.feedbackTemplate,{lblfeedbackprompt:t,lblreactionFeedback:r,btnsubmit:n});this.el.append(i);var a=this.el.find(".perso-feedback-submit");a.css("margin-left","calc(100% - "+a.outerWidth()+"px)"),a.bind("click",{id:this.insight.id,widget:this},e.bind(this,this.sendFeedback)),a.hide(),this.el.find(".perso-feedback-reaction").hide();var o=this.el.find(".perso-feedback-wrapper");this.scrollToEnd(this.el,o),this.feedbackText=this.el.find(".perso-feedback-text"),this.textareaSize=this.el.find(".textarea-size");var l=e.bind(this,this.feedbackTextFocus);s(this.feedbackText).bind("focus",l);var c=e.bind(this,this.feedbackTextBlur);s(this.feedbackText).bind("blur",c),this.textareaSize.text(this.feedbackText.value+"\n");var u=e.bind(this,this.feedbackTextInput);s(this.feedbackText).bind("input",u)},feedbackTextBlur:function(t){var s=this,r=e.dictionary.getText("lblfeedbackprompt"+this.eventObj.rating);0==this.value&&(s.el.find(".perso-feedback-submit").hide(),s.feedbackText.removeClass("direction-text"),s.feedbackText.addClass("direction-text-center"),s.feedbackText.attr("placeholder",r)),setTimeout(function(){s.parentCtrl.enableCollapse=!0},800)},feedbackTextInput:function(t){this.el.find(".perso-feedback-wrapper");this.textareaSize.text(t.target.value+"\n"),this.el.scrollTop(this.el[0].scrollHeight)},feedbackTextFocus:function(t){this.el.find(".perso-feedback-wrapper");this.feedbackText.removeClass("direction-text-center"),this.feedbackText.addClass("direction-text"),this.feedbackText.attr("placeholder",""),this.el.find(".perso-feedback-submit").show(),this.el.scrollTop(this.el[0].scrollHeight),this.parentCtrl.enableCollapse=!1},scrollToEnd:function(t,e){e.length>0&&s(t).animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()},500)},sendFeedback:function(t){var e=this.el.find(".perso-feedback-text").val();void 0!==e&&e.length>0&&(this.eventObj={id:t.data.id,feedback:e},personetics.updateInsightFeedback(this.eventObj,t.data.widget.onSuccesFeedback,t.data.widget.onErrorFeedback)),this.showFeedbackReaction()},onSuccesFeedback:function(t){e.utils.PLogger.debug("feedback succes")},onErrorFeedback:function(){e.utils.PLogger.debug("feedback error")},showFeedbackReaction:function(){var t=this,e=this.el.find(".perso-feedback-wrapper").height();this.el.find(".perso-feedback-wrapper").height(e),this.el.find(".perso-feedback-reaction").show(),this.el.find(".perso-feedback-wrapper").css("overflow","scroll");var s=this.el.find(".perso-feedback-reaction").outerHeight();this.el.find(".perso-feedback-wrapper").animate({scrollTop:150,height:s},400,function(){t.disableFeedBack=!1,t.el.find(".textarea-wrapper").hide()})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{},e.UI.PLoadingAnimationCtrl=e.UI.PWidgetCtrl.extend({initialize:function(t){this.super=e.UI.PWidgetCtrl.prototype,this.super.initialize.call(this,t),this.loadingText=this.getLoadingTxt(t)},getLoadingTxt:function(t){return t.loadingText},start:function(t){this.el=t,this.el.empty();var e=this.loadingText,s=this.getTemplateHtml("#tmpl-perso-loading-animation",{loadingText:e});t.append(s),this.afterRender()},afterRender:function(){this.setHeightToParentSpace()},setHeightToParentSpace:function(){var t=this.el.parent().height(),e=0,r=this.el.siblings();s.each(r,function(t,r){"static"==s(r).css("position")&&(e+=s(r).height())});var n=t-e;this.el.find("#perso-loading-widget").height(n)},removeLoading:function(){this.el.children("#perso-loading-widget").remove()}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{};var n=38,i=40;e.UI.PStoryWidgetCtrl=e.UI.PWidgetCtrl.extend({initialize:function(t){this.super=e.UI.PWidgetCtrl.prototype,this.super.initialize.call(this,t),void 0!==typeof t&&e.utils.PEventReporting.setValue({instanceId:t.insightId,insightId:t.instanceId,userId:t.userId}),this.tmplInnerErrorName="#tmpl-perso-widget-story-error",this.texts={imgClass:"errorImage",textSmall:e.dictionary.getText("inboxTechnicalIssues"),textLarge:e.dictionary.getText("OhNo"),errorText:e.dictionary.getText("storyErrorText"),backButtonText:e.dictionary.getText("accessibilityStoryBackButtonText")},this.showTitle=e.projectConfiguration.getConfig("showTitle"),this.loadingAnimation=e.projectConfiguration.getConfig("showLoadingAnimation")},start:function(t){if(this.parentEl=t,this.el=this.parentEl,this.lang=this.config.lang,this.el.empty(),"desktop"===this.config.widthMode){var s=this;this.el.attr("tabindex","0"),e.utils.accessibility.trackFocus(this.el),this.el.keydown(function(t){if(t.currentTarget===t.target&&(t.keyCode===i||t.keyCode===n)){var e=t.keyCode===i?50:-50;s.el.find(".pstory-frame").animate({scrollTop:s.el.find(".pstory-frame").scrollTop()+e},0,"swing")}})}this.renderTitle(),this.sendGetStory()},renderTitle:function(){if(this.showTitle){var t=this.getTemplateHtml("#tmpl-pstory-title",this.texts),e=s(t);this.el.append(e);var r=e.find(".pstory-title-close"),n=this;r.bind("click",function(){n.closeHandler()}),e.find(".pstory-open-teasers-button").bind("click",function(){n.onShowTeasersButtonClick()})}},sendGetStory:function(){var r=this,n=t.testData&&t.testData.stories?t.testData.stories[this.config.insightId]:null;if(this.loadingAnimation&&this.parentCtrl.startWidget("loading-animation",{el:this.el.find("#story-frame-container")}),n)setTimeout(function(){r.onGetStoryResponse(n)},500);else if("undefined"!=typeof storyData&&(this.config.payload=storyData),void 0!==this.config.payload&&null!=this.config.payload){var i=this.config.payload;if(void 0!==this.config.isPayloadEncoded&&(1==this.config.isPayloadEncoded||"true"==this.config.isPayloadEncoded))try{i=e.utils.encodeDecode.Base64.decode(i),i=s.parseJSON(i)}catch(i){return void this.onError()}r.onGetStoryResponse(i)}else{var a={widgetId:this.widgetId,insightId:this.config.insightId};personetics.getInsightDetails(a,e.bind(this,this.onGetStoryResponse),e.bind(this,this.onError))}},onGetStoryResponse:function(t){this.loadingAnimation&&this.parentCtrl.closeLoading(),this.context="story",this.openStory(t),this.bindEvents()},openStory:function(t){if(t){var r=this.parentEl.find("#story-frame-container");0==r.length&&(r=this.parentEl),this.startStory(t,r);var n=this.el.find(".pstory-title-text");if(n.length>0)this.setVoiceOverFocus(n[0]);else{var i=e.utils.accessibility.firstChildFocusable(s(".pstory-frame"));"undefind"!=typeof i&&this.setVoiceOverFocus(i)}}},startStory:function(t,r){var n=new e.story.PStory({parent:this,lang:this.lang,defaultLang:this.defaultLang,texts:t.text,flowDef:t.story,userId:this.config.userId,expressions:t.expressions,insight:{id:this.config.insightId},data:t.facts,uxCtrl:this.uxCtrl,showTitle:this.showTitle,widthMode:this.widthMode,iconType:this.iconType,resizeHandler:function(t){},onStartHandleEvent:function(t,e){s(e).css("height",s(e).height())},onEndHandleEvent:function(t){s(t).css("height","auto")},openTeasersHandler:e.bind(this,function(){this.onShowTeasersButtonClick()})});n.start(r);var i={el:r.find(".pstory-frame"),insight:n.insight,lang:this.lang};return this.parentCtrl.startWidget("ratings",i),n.addTouchScroll(),n},onError:function(t){this.loadingAnimation&&this.parentCtrl.closeLoading(),e.utils.PLogger.error(t);var s={textSmall:this.texts.textSmall,textLarge:this.texts.textLarge,imgClass:this.texts.imgClass},r=this.parentEl.find("#story-frame-container");0==r.length&&(r=this.parentEl);var n=this.getTemplateHtml(this.tmplInnerErrorName,s);r.append(n),this.bindEvents();var i=this.el.find(".pstory-title-close"),a=this;i.bind("click",function(){"function"==typeof a.closeHandler&&a.closeHandler()})},bindEvents:function(){},closeHandler:function(){var r=personetics.getDeviceType();if(e.API.personetics.eventBuffer&&e.API.personetics.eventBuffer.sendEvents(),"web"===r){this.el.parent().empty();var n=new RegExp("[?&]teasersView=([^&#]*)").exec(t.location.href),i=0;null!=n&&(i=n[1]||0);var a="Carousel"===i?"teaser-widget-carousel":"teaser-widget";"Carousel"===i&&(this.parentCtrl.config.filter=!1),(l=s.extend(!0,{},this.parentCtrl.config)).el=this.parentCtrl.getWidgetEl(a),this.parentCtrl.startWidget(a,l)}else{var o=personetics.getJSBridge();if(o&&s.isFunction(o.sessionEnded)){var l;e.utils.PEventReporting.setValue({type:"ExitInsight",value:"1"}),e.utils.PEventReporting.notifyEvent(),delete(l=s.extend(!0,{},this.parentCtrl.config)).eventType,o.sessionEnded(l)}else e.log("Events Delegate not defined")}},onShowTeasersButtonClick:function(){var t=this.parentCtrl.getWidgetEl("teaser-widget"),e=s.extend(!0,this.parentCtrl.config,{el:t});this.parentCtrl.startWidget("teaser-widget",e)},setVoiceOverFocus:function(e){"desktop"!==this.config.widthMode&&e.setAttribute("tabindex","0");var s=0,r=t.setInterval(function(){e.focus(),++s>=10&&t.clearInterval(r)},10)}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.UI.PStoryWidgetCtrlProduct=e.UI.PStoryWidgetCtrl.extend({initialize:function(t){this.super=e.UI.PStoryWidgetCtrl.prototype,this.super.initialize.call(this,t),this.uxCtrl=new e.story.skinController}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.UI.PStoryWidgetCtrlChase=e.UI.PStoryWidgetCtrlProduct.extend({openStory:function(t){if(t){var s=this.parentEl.find("#story-frame-container");0==s.length&&(s=this.parentEl);var r=this.startStory(t,s),n=this.el.parents("#personetics-story-widget-multi-carousel").find(".pstory-title-text");if(n.length>0)this.setVoiceOverFocus(n[0]);else{var i=e.utils.accessibility.firstChildFocusable(this.el.find(".pstory-frame"));"undefind"!=typeof i&&0!=i&&this.setVoiceOverFocus(i)}var a=r.getTitle();void 0!==this.config.saveStoryConfig&&null!==this.config.saveStoryConfig&&this.config.saveStoryConfig(t,a)}},onError:function(t){e.UI.PStoryWidgetCtrlProduct.prototype.onError.call(this,t),this.parentCtrl.sendMessage({targetWidget:"story-widget-multi-carousel",message:"afterStoryRender",arguments:arguments})}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.UI=e.UI||{},e.UI.PStoryWidgetMultiCtrlChase=e.UI.PWidgetCtrl.extend({initialize:function(t){this.super=e.UI.PWidgetCtrl.prototype,this.super.initialize.call(this,t),this.teasersPayload=t.teasersPayload.slice(),this.opactityDuration=300,this.insightsPayload={},this.params=t,this.tmplInnerErrorName="#tmpl-perso-widget-story-error",this.tmplTitleName="#tmpl-story-widget-multi-title",this.tmplStoryWidgetMulti="#tmpl-story-widget-multi",this.texts=this.getErrorMsgTexts(),this.dataConfig=function(){this.filter=t.filter,this.widgetType="story-widget",this.userId=t.userId},this.dataConfig.prototype.saveStoryConfig=e.bind(this,this.saveStoryConfig)},start:function(t){var e=this.getTemplateHtml(this.tmplTitleName);if(t.empty(),t.append(e),this.el=t,this.teasersPayload!==r&&null!==this.teasersPayload&&""!==this.teasersPayload){"string"==typeof this.teasersPayload&&(this.teasersPayload=JSON.parse(this.teasersPayload));var n=this.getTemplateHtml(this.tmplStoryWidgetMulti);t.append(n),this.carouselParentEl=t,this.multiStoryCarousel=this.carouselParentEl.find(".perso-multi-story-carousel"),this.el=this.carouselParentEl.find(".perso-multi-story-inner-carousel.carousel-inner-wrapper"),this.insightIdArr=this.getInsightIdArr(),1==this.insightIdArr.length&&this.multiStoryCarousel.addClass("carousel-disable"),this.createStoriesWrapper(),this.selectedInsightId=this.params.insightId;var i=s.inArray(this.selectedInsightId,this.insightIdArr);this.currentStoryEl=s(this.el.children()[i]),this.beforeRender(),this.initDots(),this.renderDots(),this.renderStory(),this.bindEvents(),this.calcMultiStoryCarouselHeight()}else this.onError(t)},onError:function(t){var e={textSmall:this.texts.textSmall,imgClass:this.texts.imgClass},s=t.find("#personetics-story-widget-multi-carousel");0==s.length&&(s=t);var r=this.getTemplateHtml(this.tmplInnerErrorName,e);s.append(r),this.bindEvents(t)},getErrorMsgTexts:function(){return{imgClass:"errorImage",textSmall:e.dictionary.getText("inboxTechnicalIssues")}},getInsightIdArr:function(){var t=[];return s.each(this.teasersPayload,function(e,s){s.id;t[e]=s.id}),t},createStoriesWrapper:function(t){var e=this;s.each(this.insightIdArr,function(){e.el.append("<div class='perso-story-template'></div>")})},renderStory:function(){this.currentStoryEl.parents(".carousel-item").attr("aria-hidden",!1);var t=new this.dataConfig;t.insightId=this.selectedInsightId,t.el=this.currentStoryEl,this.insightsPayload[this.selectedInsightId]!==r&&(t.payload=this.insightsPayload[this.selectedInsightId]),this.parentCtrl.startWidget("story-widget",t)},beforeRender:function(){this.addCarouselClasses(),this.bindCarousel()},addCarouselClasses:function(){var t=this.el.find(".perso-story-template"),e=this;t.each(function(t){s(this).wrap('<div class="carousel-item perso-story"></div>');var r=e.insightIdArr[t];s(this).parent().attr("pstory-id",r)}),this.currentStoryEl.parent().addClass("selected")},bindCarousel:function(){var t=this.prepareCarouselParams();this.carouselAnimation=new e.utils.carouselAnimation.bindCarouselEventsForAnimation(this.el.parent(),t)},prepareCarouselParams:function(r){var n=s(t).width();return this.el.children().css("min-width",n),this.el.children().css("max-width",n),{carouselDisable:!1,itemWidth:n,selectedItemWidth:n,numItemsDispaly:this.el.children().length,onClick:!1,disableSwipeAreaSelector:".pstory-block-account-selector",beforeCarouselStart:e.bind(this,this.beforeCarouselStart),afterCarouselEnd:e.bind(this,this.afterCarouselEnd)}},beforeCarouselStart:function(t){var e=this.carouselParentEl.find(".pstory-title-text");e.css({"transition-duration":this.opactityDuration+"ms","-webkit-transition-duration":this.opactityDuration+"ms"}),e.css({opacity:0}),this.el.css({"transition-duration":this.opactityDuration+"ms","-webkit-transition-duration":this.opactityDuration+"ms"}),this.el.css({opacity:0}),this.currentTarget=t.currentTarget,this.swipeDirection=t.swipeDirection},afterCarouselEnd:function(){("right"==this.swipeDirection?s(this.currentTarget).next():s(this.currentTarget).prev()).find(".perso-story-template").empty().css("opacity",1),this.selectedInsightId=this.el.find(".carousel-item.selected").attr("pstory-id"),this.currentStoryEl=s(this.el.find(".carousel-item.selected")[1]).find(".perso-story-template"),this.renderStory(),this.dotsUtils.updateIndex({currentTarget:this.currentTarget})},bindEvents:function(t){var e=this.carouselParentEl;t&&(e=t);var s=e.find(".pstory-title-close"),r=this;s.bind("click",function(){"function"==typeof r.closeHandler&&r.closeHandler()})},calcMultiStoryCarouselHeight:function(){var t=this.carouselParentEl.find(".perso-multi-story-dots"),e=this.carouselParentEl.find(".pstory-multi-title-wrapper");this.multiStoryCarousel.height(this.multiStoryCarousel.height("100%").height()-t.height()-e.height())},closeHandler:function(){var n=personetics.getDeviceType();if(this.params.payload=r,e.API.personetics.eventBuffer&&e.API.personetics.eventBuffer.sendEvents(),"web"===n){this.el.parent().empty();var i=new RegExp("[?&]teasersView=([^&#]*)").exec(t.location.href),a=0;null!=i&&(a=i[1]||0);var o="Carousel"===a?"teaser-widget-carousel":"teaser-widget";"Carousel"===a&&(this.parentCtrl.config.filter=!1),(c=s.extend(!0,{},this.parentCtrl.config)).el=s("body"),this.parentCtrl.startWidget(o,c)}else{var l=personetics.getJSBridge();if(l&&s.isFunction(l.sessionEnded)){var c;e.utils.PEventReporting.setValue({type:"ExitInsight",value:"1"}),e.utils.PEventReporting.notifyEvent(),delete(c=s.extend(!0,{},this.parentCtrl.config)).eventType,l.sessionEnded(c)}else e.log("Events Delegate not defined")}},saveStoryConfig:function(t,e){this.insightsPayload[this.selectedInsightId]==r&&(this.insightsPayload[this.selectedInsightId]=t),this.carouselParentEl.find(".pstory-title-text").text(e),this.afterStoryRender()},afterStoryRender:function(){var t=this.carouselParentEl.find(".pstory-title-text");t.css({"transition-duration":this.opactityDuration+"ms","-webkit-transition-duration":this.opactityDuration+"ms"}),t.css({opacity:1}),this.el.css({"transition-duration":this.opactityDuration+"ms","-webkit-transition-duration":this.opactityDuration+"ms"}),this.el.css("opacity",1),this.carouselAnimation.setCarouselDisable(!1)},initDots:function(){var t=this.carouselParentEl.find(".perso-multi-story-dots");this.dotsUtils=new e.utils.DotAnimation.bindDotEventsForAnimation(t,this.el.find('.perso-story:not([clone="true"])'),{showIndexDots:!0,firstDot:!1})},renderDots:function(){var t=this.carouselParentEl.find(".perso-dots");s.each(this.insightIdArr,function(e,s){t.append("<div class='carousel-index-dot' pstory-id='"+s+"'><div class='carousel-index-dot-circle'></div></div>")}),this.dotsUtils.setSelectedDot()}})}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.ProductSkinControler=e.story.PSkinControler.extend({registerWidgets:function(){this.registerDefaultWidgets(),e.UI.PWidgetFactory.registerWidget("app-ctrl",{widgetClass:e.UI.PAppCtrlProduct,widgetName:"Product app ctrl"}),e.UI.PWidgetFactory.registerWidget("master",{widgetClass:e.UI.PAppCtrlProduct,widgetName:"Product master"}),e.UI.PWidgetFactory.registerWidget("master-teaser",{widgetClass:e.UI.PAppTeaserCtrl,widgetName:"Product master teaser"}),e.UI.PWidgetFactory.registerWidget("story-widget",{widgetClass:e.UI.PStoryWidgetCtrlProduct,widgetName:"Product story widget"}),e.UI.PWidgetFactory.registerWidget("inbox-story-widget",{widgetClass:t.HandlebarsTeaserInboxAndStoryWidget,widgetName:"Product inbox and story widget"}),e.UI.PWidgetFactory.registerWidget("teaser-widget-single",{widgetClass:t.HandlebarsTeaserWidget,widgetName:"Product single teaser widget"}),e.UI.PWidgetFactory.registerWidget("teaser-widget",{widgetClass:t.HandlebarsMultiTeaserWidget,widgetName:"Product teaser widget"}),e.UI.PWidgetFactory.registerWidget("teaser-widget-carousel",{widgetClass:t.HandlebarsMultiTeaserWidgetCarousel,widgetName:"Product teaser widget"}),e.UI.PWidgetFactory.registerWidget("ratings",{widgetClass:e.UI.PRatingCtrlDesktop,widgetName:"Desktop ratings",widthMode:"desktop"})},registerBlocks:function(){e.story.PSkinControler.prototype.registerBlocks.call(this),this.registerBlock("account-selector",{blockClass:e.story.AccountSelectorBlockProduct}),this.registerBlock("account-selector",{widthMode:"desktop",blockClass:e.story.AccountSelectorBlockProductDesktop}),this.registerBlock("buttons",{blockClass:e.story.ButtonsBlockProduct}),this.registerBlock("pie-chart",{blockClass:e.story.PieChartBlockProduct}),this.registerBlock("arc-chart",{blockClass:e.story.PieChartBlockProduct}),this.registerBlock("pie-chart",{widthMode:"desktop",blockClass:e.story.PieChartBlockProductDesktop}),this.registerBlock("bar-chart",{blockClass:e.story.D3BarChartBlockProduct}),this.registerBlock("bar-chart",{widthMode:"desktop",blockClass:e.story.D3BarChartBlockProductDesktop}),this.registerBlock("pin-graph",{blockClass:e.story.D3PinGraphChartBlockProduct}),this.registerBlock("pin-graph",{widthMode:"desktop",blockClass:e.story.D3PinGraphChartBlockProductDesktop}),this.registerBlock("line-chart",{blockClass:e.story.DotsLineChartBlock}),this.registerBlock("line-chart",{widthMode:"desktop",blockClass:e.story.DotsLineChartBlockDesktop}),this.registerBlock("table",{blockClass:e.story.TableBlockProduct}),this.registerBlock("tranList",{blockClass:e.story.TableBlockProduct}),this.registerChartHelper("verticalHelper",{helperClass:e.utils.d3Helpers.VerticalChartHelperProduct}),this.registerChartHelper("multiVerticalHelper",{helperClass:e.utils.d3Helpers.MultiVerticalChartHelperDesktop,widthMode:"desktop"}),this.registerChartHelper("pinGraphHelper",{helperClass:e.utils.d3Helpers.PinGraphChartHelperProduct}),this.registerChartHelper("collapseHelper",{helperClass:e.story.CollapseHelper})},getScreenOptions:function(){return{ratio_medium:1.17,ratio_large:1.3}},getValueByScreenWidth:function(e){var r=s(t).width(),n=this.getScreenOptions(),i=e;return r>=414?i=e*n.ratio_large:r>=347&&(i=e*n.ratio_medium),i},getDesktopScreenWidth:function(){return 790},getCollapseOptions:function(){var e=s(t).width(),r=this.getScreenOptions();return{displayedHeight:e<347?70:e>=414?70*r.ratio_large:70*r.ratio_medium}},getColumnChartOptions:function(){return{maxBarHeight:99,svgHeight:200,svgWidth:320,labelTop:27,barTop:41,xAxisTop:170,yAxisHeight:128,yAxisTop:20,yAxisLineDisplay:!0,yAxisTextDisplay:!1,negativeYAxisTop:181,negativeBarTop:190,horizontalLineWidth:281,horizontalLineLeft:20,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:43,bottom:40},height:180,chart:{transX:0,transY:10},labels:{drawLabels:!0,marginBottom:18,marginTop:-10},rectangles:{width:16,space:33,minHeightPercent:.15,borderRadius:{rx:9,ry:9},marginFromBottom:15,marginFromLeft:0,gradients:[{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}],filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,collapsedPadding:{top:22,bottom:15}},yAxis:{x:0,y:0,hide:!0}}}},getPinGraphChartOptions:function(){return{svgHeight:200,svgWidth:281,maxBarHeight:112,labelTop:12,barTop:27,xAxisTop:170,yAxisHeight:128,yAxisTop:20,yAxisLineDisplay:!0,yAxisTextDisplay:!1,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:43,bottom:40},height:180,chart:{transX:0,transY:10},totalHeight:220,labels:{drawLabels:!0,marginBottom:18,marginTop:4.5},rectangles:{minHeightPercent:.15,width:9,space:40,borderRadius:{rx:4,ry:4},marginFromBottom:15,gradients:{selectedGradient:{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,tickPadding:10,collapsedPadding:{top:22,bottom:15}},yAxis:{x:0,y:0,hide:!0}}}},getColumnChartMultiSeriesOptions:function(){return{svgHeight:200,svgWidth:313,maxBarHeight:93,labelTop:45,nextLabelTop:14,barTop:56,xAxiaTop:170,verticalLineTop:20,lineHeight:130,drowVerticalLines:!0,yAxisDisplay:!1,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:34,right:24,bottom:72,left:24},totalHeight:220,labels:{drawLabels:!0,marginTop:-16,marginBottom:4,right:2},rectangles:{width:9,space:41,paddingTop:30,paddingLeft:-19,paddingRight:22,paddingBottom:33,seriesPadding:12.5,transX:4,minHeight:.25,borderRadius:{rx:4,ry:4},marginFromBottom:5,gradients:{selectedInGradient:{id:"selectedInGradient",offset:["0%","100%"],stopColors:["#7193e2","#485f96"]},selectedOutGradient:{id:"selectedOutGradient",offset:["0%","100%"],stopColors:["#ffcc00","#ffb80a"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:2.5,y:"height"},xAxis:{hide:!1,tickPadding:10,minimizedPadding:{top:22,bottom:15}}}}},getDotsLineChartOptions:function(){return{screen:{ratio_medium:1.17,ratio_large:1.3},svgHeight:200,svgWidth:320,line_left:59,line_top:20,line_width:227,line_height:130,area_display:!1,lineStyle_interpolate:"cardinal",lineStyle_thickness:3,xAxis_line_y:20,xAxis_line_x:63,xAxis_line_height:130,xAxis_text_y:171,xAxis_text_x:57,xAxis_display:!0,yAxis_x:47,yAxis_y:20,yAxis_display:!0,duration:2e3,dots_radius:4.5,dots_radius_selected:5,labels_x:59,labels_y:8.3,labels_display:!0,horizonalLine_x:0,horizonalLine_length:308,horizonalLine_y:100,horizonalLine_display:!1,highlightBy:"last"}},getDotsLineChartOptionsDesktop:function(){return{screen:{ratio_medium:1.17,ratio_large:1.3},svgHeight:404,svgWidth:790,line_left:89,line_top:105,line_width:611,line_height:162,area_display:!1,lineStyle_interpolate:"cardinal",lineStyle_thickness:4,xAxis_line_y:47,xAxis_line_x:89,xAxis_line_height:257,xAxis_text_y:339,xAxis_text_x:93,xAxis_display:!0,yAxis_x:47,yAxis_y:20,yAxis_display:!1,duration:2e3,dots_radius:5,dots_radius_selected:9,labels_x:91,labels_y:24.31,labels_display:!0,horizonalLine_display:!1,highlightBy:"last"}},getBarChartOptions:function(){return{screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:22,bottom:0},drawLabels:!0,rectangles:{height:13,width:281,color:"rgba(169, 167, 167, 1)",paddingTop:-28,paddingBottom:10,seriesPadding:3,borderRadius:{rx:6,ry:6},gradients:{selectedGradient:{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}}},labels:{minWidth:100},selected:{},axis:{xAxis:{hide:!0},yAxis:{hide:!1,transValue:-20}}}},getBarGraphPalette:function(){return["rgba(169, 167, 167, 1)","url(#selectedGradient)"]},getBarGraphLabelsPalette:function(){return["rgba(40, 36, 37, 1)","rgba(84, 113, 180, 1)"]},getMultiVerticalPalette:function(){return["rgba(183, 183, 183, 1)","rgba(215, 215, 215, 1)"]},getMultiVerticalLabelsPalette:function(){return["rgba(147, 145, 149, 1)","rgba(40, 36, 37, 1)"]},getPieGraphPalette:function(t){return"Out"==t?["#ffce40","#ffb608","#ff9819","#fe7d3f","#f9652b","#df4c3a","#c72735"]:["#6787d1","#027ac4","#7390c5","#3095bd","#45a5d3","#5acafa","#95dafb"]},getPieOptions:function(){return{arcs:{selctedPrimaryColor:null,selectedInflowPrimaryColor:null,selectedOutflowPrimaryColor:null,filter:{grayFilter:!0},cornerRadius:{radiusCorner:9},padAngle:.04}}},getPieOptionsDesktop:function(){return{arcs:{selctedPrimaryColor:null,selectedInflowPrimaryColor:null,selectedOutflowPrimaryColor:null,filter:{grayFilter:!0},cornerRadius:{radiusCorner:9},padAngle:-.02},drawCenterLine:!0,centerLineWidth:100}},getPinGraphChartOptionsDesktop:function(){return{isDesktop:!0,maxBarHeight:177,svgHeight:404,svgWidth:730,labelTop:90,barTop:114,xAxisTop:340,yAxisHeight:255,yAxisTop:47,yAxisLineDisplay:!0,yAxisTextDisplay:!1,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:120,bottom:117},chart:{transX:0,transY:10},labels:{drawLabels:!0},rectangles:{width:14,space:89,borderRadius:{rx:6,ry:6},gradients:[{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}],filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,collapsedPadding:{top:22,bottom:15}}}}},getColumnChartOptionsDesktop:function(){return{isDesktop:!0,maxBarHeight:150,svgHeight:404,svgWidth:730,labelTop:118,barTop:137,xAxisTop:340,yAxisHeight:253,yAxisTop:49,yAxisLineDisplay:!0,yAxisTextDisplay:!1,screen:{ratio_medium:1.17,ratio_large:1.3},chart:{transX:0,transY:10},labels:{drawLabels:!0},rectangles:{width:18,space:87,borderRadius:{rx:9,ry:9},gradients:[{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}],filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,collapsedPadding:{top:22,bottom:15}},yAxis:{x:0,y:0,hide:!0}}}},getColumnChartMultiSeriesOptionsDesktop:function(){return{svgHeight:404,svgWidth:730,maxBarHeight:180,labelTop:80,nextLabelTop:21,barTop:107,xAxiaTop:340,yAxisTop:49,yAxisHeight:253,spaceLeft:30,yAxisLineDisplay:!0,yAxisTextDisplay:!1,drowVerticalLines:!1,accessHiddenRectMarginLeft:0,accessHiddenRectMarginTop:43,screen:{ratio_medium:1.17,ratio_large:1.3},chart:{transX:0,transY:0},labels:{drawLabels:!0,right:6},rectangles:{width:18,space:57,seriesPadding:12.5,paddingRight:25,transX:4,borderRadius:{rx:9,ry:9},gradients:{selectedInGradient:{id:"selectedInGradient",offset:["100%"],stopColors:["rgba(84, 113, 180, 1)"]},selectedOutGradient:{id:"selectedOutGradient",offset:["100%"],stopColors:["rgba(255, 185, 10, 1)"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:8,y:"height"},xAxis:{hide:!1,tickPadding:10,minimizedPadding:{top:22,bottom:15}},yAxis:{hide:!0,x:0,y:30}}}},getBarChartOptionsDesktop:function(){return{screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:22,bottom:0},drawLabels:!0,rectangles:{height:13,width:730,color:"rgba(169, 167, 167, 1)",paddingTop:-28,paddingBottom:10,seriesPadding:3,borderRadius:{rx:6,ry:6},gradients:{selectedGradient:{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}}},labels:{minWidth:100},selected:{},axis:{xAxis:{hide:!0},yAxis:{hide:!1,paddingRight:27,transValue:-20}}}},getMultiVerticalPaletteDesktop:function(){return["rgba(215, 215, 215, 1)","rgba(183, 183, 183, 1)"]},getMultiVerticalLabelsPaletteDesktop:function(){return["rgba(0, 0, 0, 1)","rgba(115, 114, 114, 1)"]},getDotsLineGraphPalette:function(){return["rgba(46, 115, 255, 1)"]},getAccountSelectorPalette:function(){return["image1","image2","image3","image4","image5","image6"]},getAccountSelectorConfig:function(){return{showArrows:!0,minAccountsForDisplayingArrows:2,enableInfiniteCarousel:!0,showIndexDots:!0,nextArrowDir:"ltr",allAnimation:{type:"fadingSlidingOut"}}},getAccountSelectorConfigDesktop:function(){return{showArrows:!0,minAccountsForDisplayingArrows:4,enableInfiniteCarousel:!0,showIndexDots:!0,nextArrowDir:"rtl",allAnimation:{type:"heapCards",cardsStackTotalHeight:43,maxSpaceBetweenCards:14,showBoxShadowForLastCardOnly:!1}}},getCollapseBlockHeight:function(t){switch(t){case"account-selector":return 120;case"bar-chart":case"pin-graph":case"pie-chart":default:return 70}}}),e.story.skinController=e.story.ProductSkinControler,e.story.getTablesFormat=function(){return{"table-perso-txlist1":{columns:["accountNumber","transaction","date","amount"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"}}},"table-perso-txlist2":{columns:["transaction","date","amount"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"}}},"table-perso-txlist3":{columns:["accountNumber","transaction","date","amount","date","balance"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"},balance:{format:"###,###.00",type:"amount"}}},"table-perso-txlist4":{columns:["date","transaction","amount"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"}}},"table-perso-txlist5":{columns:["date","transaction","amount","balance"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"},balance:{format:"###,###.00",type:"amount"}}},"table-perso-txlist6":{columns:["date","transaction","amount"],displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"}}},"table-default":{displayColumns:{date:{format:"MM/DD/YY",type:"date"},amount:{format:"###,###.00",type:"amount"}}}}}}(window,window.Personetics=window.Personetics||{},jQuery),function(t,e,s,r){e.story=e.story||{},e.story.chaseSkinControler=e.story.ProductSkinControler.extend({registerBlocks:function(){e.story.ProductSkinControler.prototype.registerBlocks.call(this),this.registerBlock("text",{blockClass:e.story.TextBlockChase}),this.registerBlock("txt",{blockClass:e.story.TextBlockChase}),this.registerBlock("account-selector",{blockClass:e.story.AccountSelectorBlockChase}),this.registerBlock("pie-chart",{blockClass:e.story.PieChartBlockChase})},registerWidgets:function(){e.story.ProductSkinControler.prototype.registerWidgets.call(this),e.UI.PWidgetFactory.registerWidget("story-widget",{widgetClass:e.UI.PStoryWidgetCtrlChase,widgetName:"Chase story widget"}),e.UI.PWidgetFactory.registerWidget("story-widget-multi-carousel",{widgetClass:e.UI.PStoryWidgetMultiCtrlChase,widgetName:"Chase story widget multi carousel"})},getColumnChartOptions:function(){return{maxBarHeight:206,svgHeight:309,svgWidth:320,labelTop:40,barTop:60,xAxisTop:276,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:43,bottom:40},height:180,chart:{transX:0,transY:10},labels:{drawLabels:!0,marginBottom:18,marginTop:-10},rectangles:{width:44,space:3,minHeightPercent:.15,borderRadius:{rx:0,ry:0},marginFromBottom:15,marginFromLeft:0,gradients:[{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}],filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,collapsedPadding:{top:22,bottom:15}},yAxis:{x:0,y:0,hide:!0}}}},getPinGraphChartOptions:function(){return{svgHeight:309,svgWidth:320,maxBarHeight:206,labelTop:40,barTop:60,xAxisTop:276,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:43,bottom:40},height:180,chart:{transX:0,transY:10},totalHeight:220,labels:{drawLabels:!0,marginBottom:18,marginTop:4.5},rectangles:{minHeightPercent:.15,width:15,space:32,borderRadius:{rx:0,ry:0},marginFromBottom:15,gradients:{selectedGradient:{id:"selectedGradient",offset:["0%","100%"],stopColors:["#6888d2","#536fb1"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:0,y:"height"},xAxis:{hide:!1,tickPadding:10,collapsedPadding:{top:22,bottom:15}},yAxis:{x:0,y:0,hide:!0}}}},getColumnChartMultiSeriesOptions:function(){return{svgHeight:268,svgWidth:310,maxBarHeight:139,labelTop:50,nextLabelTop:16,barTop:86,xAxiaTop:237,verticalLineTop:19,lineHeight:206,drowVerticalLines:!0,screen:{ratio_medium:1.17,ratio_large:1.3},margin:{top:34,right:24,bottom:72,left:24},totalHeight:220,labels:{drawLabels:!0,marginTop:-16,marginBottom:4,right:2},rectangles:{width:14,space:43,paddingTop:30,paddingLeft:-19,paddingRight:20,paddingBottom:33,seriesPadding:12.5,transX:4,minHeight:.25,borderRadius:{rx:0,ry:0},marginFromBottom:5,gradients:{selectedInGradient:{id:"selectedInGradient",offset:["0%","100%"],stopColors:["#7193e2","#485f96"]},selectedOutGradient:{id:"selectedOutGradient",offset:["0%","100%"],stopColors:["#ffcc00","#ffb80a"]}},filter:{dropShadow:{id:"dropShadow",in:"SourceGraphic",stdDeviation:3,dxOffset:1,dyOffset:2}},transition:{duration:1e3,delay:500}},selected:{},axis:{translation:{x:2.5,y:"height"},xAxis:{hide:!1,tickPadding:10,minimizedPadding:{top:22,bottom:15}},yAxis:{hide:!0}}}},getDotsLineChartOptions:function(){return{screen:{ratio_medium:1.17,ratio_large:1.3},svgHeight:300,svgWidth:320,line_left:51,line_top:40,line_width:218,line_height:220,area_display:!1,lineStyle_interpolate:"cardinal",lineStyle_thickness:2,xAxis_line_y:26,xAxis_line_x:51,xAxis_line_height:233,xAxis_text_y:271,xAxis_text_x:51,xAxis_display:!0,yAxis_x:46,yAxis_y:22,yAxis_display:!0,duration:1e3,dots_radius:2,dots_radius_selected:2,labels_x:51,labels_y:22,labels_display:!0,horizonalLine_x:0,horizonalLine_length:308,horizonalLine_y:100,horizonalLine_display:!1,highlightBy:"last"}},getMultiVerticalLabelsPalette:function(){return["rgba(255, 255, 255, 1)","rgba(66, 141, 245, 1)"]},getPieGraphPalette:function(t){return["#c4c9cc","#b8bcbf","#abb0b3","#9fa4a6","#939799","#878a8c"]},getPieOptions:function(){return{arcs:{gradients:[{id:"gradient",offset:["0%","100%"],stopColors:["#f9e369, #ffed8b"]}],filter:{grayFilter:!1},cornerRadius:{radiusCorner:0},padAngle:0}}},getAccountSelectorPalette:function(){return["transparent"]},getAccountSelectorConfig:function(){return{showArrows:!1,enableInfiniteCarousel:!0,showIndexDots:!1,nextArrowDir:"ltr",allAnimation:{type:"fadingSlidingOut"}}}}),e.story.skinController=e.story.chaseSkinControler,e.story.getTablesFormat=function(){return{"table-perso-txlist1":{columns:["accountNumber","transaction","date","amount"],displayColumns:{date:{format:"MMM DD",type:"date"},amount:{format:"###,###.00",currencySymbol:"$",type:"amount"}}},"table-perso-txlist2":{columns:["date","transaction","amount"],displayColumns:{date:{format:"MMM DD",type:"date"},amount:{format:"###,###.00",currencySymbol:"$",type:"amount"}}},"table-default":{columns:["accountNumber","transaction","date","amount"],displayColumns:{date:{format:"MMM DD",type:"date"},amount:{format:"###,###.00",currencySymbol:"$",type:"amount"}}}}}}(window,window.Personetics=window.Personetics||{},jQuery);
